{"posts":[{"title":"CMAQ不同版本SOA机制","text":"不同版本SOA机制物种对比 CMAQ v4.7 参考Carlton et al., 2010, EST. Model Representation of Secondary Organic Aerosol in CMAQv4.7 In CMAQv4.7, SOA is produced from an expanded list of precursors (Table 1) and can be formed via both gas- and aqueous-phase oxidation processes, as well as aerosol-phase reactions. Seven of the 19 secondary organic PM species are treated as nonvolatile (dark-shaded rectangles in Figure 1). The 12 remaining species are semivolatile and have ∆Hvap values reduced in accordance with recent experimental data. 半挥发的部分会发生凝聚相低聚反应生成AOLGA 和AOLGB, GLY和MGLY是云中的液相反应 CMAQ v5.1 参考Appel et al., 2017, GMD Description and evaluation of the Community Multiscale Air Quality (CMAQ) modeling system version 5.1 在CMAQ v5.0.2 （和4.7改变不大）基础上修改 更新了isoprene生成SOA的过程（Pye et al., 2013, EST)：isoprene和OH的反应产物ISOPO2在低/高NOx条件下分别和HO2和NO反应生成IEPOX和MAE（以及HMML），随后IEPOX、MAE和HMML通过非均相反应生成：AIETETJ AIEOSJ ADIMJ AIMGAJ AIMOSJ 更新有机硝酸盐部分（Pye et al., 2015, EST）： isoprene和NO3反应生成ISOPNN，进一步生成半挥发性硝酸盐： AISOPNNJ terprene和NO3反应生成MTNO3，进一步生成半挥发性硝酸盐：AMTNO3J AISOPNNJ和AMTNO3J 会非均相水解生成AMTHYDJ 增加GLY和MGLY非均相过程，生成AGLYJ 5.1版本SOA生成概念图（Pye et al., 2017, ACP） CMAQ v5.2 参考 CMAQ/CCTM/docs/Release_Notes/README.md at 5.2 · USEPA/CMAQ · GitHub 主要参考文献（Murphy et al., 2017, ACP）（Pye et al., 2017, ACP） 更新POA部分，5.1中POA分为POC+NCOM, 5.2中考虑了不同的挥发性的差异（Murphy et al., 2017, ACP） POA多级氧化 POA划分为不同的挥发性,存在gas和aerosol两种相态：低挥发性V/ALVPO1, 半挥发性V/ASVPO(1,2,3),中等挥发性V/AIVPO(1); 部分gas phase POA本身通过气粒分配生成aerosol phase POA（ALVPO1J等） 气相机制中POA(g)老化生成对应的氧化产物VLVPO1 等，最后气粒分配生成SOA（ALVOO1J等） ```fortran! part 1. emissions in GC.nml‘VLVPO1:218:POC:1.0:VD_ORA:1:::ADIPIC_ACID:1:VLVPO1::Yes:Yes:Yes:Yes’,‘VSVPO1:230:POC:1.0:VD_ORA:1:::ADIPIC_ACID:1:VSVPO1::Yes:Yes:Yes:Yes’,‘VSVPO2:241:POC:1.0:VD_ORA:1:::ADIPIC_ACID:1:VSVPO2::Yes:Yes:Yes:Yes’,‘VSVPO3:253:POC:1.0:VD_ORA:1:::ADIPIC_ACID:1:VSVPO3::Yes:Yes:Yes:Yes’,‘VIVPO1:266:POC:1.0:VD_ORA:1:::ADIPIC_ACID:1:VIVPO1::Yes:Yes:Yes:Yes’,‘VLVOO1:136:::VD_ORA:1:::ADIPIC_ACID:1:VLVOO1::Yes:Yes:Yes:Yes’,‘VLVOO2:136:::VD_ORA:1:::ADIPIC_ACID:1:VLVOO2::Yes:Yes:Yes:Yes’,‘VSVOO1:135:::VD_ORA:1:::ADIPIC_ACID:1:VSVOO1::Yes:Yes:Yes:Yes’,‘VSVOO2:135:::VD_ORA:1:::ADIPIC_ACID:1:VSVOO2::Yes:Yes:Yes:Yes’,‘VSVOO3:134:::VD_ORA:1:::ADIPIC_ACID:1:VSVOO3::Yes:Yes:Yes:Yes’, ! part 2. reaction with OH to produce PCSOARXN in mech.def! Aging with Func. and Frag. (Donahue et al. 2012) VLVPO1 + OH = OH + 0.4857 * VLVPO1 + 0.0062 * VSVPO1 + 0.0025 * VSVPO2 + 0.0026 * VSVPO3 + 0.0023 * VIVPO1 + 0.2944 * VLVOO1 + 0.2021 * VLVOO2 + 0.0019 * VSVOO2 + 0.0023 * VSVOO3 #4.0e-11; VSVPO1 + OH = OH + 0.3003 * VLVPO1 + 0.2862 * VSVPO1 + 0.0041 * VSVPO2 + 0.0035 * VSVPO3 + 0.2239 * VLVOO1 + 0.1820 * VLVOO2 #4.0e-11; VSVPO2 + OH = OH + 0.3856 * VLVPO1 + 0.0950 * VSVPO1 + 0.1373 * VSVPO2 + 0.0005 * VSVPO3 + 0.2051 * VLVOO1 + 0.1764 * VLVOO2 #4.0e-11; VSVPO3 + OH = OH + 0.2181 * VLVPO1 + 0.3063 * VSVPO1 + 0.0153 * VSVPO2 + 0.1043 * VSVPO3 + 0.1893 * VLVOO1 + 0.1668 * VLVOO2 #4.0e-11; VIVPO1 + OH = OH + 0.2412 * VLVPO1 + 0.2089 * VSVPO1 + 0.3000 * VSVPO2 + 0.2028 * VLVOO1 + 0.0471 * VLVOO2 #4.0e-11; VLVOO1 + OH = OH + 0.6664 * VLVOO1 + 0.0143 * VLVOO2 + 0.0123 * VSVOO1 + 0.1239 * VSVOO2 + 0.1831 * VSVOO3 #4.0e-11; VLVOO2 + OH = OH + 0.2858 * VLVOO1 + 0.3931 * VLVOO2 + 0.0139 * VSVOO1 + 0.1027 * VSVOO2 + 0.2045 * VSVOO3 #4.0e-11; VSVOO1 + OH = OH + 0.3303 * VLVOO1 + 0.2272 * VLVOO2 + 0.2607 * VSVOO1 + 0.0702 * VSVOO2 + 0.1116 * VSVOO3 #4.0e-11; VSVOO2 + OH = OH + 0.3444 * VLVOO1 + 0.2749 * VLVOO2 + 0.0491 * VSVOO1 + 0.2577 * VSVOO2 + 0.0739 * VSVOO3 #4.0e-11; VSVOO3 + OH = OH + 0.3886 * VLVOO1 + 0.2421 * VLVOO2 + 0.0640 * VSVOO1 + 0.0385 * VSVOO2 + 0.2667 * VSVOO3 #4.0e-11; ! part 3. SOA production in SOA_DEFN.F &amp; vapor_type('VLVPO1 ', 0.0000, 1.e-1, 96.0E3, 'ALVPO1J', 'A', 0.0, ' '), &amp; vapor_type('VSVPO1 ', 0.0000, 1.e+0, 85.0E3, 'ASVPO1J', 'A', 0.0, ' '), &amp; vapor_type('VSVPO2 ', 0.0000, 1.e+1, 74.0E3, 'ASVPO2J', 'A', 0.0, ' '), &amp; vapor_type('VSVPO3 ', 0.0000, 1.e+2, 63.0E3, 'ASVPO3J', 'A', 0.0, ' '), &amp; vapor_type('VIVPO1 ', 0.0000, 1.e+3, 52.0E3, 'AIVPO1J', 'A', 0.0, ' '), &amp; vapor_type('VLVOO1 ', 0.0000, 1.e-2, 107.0E3, 'ALVOO1J', 'A', 0.0, ' '), &amp; vapor_type('VLVOO2 ', 0.0000, 1.e-1, 96.0E3, 'ALVOO2J', 'A', 0.0, ' '), &amp; vapor_type('VSVOO1 ', 0.0000, 1.e+0, 85.0E3, 'ASVOO1J', 'A', 0.0, ' '), &amp; vapor_type('VSVOO2 ', 0.0000, 1.e+1, 74.0E3, 'ASVOO2J', 'A', 0.0, ' '), &amp; vapor_type('VSVOO3 ', 0.0000, 1.e+2, 63.0E3, 'ASVOO3J', 'A', 0.0, ' ')/) 12345678910111213- Potential Combustion SOA：APCSOJ（这部分的加入是为了补偿IVOC氧化，wall loss, VOC产物多级氧化等过程的缺失） - ```fortran ! part 1. emissions in GC.nml 'PCVOC:170:POC:0.0387:VD_GEN_ALD:1.0:::GENERIC_ALDEHYDE:1.0:::Yes:Yes:Yes:Yes', ! part 2. reaction with OH to produce PCSOARXN in mech.def ! Formation of Potential Combustion SOA (pcSOA) &lt;PCSOA&gt; PCVOC + OH = OH + PCSOARXN # 1.25E-11; ! part 3. SOA production in SOA_DEFN.F &amp; vapor_type('LV_PCSOG', 1.0 , 1.0e-5, 40.0E3, 'APCSOJ ', 'A', 10.0, 'PCSOARXN'), 更新Glyoxal and methylglyoxal SOA updates （Pye et al., 2017, ACP） 在5.1版本上修改 uptake coefficient of MGLY 更新SOA的一些属性：Several properties of semivolatile SOA species (aerosol and nonreactives) were updated: number of carbon atoms per molecule, density, organic-mass-to-organic-carbon (OM/OC) ratio (now in species definition file), and molecular weights. In addition, unique dry and wet deposition surrogates were implemented for each semivolatile species. See Pye et al. (2017) for how updated properties were determined CMAQ v5.3 参考Appel et al., 2021, GMD; Xu et al., 2018, ACP; Qin et al., 2021, NS 增加aero7气溶胶方案，注意编译的时候选择 aero7中更新 organic nitrates from monoterpenes机制，原有的ATRP(1,2)替换为AMT(1-7),模式中实际只有AMT1-6,SVMT7 is ignored assuming it does not condense appreciably to the particle phase. 注意排放处理的时候需要单独出$\\alpha-pinene$ ； Use the emission control file and assign 30% of emitted TERP to APIN and 70% of emitted TERP to TERP. a图是aero6中的SOA，b图是Xu et al., 2018, ACP更新部分（AMT1-7），红色表示新增，蓝色表示删除的部分 基于VBS框架的SOA生成，AAVB1J, AAVB2J, AAVB3J, AAVB4J替换aero6中的人为源部分ABNZ1J, ABNZ2J, ABNZ3J, SV_BNZ1, SV_BNZ2, AXYL1J, AXYL2J, AXYL3J, SV_XYL1, SV_XYL2, ATOL1J, ATOL2J, ATOL3J, SV_TOL1, SV_TOL2, APAH1J, APAH2J, APAH3J, SV_PAH1, SV_PAH2, AALK1J, AALK2J, SV_ALK1, SV_ALK2,详见Qin et al., 2021. Supplementary Table 5. 在mech.def文件中，原有的BNZNRXN等替换为对应的SVAVB1-4，详见Qin et al., 2021. Supplementary Table 4. 物种生成路径（源解析标记物种说明）： AAVB1J， AAVB2J， AAVB3J， AAVB4J 组内版本 默认黑色箭头，半挥发性 SV-SOA ALK5， BNZ， ARO，XYL，ISO，TERP，SESQT 烷烃，苯，芳香烃，二甲苯，异戊二烯，单萜烯 ，倍半萜烯 红色： 非挥发性 NV-SOA 乙二醛（GLY），甲基乙二醛（MGLY），异戊二烯环氧化物（IEPOX）和甲基丙烯酸环氧化物（MAE） 对SOA的相对贡献 SV-SOA and NV-SOA","link":"/blog/2022/10/25/CMAQ%E4%B8%8D%E5%90%8C%E7%89%88%E6%9C%ACSOA%E6%9C%BA%E5%88%B6/"},{"title":"CMAQ代码说明","text":"代码结构分析drive.F 主程序 一些数组说明： CGRID,指针，指向PCGRID，所有物种瞬时浓度的存储数组 AGRID平均浓度的数组，输出时在wr_aconc.F文件中判断是否是输出物种和输出层数 SGRID输出到CONC文件的瞬时物种浓度的数组，即CGRID的子集 依次运行的模块 GRID_INIT()：网格定义 CGRID_SPCS_INIT()：物种定义 PAGRD_INIT()：PA模块网格定义 PCGRID_INIT()：定义物种PCGRID数组 CONC_DEFN() | A_CONC_DEFN()：获取输出的CONC、ACONC文件对应的物种名称 WVEL_INIT()：读取环境变量“CTM_WVEL” ，是否输出沉降速度 INITSCEN()：输出IC到CONC文件 PA_INIT()：PA模块初始化，创建输出文件并初始化数组 FLCHECK()：文件header信息检查 分配相关数组的内存：AGRID、RCONC、CFLAG、ASTEP ADVSTEP()：计算时步 SCIPROC()：理化过程计算程序 调用的子程序 GRID_CONF.F 网格设置，会调用HGRD_DEFN.F和VGRD_DEFN.F， 其中，HGRD读取”GRIDDESC”文件，VGRD读取MET_CRO_3D文件中的垂直信息 CGRID_SPCS.F 物种设置，读取GC_nml，AE_nml等物种定义文件 PAGRD_DEFN.F 读取环境变量中的一些设置，PA模块有关 PCGRID_DEFN.F 定义物种数组，PCGRID, 这是CGRID指针的目标，即CGRID指向PCGRID STD_CONC.F、AVG_CONC.F 定义物种名称CONC_SPCS、AVG_SPCS initscen.F 输出IC到CONC文件 pa_init.F、flcheck.F advstep.F 根据CFD条件（Courant-number conditions）计算时步，TSTEP(2)指运行的时间步长，TSTEP(1)指输出的时间步长（run脚本设置，在initscen.F读取），NREPS指输出时间步长中的时步数量，NREPS=TSTEP(1)/TSTEP(2) sciproc.F 理化过程 SCIPROC程序说明CHEM: grdriver.F 第一次运行需要smvgear初始化 GRVARS_INIT、GRINIT、JSPARSE 排放：默认不需要 定义MET_CRO_3D文件的网格的起始位置 （注意boxmodel待修改） SUBHFILE(MET_CRO_3D) FIND_DEGRADED：确定degradation（降解）的物种 从气象文件中读取TA, QV, DENS, PRES PHOT.F 计算光解速率-这里会读取气象数据, 主要流程： 初次运行： SUBHFILE: GRID_CRO_2D，MET_CRO_2D，MET_CRO_3D LOAD_REF_DATA()：读取CSQY_DATA文件中的数据 从GRID_CRO_2D读取纬度 LAT 判断landuse类型，计算FRACTION_LANDUSE；判断是否有SEAICE变量；定义一些数组 读取经度LON, 计算CONLAT, SINLAT 读取地面高度HT O3和NO2指针 读取一些变量：SNOCOV (snow cover) 太阳相关参数计算，输入经纬度、年份和天，SOLEFM3 计算太阳高度角：GETZEN2 判断是否是夜晚 DARK 读取变量：ZH、ZF、DENS、TA、PRES、WBAR、CLDT、CLDB、CFRAC AERO_PHOTDATA：计算气溶胶特性 NEW_OPTICS：计算晴空光解速率 NEW_OPTICS：计算有云情况下光解速率 进入block循环： PA_IRR_CKBLK、PA_IRR_BLKSTRT CALCKS：计算反应速率 INIT_DEGRADE SMVGEAR：化学模块积分 FINAL_DEGRADE AERO: aero_driver.F 第一次运行，初始化： 打开气象文件 打开能见度文件 OPVIS: opvis.F 打开气溶胶参数(粒径和标准差)文件OPDIAM: opdiam.F 定义MET_CRO_3D文件的网格的起始位置 （注意boxmodel待修改） SUBHFILE(MET_CRO_3D) 读取气象：PRES、TA、QV、DENS、GSW 进入格点循环： 从CGRID数组中提取相关数据：EXTRACT_AERO、EXTRACT_PRECURSOR、EXTRACT_SOA 计算气溶胶过程 AEROPROC： aero_subs.F GETPAR: getpar.f 计算M3, mass, 气溶胶密度，直径 ORGAER： SOA传统生成路径， SOA_DEFN.F POAAGE：POA氧化，poaage.F HETCHEM：非均相反应（N2O5, sulfate, GLY, MGLY），hetchem.f GETPAR VOLINORG：NPF和SNA+Cl的气粒转化 coagulation：GETCOAGS GETPAR 更新CGRID数组：UPDATE_AERO、UPDATE_PRECURSOR、UPDATE_SOA 计算每个模态中PM2.5的占比：INLET25： aero_subs.F 输出： 计算能见度相关 GETVISBY：aero_subs.F 计算不同模态 M2 and M3值 粒径分布 计算直径和标准差 GETPAR 气溶胶排放处理： ```fortranEMIS_DEFN.F 排放处理主程序，会调用AERO_EMIS_INIT 和 GET_AERO_EMIS AERO_EMIS.F AERO_EMIS_INITGET_AERO_EMIS 12345678910111213141516171819202122## 非均相机制修改说明1. smvgear chem solver 修改文件: ```fortran ! part 1. 准备mech.def文件，增加 ! iorganic heteorogeneous reactions from hetchem version 5.0.2 &lt;HET_N2O5&gt; N2O5 = 2.0*HNO3 # 1.0~&lt;HETERO_N2O5IJ&gt;; &lt;HET_N02I&gt; NO2 = ANO3I # 1.0~&lt;HETERO_NO2I&gt;; &lt;HET_NO2J&gt; NO2 = ANO3J # 1.0~&lt;HETERO_NO2J&gt;; &lt;HET_SO2I&gt; SO2 = ASO4I # 1.0~&lt;HETERO_SO2I&gt;; &lt;HET_SO2J&gt; SO2 = ASO4J # 1.0~&lt;HETERO_SO2J&gt;; &lt;HET_HO2&gt; HO2 = # 1.0~&lt;HETERO_HO2&gt;; ! part 2. 运行chemech工具，生成RXNS_DATA_MODULE.F90和RXNS_FUNC_MODULE.F90 ! 将这两个文件替换成新的 ! part 3. 修改下面两个文件 AEROSOL_CHEMISTRY.F ! 主要涉及非均相反应速率 grdriver.F ! 增加DORN变量,判别白天夜间 box model 修改代码上的改动 增加rdconc.F 文件，读取observation数据； 并在FILES_CTM.EXT中增加GAS_DATA定义 修改driver.F文件，将读取的obs赋值到CGRID数组 修改sciproc.F文件，开关相应的过程 修改EMIS_DEFN.F文件，注释和MGEMIS有关的项，同时修改ASX_DATA_MOD.F，注释OCEAN_1相关，这样不需要准备ocean文件了 修改Makefile，增加rdconc 修改initscen.F，注释CALL OPWDEP，不生成WETDEP文件 输入文件123456789101112131415161718ICON_eastasia36_EASTASIA36_profileGRIDDESCGRIDCRO2D_2022-07-02METCRO2D_2022-07-02METCRO3D_2022-07-02metdot3d# metdot3d 变量有 # UWIND # VWIND # UHAT_JD、VHAT_JD 和adv有关 # UWINDC # VWINDCOMI_1979_to_2017.dats07ae6_conc_36km.2022183_1min.ncf ekman曲线 运行VOC+NOx两组实验，每组（0, 0.2, 0.4, 0.6, 0.8, 1, 1.2）,共49组实验 存在问题： 观测数据缺少NO：增加FixNOratio 选项，根据模拟的NO/NO2比例，基于NO2的观测设置NO的浓度 观测数据缺少$NH_3$: 模式中NH3消耗很快，基本都是0，因此增加输入NH3排放 模拟的臭氧浓度很高：考虑沉降过程，sciproc中打开vdiff，需要METDOT3D文件 RIR分析 运行VOC物种 MCM版本 MCM版本用于RIR分析 由于PA没有编译，不能分析硝酸盐的生成途径 S07版本 要模拟硝酸盐，NH3需要作为输入 PA 说明 pa.inp 123456789101112131415161718192021222324252627! what(1) key, module and SID; SCCS file; date and time of last delta:! @(#)pa.inp 2.1 /project/mod3/ICL/src/procan/pa/SCCS/s.pa.inp 12 Dec 1996 14:10:18IRRTYPE = PARTIAL;IRR_OUTPUT HNO3prod = PROD[HNO3];!DESCRIPTION = 'PROD change in HNO3';IRR_OUTPUT HNO3fromNO2_OH = &lt;25&gt;;IRR_OUTPUT HNO3fromN2O5_Gas = 2*&lt;13&gt;;IRR_OUTPUT HNO3fromNO3_HO2 = 0.2*&lt;39&gt;;IRR_OUTPUT HNO3fromNO3_Org = &lt;BP07&gt;+&lt;BP10&gt;+&lt;BP13&gt;+&lt;BP33&gt;+&lt;BP36&gt; +&lt;BP39&gt;+&lt;BP45&gt;+0.15*&lt;BP66&gt;+&lt;BP74&gt; +0.967*&lt;BP77&gt;+0.5*&lt;BP56&gt;+0.6*&lt;IS31&gt;; IRR_OUTPUT HNO3fromNO2_Het = 0.5*&lt;HET_N02&gt;;IRR_OUTPUT HNO3fromN2O5_Het = 2.0*&lt;HET_N2O5&gt;;IRR_OUTPUT HNO3fromHET_N2O5 = &lt;HET_N2O5IJ&gt;+&lt;HET_N2O5K&gt; +&lt;HET_H2NO3PIJA&gt;+&lt;HET_H2NO3PKA&gt;;IRR_OUTPUT HNO3fromHET_NO55 = &lt;HET_N2O5IJ&gt;+&lt;HET_N2O5K&gt;;IRR_OUTPUT HNO3fromHET_NO3 = &lt;HET_NO3&gt;;IRR_OUTPUT HNO3fromOrganic = &lt;HYD_MT&gt;+2*&lt;HYD_ISOP&gt;;ENDPA; 对应的mech 方程 1234567891011121314151617181920212223242526272829303132333435363738394041424344!!! 气相反应&lt;13&gt; N2O5 + H2O = 2*HNO3 # 1.00e-22;&lt;25&gt; OH + NO2 = HNO3 # 3.2e-30^-4.50&amp;3.0e-11&amp;0.41&amp;1.24;&lt;39&gt; NO3 + HO2 = 0.8*OH + 0.8*NO2 + 0.2*HNO3 # 4.00e-12;!!! 非均相反应&lt;HET_N2O5&gt; N2O5 = 2.0*HNO3 # 1.0~&lt;HETERO_N2O5IJ&gt;;! 注意是0不是O,估计在mech中写错了！！！&lt;HET_N02I&gt; NO2 = ANO3I # 1.0~&lt;HETERO_NO2I&gt;;&lt;HET_NO2J&gt; NO2 = ANO3J # 1.0~&lt;HETERO_NO2J&gt;;&lt;HET_N2O5IJ&gt; N2O5 = HNO3 + H2NO3PIJ # 1.0~&lt;HETERO_N2O5IJ&gt;;&lt;HET_N2O5K&gt; N2O5 = HNO3 + H2NO3PK # 1.0~&lt;HETERO_N2O5K&gt;;&lt;HET_H2NO3PIJA&gt; H2NO3PIJ = HNO3 # 1.0~&lt;HETERO_H2NO3PAIJ&gt;;&lt;HET_H2NO3PKA&gt; H2NO3PK = HNO3 # 1.0~&lt;HETERO_H2NO3PAK&gt;;!!! 有机部分&lt;BP07&gt; HCHO + NO3 = HNO3 + HO2 + CO # 2.00e-12@2431;&lt;BP10&gt; CCHO + NO3 = HNO3 + MECO3 # 1.40e-12@1860;&lt;BP13&gt; RCHO + NO3 = HNO3 + RCO3 # 1.40e-12@1601;&lt;BP33&gt; GLY + NO3 = HNO3 + 0.70*HO2 + 1.40*CO + 0.3*HCOCO3 # 2.80e-12@2390;&lt;BP36&gt; MGLY + NO3 = HNO3 + CO + MECO3 # 1.40e-12@1895;&lt;BP39&gt; CRES + NO3 = HNO3 + BZO + XC # 1.40e-11;&lt;BP45&gt; BALD + NO3 = HNO3 + BZCO3 # 1.34e-12@1860;&lt;BP66&gt; IPRD + NO3 = 0.15*MACO3 + 0.15*HNO3 + 0.799*RO2C + 0.799*xHO2 + 0.051*RO2XC + 0.051*zRNO3 + 0.572*xCO + 0.227*xHCHO + 0.218*xRCHO + 0.008*xMGLY + 0.572*xRNO3 + 0.85*yR6OOH + 0.278*XN - 0.815*XC # 1.00e-13;&lt;BP74&gt; HOCCHO + NO3 = HNO3 + MECO3 # 1.0*K&lt;BP10&gt;;&lt;BP77&gt; ACROLEIN + NO3 = 0.031*xHO2 + 0.967*MACO3 + 0.031*RO2C + 0.002*RO2XC + 0.002*zRNO3 + 0.967*HNO3 + 0.031*xCO + 0.031*xRNO3 + 0.033*yROOH + 0.002*XN - 1.097*XC # 1.18e-15;&lt;BP56&gt; MACR + NO3 = 0.5*IMACO3 + 0.5*RO2C + 0.5*HNO3 + 0.5*xHO2 + 0.5*xCO + 0.5*yROOH + 1.5*XC + 0.5*XN # 1.50e-12@1815;&lt;IS31&gt; NIT1 + NO3 = 0.6*NIT1NO3OOA + 0.6*HNO3 + 0.4*NIT1NO3OOB # 3.15e-13@448;!!!&lt;HET_NO3&gt; NO3 = HNO3 # 1.0~&lt;HETERO_NO3&gt;;!!! 颗粒态硝酸盐水解! Hydrolysis of particle-phase nitrates&lt;HYD_MT&gt; AMTNO3J = HNO3 + 1.00*AMTHYDJ #9.259E-5;&lt;HYD_ISOP&gt; AISOPNNJ = 2.0*HNO3 + 0.5*AMTHYDJ #9.259E-5; 问题：使用revised非均相机制NO2非均相的贡献很大","link":"/blog/2022/10/25/CMAQ%E4%BB%A3%E7%A0%81%E6%B5%81%E7%A8%8B/"},{"title":"CMAQ化学机制及排放处理","text":"CB机制排放处理 问题1： MEIC只提供CB05排放，CB6机制中需要额外的物种排放（ACET, BENZ, KET, ETHY, PRPA) 解决方案：使用SAPRC07机制中的替代（参考Huang et al., 2023, STE） 问题2：CB05 和CB6中都需要XYLMN, SOAALK, and NAPH排放，If you have an emission files without XYLMN, SOAALK, and NAPH, you can estimate these as follows: These estimates are approximate and are based on the 2011 NEIv1. Use at your own discretion: 1234NAPH (moles) = 0.002 * XYL (moles)XYLMN (moles) = 0.998 * XYL (moles)PAR(new)(moles) = PAR (moles) -0.00001*NAPH(moles)SOAALK (moles) = 0.108*PAR (moles) PAR(=PAR-3ACET-BENZ-2ETHY-KET-1.5PRPA)","link":"/blog/2022/10/25/CMAQ%E5%8C%96%E5%AD%A6%E6%9C%BA%E5%88%B6%E5%8F%8A%E6%8E%92%E6%94%BE%E5%A4%84%E7%90%86/"},{"title":"FORTRAN编译问题","text":"make成功，运行时候出现问题（切换到预报服务器和AMD服务器上出现的问题） Please verify that both the operating system and the processor support Intel(R) X87, CMOV, MMX, FXSAVE, SSE, SSE2, SSE3 and SSSE3 instructions. 删除FFLAG中的 -xSSSE3 选项 1234# change from FFLAGS = -O3 -ip -march=core2 -mtune=core2 -xSSSE3 -axSSSE3 -fp-model precise -lpthread -qopenmp# to FFLAGS = -O3 -ip -march=core2 -mtune=core2 -axSSSE3 -fp-model precise -lpthread -qopenmp 报错问题：程序运行报错，Fatal Error: This program was not built to run in your system. Please verify that both the operating system and the processor support Intel(R) AVX. yhrun: error: cn2375: task 0: Exited with exit code 1 原因：该错误说明程序的编译时环境和运行时环境不一致，即程序编译时使用了支持 AVX 的选项，运行时的硬件环境不支持该 AVX 优化。一般这种情况发生是由于用户在编译程序时加入 -xHOST/-xAVX 选项（或是在安装软件时，系统自动读取到登陆节点上 CPU 的 flag 支持 avx ，故在编译软件时加入了 -xHOST），那程序就会根据登陆节点的 CPU 配置信息进行优化编译，然而程序的运行是在计算节点上，计算节点的 CPU配置信息可能不支持 AVX，就与登陆节点不同，就会报上面的提示错误。 解决方法：编译时去掉 -xHOST/-xAVX 选项，使用其他优化选项。 备注：-xHost will cause icc/icpc or icl to check the cpu information and find the highest level of extended instructions support to use. 天河登陆节点 ln1、ln2、ln3 上的 CPU 配置信息 flag 均无 avx ，ln8、ln9上均有 avx 。 如果在 ln8 或 ln9 上安装软件时，configure 后一定要检查下编译 flag 是否加入了 -xHOST，如果加入，请修改对应的 configure 文件，将 -xHOST 删除。","link":"/blog/2022/10/25/FORTRAN%E7%BC%96%E8%AF%91%E9%97%AE%E9%A2%98/"},{"title":"HazeDayIndex","text":"Cai et al., 2017, NCC 10.1038/nclimate3249 Haze weather index (HWI) Because V850, $\\Delta{T}$ and U500 are not independent, we normalized each time series by its respective standard deviation and summed the three normalized time series to construct a single index. Zhang et el., 2018, EP https://doi.org/10.1016/j.envpol.2018.08.019 Haze Day Index (HDI) Horton et al., 2014, NCC DOI: 10.1038/NCLIMATE2272 Air Stagnation Index (ASI) A grid cell day is considered stagnant when daily-mean near-surface (10-m) wind speeds are &lt;3.2 m s−1 , daily-mean mid-tropospheric (500 mb) wind speeds are &lt;13 m s−1 , and daily-mean precipitation accumulation is &lt;1 mm. Wang et al., 2018, BMAS doi:10.1175/BAMS-D-16-0301.1 air stagnation day","link":"/blog/2022/11/01/HazeDayIndex/"},{"title":"WRF&#x2F;Chem","text":"安装 问题1：configure之后需要修改下configure.wrf文件，mpif90改成mpiifort 人为排放处理需要matlab，必须在admin上运行 WRF-Chem 文档说明 Grell 2005 Fully coupled ‘‘online’’ chemistry within the WRF model; AE 运行排放处理 关于wildfire排放 在Registry/registry.chem中，有物种定义 package biomassb biomass_burn_opt==1 - state:mean_fct_agtf,mean_fct_agef,mean_fct_agsv,mean_fct_aggr,firesize_agtf,firesize_agef,firesize_agsv,firesize_aggr;ebu:ebu_no,ebu_no2,ebu_co,ebu_co2,ebu_eth,ebu_hc3,ebu_hc5,ebu_hc8,ebu_ete,ebu_olt,ebu_oli,ebu_pm25,ebu_pm10,ebu_dien,ebu_iso,ebu_api,ebu_lim,ebu_tol,ebu_csl,ebu_hcho,ebu_ald,ebu_ket,ebu_macr,ebu_ora1,ebu_ora2,ebu_so2,ebu_nh3,ebu_oc,ebu_bc,ebu_sulf,ebu_dms;ebu_in:ebu_in_no,ebu_in_no2,ebu_in_co,ebu_in_co2,ebu_in_eth,ebu_in_hc3,ebu_in_hc5,ebu_in_hc8,ebu_in_ete,ebu_in_olt,ebu_in_oli,ebu_in_pm25,ebu_in_pm10,ebu_in_dien,ebu_in_iso,ebu_in_api,ebu_in_lim,ebu_in_tol,ebu_in_csl,ebu_in_hcho,ebu_in_ald,ebu_in_xyl,ebu_in_ket,ebu_in_macr,ebu_in_ora1,ebu_in_ora2,ebu_in_so2,ebu_in_nh3,ebu_in_oc,ebu_in_bc,ebu_in_sulf,ebu_in_dms,ebu_in_ash ebu表示最终模式需要的物种；ebu_in 表示排放文件中的物种（wrffirechemi_d01文件中，物种名称为ebu_in_no） 数据处理流程 数据读取程序为share/mediation_integrate.F, 数据读到ebu_in数组中（此为推测），如下： ```fortranCALL med_auxinput_in ( grid, ialarm, config_flags ) WRITE ( message , FMT='(A,i3,A,i3)') 'Input data processed for aux input ',&amp; ialarm - first_auxinput + 1, ' for domain ',grid%id 1234567891011121314151617181920212. 在```chem/emissions_driver.F```程序中调用 ```do_plumerisefire```将```ebu_in```赋值给```ebu```, - 涉及子程序```chem/module_plumerise1.f90``` - ```do_plumerisefire```是根据```namelist.input```中的```plumerisefire_frq```来设置的，每隔一段时间运行一次 - ```fortran if( do_plumerisefire )then CALL wrf_debug(15,'fire emissions: calling biomassb') write(0,*)ktau,stepfirepl call plumerise_driver (id,ktau,dtstep, &amp; ebu,ebu_in, &amp; mean_fct_agtf,mean_fct_agef,mean_fct_agsv,mean_fct_aggr, &amp; firesize_agtf,firesize_agef,firesize_agsv,firesize_aggr, &amp; config_flags, t_phy,moist, &amp; rho_phy,vvel,u_phy,v_phy,p_phy, &amp; emis_ant,z_at_w,z,config_flags%scale_fire_emiss, &amp; ids,ide, jds,jde, kds,kde, &amp; ims,ime, jms,jme, kms,kme, &amp; its,ite, jts,jte, kts,kte ) endif 在chem/emissions_driver.F程序中调用 add_emis_burn： ```fortran CASE (BIOMASSB,BIOMASSB_MOZC,BIOMASSB_MOZ,BIOMASSB_GHG) CALL wrf_debug(15,'fire emissions: adding biomassb emissions') call add_emis_burn(id,dtstep,ktau,dz8w,rho_phy,chem,&amp; julday,gmt,xlat,xlong,t_phy,p_phy, &amp; ebu,config_flags%chem_opt,0,config_flags%biomass_burn_opt, &amp; num_chem,ids,ide, jds,jde, kds,kde, &amp; ims,ime, jms,jme, kms,kme, &amp; its,ite, jts,jte, kts,kte ) 123456789101112131415161718- 注意：```chem/module_add_emiss_burn.F```中将排放中的物种分配给不同的化学机制- ```fortran emiss_select: SELECT CASE(chem_opt) CASE (RADM2,RACM_KPP,RACM_MIM_KPP,SAPRC99_KPP,SAPRC99_MOSAIC_4BIN_VBS2_KPP, &amp; SAPRC99_MOSAIC_8BIN_VBS2_AQ_KPP, SAPRC99_MOSAIC_8BIN_VBS2_KPP) do j=jts,jte do i=its,ite do k=kts,kte conv_rho=r_q*4.828e-4/rho_phy(i,k,j)*dtstep/60./dz8w(i,k,j) chem(i,k,j,p_csl) = chem(i,k,j,p_csl) &amp; +ebu(i,k,j,p_ebu_csl)*conv_rho chem(i,k,j,p_iso) = chem(i,k,j,p_iso) &amp; +ebu(i,k,j,p_ebu_iso)*conv_rho chem(i,k,j,p_no) = chem(i,k,j,p_no) &amp; +ebu(i,k,j,p_ebu_no)*conv_rho 注意，在emissions_driver.F中，由于不同化学机制的物种不一样，需要对读入的排放数据进行匹配（mapping）， 存在问题，saprc99机制中并没有正确读入野火排放数据，VOC的mapping是和其他机制一样，比如chem/module_add_emiss_burn.F文件中，saprc99机制中并没有HC3物种，只有ALK，所以p_hc3=1,读入的ebu(p_ebu_hc3)排放赋值给了一个不存在的物种！！！ 需要修改，参考Simulating Air Pollution in the Severe Fires Event during 2015 El-Niño in Indonesia using WRF-Chem MOSAIC气溶胶模块 mosaic bin粒径范围设置, 在module_mosaic_driver.F程序中 ```fortran!! set section size arrays! do itype = 1, ntype_aer nhi = nsize_aer(itype) dlo_sect(1,itype) = 3.90625e-6 dhi_sect(nhi,itype) = 10.0e-4 dum = log( dhi_sect(nhi,itype)/dlo_sect(1,itype) ) / nhi !replaced alog by log by Manish Shrivastava on 11/28/2011. alog denoted natural log in fortran 77. log(x) is natural log in fortran 90 do n = 2, nhi dlo_sect(n,itype) = dlo_sect(1,itype) * exp( (n-1)*dum ) dhi_sect(n-1,itype) = dlo_sect(n,itype) end do do n = 1, nhi dcen_sect(n,itype) = sqrt( dlo_sect(n,itype)*dhi_sect(n,itype) ) volumlo_sect(n,itype) = (pi/6.) * (dlo_sect(n,itype)**3) volumhi_sect(n,itype) = (pi/6.) * (dhi_sect(n,itype)**3) volumcen_sect(n,itype) = (pi/6.) * (dcen_sect(n,itype)**3) sigmag_aer(n,itype) = (dhi_sect(n,itype)/dlo_sect(n,itype))**0.289 end do end do 12345678910111213141516171819202122232425262728- 简化测试8bin的结果如下： - ```fortran program main real dlo_sect(8) real dhi_sect(8) integer nhi nhi = 8 dlo_sect(1) = 3.90625e-6 dhi_sect(nhi) = 10.0e-4 dum = log( dhi_sect(nhi)/dlo_sect(1) ) / nhi do n = 2, nhi dlo_sect(n) = dlo_sect(1) * exp( (n-1)*dum ) dhi_sect(n-1) = dlo_sect(n) end do print*,dlo_sect print*,dhi_sect end ! 输出为 3.9062502E-06 7.8125004E-06 1.5625001E-05 3.1250001E-05 6.2500003E-05 1.2500001E-04 2.5000001E-04 5.0000002E-04 7.8125004E-06 1.5625001E-05 3.1250001E-05 6.2500003E-05 1.2500001E-04 2.5000001E-04 5.0000002E-04 1.0000000E-03 ! 4 bins 3.9062502E-06 1.5625001E-05 6.2500003E-05 2.5000001E-04 1.5625001E-05 6.2500003E-05 2.5000001E-04 1.0000000E-03 saprc99_mosaic_8bin_vbs2_aq (chem_opt=203)说明 参考文献Shrivastava, M., Fast, J., Easter, R., Gustafson Jr, W. I., Zaveri, R. A., Jimenez, J. L., Saide, P., and Hodzic, A.: Modeling organic aerosols in a megacity: comparison of simple and complex representations of the volatility basis set approach, Atmos. Chem. Phys., 11, 6639-6662, 10.5194/acp-11-6639-2011, 2011. SAPRC-99 mechanism with The 9-species VBS mechanism / highly condensed 2-species SOA mechanism POA的计算 The POA species are segregated by two emissions sectors: biomass burning and anthropogenic (predominately fossil fuel) To allow calculating O:C ratios for the modeled OA, separate model species are used for the oxygen and non-oxygen (C, H, N) components of each species. POA(a)i,e,x,n = aerosol-phase POA, where i is the volatility species (1–9), e is either the biomass or anthropogenic emission sector, x is either the oxygen or non-oxygen component, and n is the size bin (1–4). 模式中的POA物种名如，pcg1_b_c、pcg2_f_c SOA的计算 SOA包括两个部分 SI-SOA: formation from S/IVOC, 模式中物种名和POA对应，opcg1_b_c、opcg2_f_c V-SOA: formation from trantional VOCs,模式中物种名分别为ant1_c和biog1_c，分别表示来自人为排放VOC和自然排放VOC 可以从KPP中的mechanism文件中看出saprc99_mosaic_8bin_vbs2_aq.eqn WRF-Chem中使用的实际上是SAPRC-99 mechanism with highly condensed 2-species SOA mechanism，只考虑了2种挥发性的POA，即 $C^∗\\ values\\ (at\\ 298\\ K\\ and\\ 1\\ atm)\\ of\\ 10^{−2}\\ and\\ 10^5\\ µg\\ m^{−3} $ there are 40 POA species (8 gas, 32 aerosol), 20 SI-SOA species (4 gas, 16 aerosol), and 10 V-SOA species (2 gas, 8 aerosol) （Shrivastava的文章中使用的是4bin的MOSAIC方案） 其中POA中POA(a)i = 2,e,x would almost entirely remain in the gas phase under most atmospheric conditions due to its high volatility，因此模式只输出16个aerosol物种 注意： 在8binMOSAIC方案中，V-SOA只输出了4个bin（共8 aerosol，同4bin方案），其他bin的变量没有输出，在register.chem中有定义 气溶胶光学性质的计算总体思路（以MOSAIC方案为例） 相同bin中内混，不同bin之间外混；对特定的bin[i]： 计算各组分质量$M_{i,j}$和数浓度$N_i$ 根据质量和数浓度计算体积$V_{i,j}$和直径$D_{p,i}$ 计算负折射指数(这里会根据混合方式的不同[表现在模式中即option_method]分别计算)： volume averaging approximation: 总的负折射率等于质量加权平均 Maxwell-Garnett approximation：根据Maxwell-Garnett计算 shell-core mixing：分别计算核和壳的负折射指数 调用mie散射算法计算总的吸收效率、散射效率和不对称因子（这里会根据option_mie选项有两种方法）： option_mie=1 切比雪夫多项式近似… Chebyshev economization 即简化了Mie散射计算过程 option_mie=2 完整的Mie散射算法 程序中细节说明 气溶胶光学性质参数的计算程序 optical_driver.F module_optical_averaging.F 重要的子程序 subroutine optical_prep_sectional， 准备Mie散射计算需要的相关数据 根据气溶胶组分数据计算下列变量： ```fortranradius_core,radius_wet, number_bin, &amp;swrefindx,swrefindx_core,swrefindx_shell, &amp;lwrefindx,lwrefindx_core,lwrefindx_shell ! number_bin_col(nbin_a,kmaxd) — number density in layer, #/cm^3! radius_wet_col(nbin_a,kmaxd) — wet radius, shell, cm! radius_core_col(nbin_a,kmaxd) — core radius, cm; NOTE: 1234567891011121314151617181920212223 - **如果需要修改Mie散射计算结果，可以在此处增加相关变量** 2. subroutine optical_averaging ，其中，会调用 - optical_prep_sectional 子程序： 计算*3-D arrays for refractive index, wet radius, and aerosol number then passed into mieaer_sectional* - mieaer程序： *produces vertical profiles of aerosol optical properties for 4 wavelengths that are put into 3-D arrays and passed back up to chem_driver.F*，其中 - *tauaer\\*, waer\\*, gaer\\* passed to module_ra_gsfcsw.F* - *tauaer\\*, waer\\*, gaer\\*, l2-l7 passed to module_phot_fastj.F*- 输出变量说明： - ```fortran ! OUTPUT: saved in module_fastj_cmnmie ! real tauaer ! aerosol optical depth 气溶胶光学厚度 ! waer ! aerosol single scattering albedo 单次散射反照率 ! gaer ! aerosol asymmetery factor 不对称因子 ! extaer ! aerosol extinction 消光 ! l2,l3,l4,l5,l6,l7 ! Legendre coefficients, numbered 0,1,2,...... 勒让德系数 ! sizeaer ! average wet radius 平均湿半径 ! bscoef ! aerosol backscatter coefficient with units km-1 * steradian -1 JCB 2007/02/01 气溶胶后向散射系数 问题： 如果要修改MIE散射的计算结果，可以在 call mieaer 语句之后添加修改 怎么在wrfout中输出tauaer等参数？grid%tauaer1?改register文件， namelist.input中设置 opt_pars_out = 1, 计算AOD： To calculate AOD, you just need to integrate the extinction coef throughout the entire model column; i.e. multiple the extinction coef by the thickness of the model box and sum all the boxes: AOD = ∑ EXT(l) * dz(l) With these namelist options, you should have EXTCOEF55 variable in the output that represents the exticntion coefficient at 550 nm in the units of km^-1. You need to calculate layer thickness (can be done by using PH and PHB variables from the WRF-Chem output). The final step is to calculate AOD as multiplication of EXTCOEF55 with the layer thickness (make sure you have it in km). Alternatively, you can add “tauaer1, tauaer2, tauaer3, and tauaer4” to the model output using runtime I/O option. They represent layer AOD at 300, 400, 600, and 999 nm. The vertical integral of these quantities will give you total AOD at these wavelengths and then you can use the Angstrom power law to derive AOD at any wavelength. ```matlab ##################################### Calculation Using MATLABHeight_in_Km = ((PH + PHB)/(9.81))*(1000) ##### This will calculate the height between WRF levels in Km where PH = Perturbation Geopotential and PHB = Base-State Geopotential. Then if you have number of levels in your output is suppose K for X=1:K Distance_Between_Levels (:,:,X) = Height_in_Km(:,:,X+1) - Height_in_Km(:,:,X); EXTCOF55_Converted(:,:,X) = (EXTCOF55(:,:,X).*Distance_Between_Levels(:,:,X)); end AOD(:,:)= nansum(EXTCOF55_Converted,3); ############## Mean of the Level Dimension ######### ############################################## END123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263 - The way I calculate AOD is by using the variables named TAUAER1, TAUAER2, TAUAER3 and TAUAER4. These variables are the aerosol optical depth of each model layer at 300, 400, 600 and 1000 nm, respectively. To calculate the optical depth at another wavelength then you have to calculate the Angstrom exponent following the formula shown in https://en.wikipedia.org/wiki/Angstrom_exponent E.g. I calculate the total AOD in the column at 550 nm using TAUAER2 and TAUAER3 because the 550 nm wavelength falls between 400 and 600 nm: angstrom_exponent = -( log(TAUAER2) - log(TAUAER3) ) / log(400/600) AOD550_3D = TAUAER2 * ( (400/550) ^ angstrom_exponent ) AOD550_2D = sum(AOD550_2D,3) AOD550_3D is the 3-dimensional AOD where you have an optical depth for each layer of your model. Then, the total column AOD is simply the sum across the third dimension. If the variables TAUAER&lt;n&gt; are not listed in your model outputs, then you need to modify the registry file for chemistry (Registry/registry.chem)and compile again: state real tauaer1 ikj misc 1 - rh &quot;TAUAER1&quot; &quot;bin 1 layer optical thickness&quot; &quot;?&quot; state real tauaer2 ikj misc 1 - rh &quot;TAUAER2&quot; &quot;bin 2 layer optical thickness&quot; &quot;?&quot; state real tauaer3 ikj misc 1 - rh &quot;TAUAER3&quot; &quot;bin 3 layer optical thickness&quot; &quot;?&quot; state real tauaer4 ikj misc 1 - rh &quot;TAUAER4&quot; &quot;bin 4 layer optical thickness&quot; &quot;?&quot;```fortran! key options for aerosol optical properities aer_op_opt ! 1-5 设置光学性质计算方法 ! 根据aer_op_opt 设置 option_method 和 option_mie. ! option_method is used to set the method of aerosol optical properties ! 1. volume averaging mixing ! 2. Maxwell-Garnett mixing ! 3. shell-core ! option_mie is used to set the method of mie routines aer_op_opt_select: SELECT CASE(config_flags%aer_op_opt) CASE (VOLUME_APPROX) option_method=1 option_mie=1 CASE (MAXWELL_APPROX) option_method=2 option_mie=1 CASE (VOLUME_EXACT) option_method=1 option_mie=2 CASE (MAXWELL_EXACT) option_method=2 option_mie=2 CASE (SHELL_EXACT) option_method=3 option_mie=2 CASE DEFAULT! option_mie 选择怎么计算mie散射! option_method 选择怎么计算光学性质! namelist.input 选项aer_op_opt = 1 aerosol optical properties calculated based upon volume approximation = 2 aerosol optical properties calculated based upon Maxwell approximation = 3 aerosol optical properties calculated based upon exact volume approximation = 4 aerosol optical properties calculated based upon exact Maxwell approximation = 5 aerosol optical properties calculated based upon exact shell approximation! 只有1和2选项才计算长波,后面三个只算短波 说明 [Bond et al., 2013, JGR] 提到: using the Bond and Bergstrom [2006] refractive index and density, Adachi et al. [2010] calculated $MAC_{BC}$ for uncoated spheres as 6.4 $m^2g^{-1}$, with increases for volume mixing (13.6 $m^2g^{-1}$), core shell (13.3 $m^2g^{-1}$), Maxwell-Garnet effective medium approximation (12.0 $m^2g^{-1}$), and realistic coated BC particles (9.9 $m^2g^{-1}$) at 550 nm wavelength. Climate models assume soot particles are spherical and (1) uncoated (external‐mixing model), (2) concentrically coated (core‐shell model), (3) homogeneously mixed with other materials on a molecular scale (volume‐mixing model), (4) mixed with other aerosol particles according to rules such as the Maxwell‐Garnet effective medium approximation (MGEMA), which assumes that isolated soot spherules are suspended in an embedding material","link":"/blog/2022/10/25/WRFChem/"},{"title":"WRFChem气溶胶光学性质","text":"WRFChem中的气溶胶方案 sectional approach: MOSAIC (Model for Simulating Aerosol Interactions and Chemistry) modal approach: MADE (Modal Aerosol Dynamics Model for Europe), MAM (Modal Aerosol Model from CAM5) bulk approach: GOCART (Goddard Global Ozone Chemistry Aerosol Radiation and Transport model) 不同方案的验证 MOSAIC Barnard et al. (2010) and Lennartson et al. (2018) analyze the diurnal variation of AOD Ghan et al. (2001) evaluated the radiative impact of including coupled aerosol–cloud–radiation processes. Other studies assessing the representation of aerosol optical properties and their uncertainties using MOSAIC together with other schemes, mainly MADE Zhao et al., 2010, 2011, 2013; Balzarini et al., 2015; Yang et al., 2018; Saide et al., 2020 GOCART LeGrand et al., 2019 compared the Air Force Weather Agency (AFWA) dust emission scheme within GOCART to other dust emission schemes available in WRF-Chem and their skills for representing AOD In this contribution, the need for tuning the model in order to get a reasonable simulation of AOD for each location and/or event was pointed out based on the results of Bian et al. (2011), Dipu et al. (2013), Kumar et al. (2014), Jish Prakash et al. (2015), Zhang et al. (2015), Kalenderski and Stenchikov (2016), and Hu et al. (2020), among others.","link":"/blog/2022/10/25/WRFChem%E6%B0%94%E6%BA%B6%E8%83%B6%E5%85%89%E5%AD%A6%E6%80%A7%E8%B4%A8/"},{"title":"WRF&#x2F;Chem模式运行记录","text":"运行历史记录 第一次运行 参数化方案选择组里常用，和Li et al., 2023, EI一致 chembdy没有打开，只有初始场 d02模拟结果和观测对比有偏差，后面几天低估明显 第二次运行(调整不同参数) 改变模型版本（使用revised版本,copy from linan）,其他不变（basecase_RM） 修改模型版本后，SO4, nh4, SOA浓度增加，其他组分不变 chembdy打开(have_bcs_chem=.ture.)、obsgrid打开（basecase_OBS） 上两种改变同时进行（basecase_RMOBS） 存在问题： 气象模拟不对，温度和RH偏差很大","link":"/blog/2022/10/25/WRFChem%E8%BF%90%E8%A1%8C%E8%AE%B0%E5%BD%95/"},{"title":"WRF&#x2F;Chem模式运行说明","text":"WRFChem运行目录说明 运行wrfchem的程序和脚本在 /home/xdxie/data/wrfchemdata/beijing201612 只需要复制 presource scripts WPS WRFChem-3.9.1-revised这几个文件夹 123456789101112131415161718WPS/WRFChem-3.9.1-revised: 主程序（WRF文件夹是WRF391 default版本，WRFChem-3.9.1-revised是WRF391李楠组版本，修改了SO4/GLY，见Li et al, EI，2022）scripts：运行脚本presource：运行前准备程序和文件 presource/domain：地形文件和namelist文件，需要在运行之前生成geo文件，并将相关文件复制到该目录 presource/*emiss：生成排放文件的程序 presource/mozbc：生成边界条件的程序data：结果数据文件 data/camchem：全球模式提供边界条件（需要自己下载对应的模拟时段数据，见下面说明） data下其他文件夹为对应case的结果文件,以basecase为例，包括 data/basecase/predata：排放、fnl链接（需要手动创建fnl目录，并将需要的fnl数据链接到该目录下） data/basecase/runwrfchem：wrf运行目录 data/basecase/combine：处理后的wrfout文件 data/basecase/results：提取的文本文件 data/basecase/figures：出图文件 运行流程 第一次运行需要设置domain和生成geo_em文件，WRF培训时有介绍 之后的所有运行步骤都在autorun.wrfchem.sh这个脚本中 1234567step1_wps: 运行ungrib.exe和metgrid.exestep2_real_w_o_chem: 运行不带化学过程的real.exe,这一步namelist中chem_opt要设置为0step3_emission： 生成排放，这一步中人为排放部分需要在admin上运行，需要自己安装matlabstep4_real_w_chem： 运行带化学过程的real.exestep5_mozbc: 使用camchem数据添加边界文件step6_wrf： 运行wrf.exestep7_wrf_from_existing_case：当step1-5不需要重新运行时，快速开始其他case的运行 运行的时候每次打开一个step，1-5步骤可以直接ssh到一个计算节点上，输入./autorun.wrfchem.sh运行 setp6或者step7需要使用pbs提交，修改wrfchem.jobs，然后在登录节点上输入qsub wrfchem.jobs提交任务 注意事项 下载camchem数据，路径https://www.acom.ucar.edu/cam-chem/cam-chem.shtml， 根据你的研究区域和时间下载对应文件，如lat,10.0,60.0 lon,60.0,160.0 chem_opt=203: SAPRC99_MOSAIC_8BIN_VBS2_AQ_KPP; SAPRC99 Chemistry with MOSAIC using KPP library. The MOSAIC aerosols uses 8 sectional aerosol bins and includes volatility basis set (VBS) for organic aerosol evolution. Also include aqueous phase chemistry. 在李楠的版本中，该选项对应MOSAIC_4bin 安装时候的问题：configure之后需要修改下configure.wrf文件，mpif90改成mpiifort 处理排放问题：人为排放处理需要matlab，必须在admin上运行 边界条件处理，mozbc，目前使用camchem， domain1：ic、bc都需要，其他domain，只需要ic， 运行wrf.exe时必须设置have_bcs_chem = .true. WRFChem后处理基本思路 wrfout文件很大，为了方便提取，第一步将需要的变量从wrfout文件中提取出来，生成新的nc文件 （step1_extra2nc.py） 然后再对新的nc文件处理 （step2,3,4等） 初步脚本（需要不断完善） 路径/home/xdxie/archive/tools/python_script/wrfchem_tools/extract_wrfchem, 会随时修改，建议copy到自己的目录下 脚本说明： 123456config.wrfchem.S99M8binVBS2AQ # 总的配置文件，需要用户自己修改，包括路径、时间、站点、变量等step1_extra2nc.py # 根据上面配置文件中的变量定义从wrfout中提取变量到nc， 放在data/basecase/combine文件夹step2.xxx.py # 从上面的nc文件中提取站点的数据，包括气象和污染物的，以及观测的（观测的只写了污染物的脚本，气象的没写要自己弄）step3.xxx.py # 一些画图脚本，计算统计参数脚本，不够完善，自己改改csv文件 # 站点信息的文件和城市经纬度信息文件 画空间图的脚本，/home/xdxie/archive/tools/python_script/wrfchem_tools/regional.plot， 用ncl的程序就行","link":"/blog/2022/10/25/WRFChem%E8%BF%90%E8%A1%8C%E8%AF%B4%E6%98%8E/"},{"title":"cartopy","text":"站点散点图 在地图上添加colorbar，并设置背景色 添加方框 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849dfs = pd.read_csv(f&quot;../obsdata/dMDA8_dPM25_day_station_{season}.csv&quot;)dfs = dfs.sort_values(&quot;slope&quot;)def cs_scater(ax, lat,lon,slope,p_value,colors,vmin,vmax): cs = ax.scatter(lon, lat,10, slope, cmap=colors,marker=&quot;s&quot;,vmin=vmin,vmax=vmax) cs2 = ax.scatter(lon[p_value&lt;0.1], lat[p_value&lt;0.1], 0.5, c=&quot;k&quot;) ax.add_geometries(china_border.geometries(), ccrs.PlateCarree(),edgecolor='k', linewidth=0.2, zorder=2, facecolor='none') ax.add_geometries(world_border.geometries(), ccrs.PlateCarree(),edgecolor='k', linewidth=0.5, zorder=2, facecolor='none') #标注坐标轴 ax.set_extent([101,132,21,48]) ax.set_xticks(np.linspace(102,130,5), crs=ccrs.PlateCarree()) ax.set_yticks([25,30,35,40,45], crs=ccrs.PlateCarree()) #zero_direction_label用来设置经度的0度加不加E和W lon_formatter = LongitudeFormatter(zero_direction_label=False) lat_formatter = LatitudeFormatter() ax.xaxis.set_major_formatter(lon_formatter) ax.yaxis.set_major_formatter(lat_formatter) for region, pts in cornersdict.items(): ax.plot([pts[0],pts[1],pts[1],pts[0],pts[0]],[pts[2],pts[2],pts[3],pts[3],pts[2]],'k-',lw=0.5) return csproj = ccrs.PlateCarree()fig = plt.figure(figsize=(3,3))ax = fig.add_subplot(1,1,1, projection=proj) cs = cs_scater(ax,dfs.lat,dfs.lon,dfs.slope.values,dfs.p.values,cmaps.CBR_coldhot,-3,3)cbbox = ax.inset_axes([0.74, 0.01, 0.25, 0.15])[cbbox.spines[k].set_visible(False) for k in cbbox.spines]cbbox.tick_params(axis='both', left=False, top=False, right=False, bottom=False, labelleft=False, labeltop=False, labelright=False, labelbottom=False)cbbox.set_facecolor('w')caxes = cbbox.inset_axes([0.1, 0.4, 0.8, 0.23])cbar = fig.colorbar(cs,orientation=&quot;horizontal&quot;,cax=caxes)cbar.ax.tick_params(axis='x', direction='in',length=5)cbar.set_label(&quot;$Fitted\\ slope$&quot;,loc=&quot;center&quot;,labelpad=-23)cticks= [-3,0,3]; cbar.set_ticks(cticks); cbar.set_ticklabels(cticks)ax.text(0.05,0.9,&quot;$2015-2020$&quot;,transform=ax.transAxes,ha=&quot;left&quot;)plt.savefig(f'../figures/dMDA8_dPM25_day_station_{season}',bbox_inches='tight',pad_inches = 0.05, dpi=300, facecolor='w')","link":"/blog/2022/10/25/cartopy/"},{"title":"hexoguide","text":"Hexo 博客常见问题图片问题 参考 https://github.com/cocowool/hexo-image-link 安装hexo-image-link 新建新的页面（tags, categories, about）hexo new page tags 新建的页面出现在souce文件夹下，修改对应的index.md文件： 12345title: tagsdate: 2022-10-24 09:02:56index: truelayout: tagstype: tags ICARUS主题1234$ npm install hexo-theme-icarus$ hexo config theme icarus# 配置文件为 _config.icarus.yml# reference： https://ppoffice.github.io/hexo-theme-icarus/ 新建博客hexo new name 增加宽度如要改变挂件或主内容宽度，编辑&lt;icarus_directory&gt;/layout/common/widgets.jsx和&lt;icarus_directory&gt;/layout/layout.jsx。 在这些文件中找到诸如is-12，is-8-tablet，和is-4-widescreen这样的CSS类名。 CSS类名中的数字标志着一个挂件或主内容所占据的栏数量。 数字后的屏幕尺寸，如tablet和widescreen，指代着栏数量生效的屏幕尺寸条件。 修改类名中的数字使主内容栏的栏数量和所有挂件栏的栏数量在相同屏幕尺寸下相加等于12。 例如，为使主内容栏在宽屏(widescreen)下更宽，你可以做出如下修改： 12345678910111213141516171819&lt;icarus_directory&gt;/layout/layout.jsx &lt;div class={classname({ column: true, 'order-2': true, 'column-main': true, 'is-12': columnCount === 1,- 'is-8-tablet is-8-desktop is-8-widescreen': columnCount === 2,+ 'is-8-tablet is-8-desktop is-9-widescreen': columnCount === 2, 'is-8-tablet is-8-desktop is-6-widescreen': columnCount === 3&lt;icarus_directory&gt;/layout/common/widgets.jsx function getColumnSizeClass(columnCount) { switch (columnCount) { case 2:- return 'is-4-tablet is-4-desktop is-4-widescreen';+ return 'is-4-tablet is-4-desktop is-3-widescreen'; case 3: return 'is-4-tablet is-4-desktop is-3-widescreen'; 你可以参考Bulma文档来获取更多关于布局系统的细节。 在Hexo中渲染MathJax数学公式在用markdown写技术文档时，免不了会碰到数学公式。常用的Markdown编辑器都会集成Mathjax，用来渲染文档中的类Latex格式书写的数学公式。基于Hexo搭建的个人博客，默认情况下渲染数学公式却会出现各种各样的问题。 原因Hexo默认使用”hexo-renderer-marked”引擎渲染网页，该引擎会把一些特殊的markdown符号转换为相应的html标签，比如在markdown语法中，下划线’_’代表斜体，会被渲染引擎处理为&lt;em&gt;标签。 因为类Latex格式书写的数学公式下划线 ‘_’ 表示下标，有特殊的含义，如果被强制转换为&lt;em&gt;标签，那么MathJax引擎在渲染数学公式的时候就会出错。例如，$x_i$在开始被渲染的时候，处理为$x&lt;em&gt;i&lt;/em&gt;$，这样MathJax引擎就认为该公式有语法错误，因为不会渲染。 类似的语义冲突的符号还包括’*’, ‘{‘, ‘}’, ‘\\’等。 解决方法解决方案有很多，可以网上搜下，为了节省大家的时间，这里只提供亲身测试过的最靠谱的方法。 更换Hexo的markdown渲染引擎，hexo-renderer-kramed引擎是在默认的渲染引擎hexo-renderer-marked的基础上修改了一些bug，两者比较接近，也比较轻量级。 12npm uninstall hexo-renderer-marked --savenpm install hexo-renderer-kramed --save 执行上面的命令即可，先卸载原来的渲染引擎，再安装新的。 然后，跟换引擎后行间公式可以正确渲染了，但是这样还没有完全解决问题，行内公式的渲染还是有问题，因为hexo-renderer-kramed引擎也有语义冲突的问题。接下来到博客根目录下，找到node_modules\\kramed\\lib\\rules\\inline.js，把第11行的escape变量的值做相应的修改： 12// escape: /^\\\\([\\\\`*{}\\[\\]()#$+\\-.!_&gt;])/, escape: /^\\\\([`*\\[\\]()#$+\\-.!_&gt;])/ 这一步是在原基础上取消了对\\,{,}的转义(escape)。 同时把第20行的em变量也要做相应的修改。 12// em: /^\\b_((?:__|[\\s\\S])+?)_\\b|^\\*((?:\\*\\*|[\\s\\S])+?)\\*(?!\\*)/, em: /^\\*((?:\\*\\*|[\\s\\S])+?)\\*(?!\\*)/ 重新启动hexo（先clean再generate）,问题完美解决。哦，如果不幸还没解决的话，看看是不是还需要在使用的主题中配置mathjax开关。 在主题中开启mathjax开关如何使用了主题了，别忘了在主题（Theme）中开启mathjax开关，下面以next主题为例，介绍下如何打开mathjax开关。 进入到主题目录，找到_config.yml配置问题，把mathjax默认的false修改为true，具体如下： 1234# MathJax Supportmathjax: enable: true per_page: true 别着急，这样还不够，还需要在文章的Front-matter里打开mathjax开关，如下： 123456---title: index.htmldate: 2016-12-28 21:01:30tags:mathjax: true-- 不要嫌麻烦，之所以要在文章头里设置开关，是因为考虑只有在用到公式的页面才加载 Mathjax，这样不需要渲染数学公式的页面的访问速度就不会受到影响了。 Hexo博客设置文章加密今天给大家推荐一款适用于 Hexo 的静态博客加密插件：hexo-blog-encrypt，搭配此插件你可以写一些比较私密的博客，通过密码验证的方式让其他人不能随意浏览。 1、安装插件首先运行以下命令，安装设置密码所需要的插件： npm install hexo-blog-encrypt2、修改配置在根目录的配置文件_config.yml中添加以下代码： 12encrypt: enable: true 3、博客文章添加加密字段设置加密之后，不要忘记在新建博文的时候，在头部添加加密的设置信息，如下图： 12password: 密码message: 输入密码界面提示说明 Hexo gitee 搭建博客必须的软件：node.js node.js官方网站：http://nodejs.cn/download/ node.js阿里云镜像站：https://npm.taobao.org/mirrors/node/ Git Git官网(下载速度可能稍慢)：https://git-scm.com/ Git阿里云镜像站（推荐）：https://npm.taobao.org/mirrors/git-for-windows/ 可根据个人喜好替换的软件：Visual Studio Code 官方网站：https://code.visualstudio.com/Download typora 官方网站：https://www.typora.io/ 以上软件若你下载速度慢，可以在这篇文章底部找到我已经下载好了的国内链接，链接里不定期更新以上软件的版本（保证均从官网下载下来不做任何修改）。当然最好是自己去官网下，因为我懒，更新不会很频繁，除非你催我一下（发邮件或者其他什么的）…… 要用到的框架或平台：Hexo 官方网站：https://hexo.io/zh-cn/ Gitee（码云） 官方网站：https://gitee.com/ 安装说明node.js和Typora就不说了，这个灰常简单。 至于Git，它安装的时候选项挺多的，而且还都是洋文，看不懂的话就全部选 next 就行了。你要是非得搞明白它每个选项的意思，emmmm那建议你们自己去搜吧，网上一搜一大把。我反正是不知道每项的意思，（全是废话…）我也不想知道~/手动狗头 检验是否成功安装用 Win + R 打开运行，输入 cmd 并进入cmd窗口 node.js 的检查1node -v npm的检查NPM是随同NodeJS一起安装的包管理工具，能解决NodeJS代码部署上的很多问题 1npm -v Git 的检查1git --version 以上有显示版本号，则说明安装成功 Hexo的安装1、安装之前可以先设置一下淘宝镜像加速器1npm install -g cnpm --registry=https://registry.npm.taobao.org 2、全局安装框架1npm install hexo-cli -g 3-1、创建你的博客目录1hexo init 你博客的文件夹名字 3-2、进入你博客的目录1cd 你博客的文件夹名字 4、复制文件到你博客的目录1npm install 5、安装Hexo部署插件请在你博客的目录下启动cmd，再执行以下代码 1npm install hexo-deployer-git --save Git的配置用 Win + R 打开运行，输入 cmd 并进入cmd 设置用户名称1git config --global user.name &quot;用户名&quot; 设置用户邮箱1git config --global user.email &quot;用户邮箱&quot; 生成密钥1ssh-keygen -t rsa -C &quot;用户邮箱&quot; 以上代码执行之后，会让你设置密码，推荐一个都不要设置，直接连按三次回车键。 博客 _config.yml 文件的配置打开你博客根目录的 _config.yml 文件，将一下信息添加到里面去。 1234567deploy: type: git repo: https://gitee.com/hcllmsx/hcllmsx.git #替换成你自己仓库的HTTP URL地址 branch: master 【注意区分】你博客根目录的 _config.yml 文件，和主题根目录的 _config.yml 文件！ Hexo常用代码1、清理缓存1hexo cl hexo cl 是 hexo clean 的简写 2、生成静态页面1hexo g hexo g 是 hexo generate 的简写 3、在本地映射（预览）1hexo s hexo s 是 hexo server 的简写 4、部署推送1hexo d hexo d 是 hexo deploy 的简写 5、以上连写示例一（清理缓存 + 生成静态页面 + 在本地预览）1hexo cl &amp;&amp; hexo g &amp;&amp; hexo s 6、以上连写示例二（清理缓存 + 生成静态页面 + 部署推送）1hexo cl &amp;&amp; hexo g &amp;&amp; hexo d 资源下载由于国内打开国外网站的速度有时候是看运气的，所以如果你下载很慢……可以选择下载我这里下载好的。另外，新建文章的通用模板也在里面，有了它可能会非（mei）常（you）方（luan）便（yong）。最后再再再再重申一次，尽量还是自己下载最新版，因为我更新挺懒的，除非你催我。 链接：https://msx.lanzoui.com/b0ewfyypa 密码：3t1u","link":"/blog/2022/10/23/hexoguide/"},{"title":"hexo备份","text":"Hexo博客如何备份到GithubHexo博客备份创建新分支在Github上博客仓库下创建一个新的分支hexo，并且将这个分支设置为默认分支，具体操作如下： 20220511_03.png 20220511_04.png 20220511_05.png 克隆hexo分支在本地把我们刚建的分支hexo克隆到本地： 20220511_06.png 把克隆下来的项目里面的.git文件复制到我们的Hexo博客目录下: 20220511_07.png 注意：如果之前搭建博客的时候自己更换过主题文件的，请把主题文件里面的.git文件删除。 开始备份进入到Blogs根目录下，执行如下命令： 123git add .git commit -m &quot;Blog源文件备份&quot;git push origin hexo 这时候我们会看到Github上的hexo 分支就有我们的源文件了。 20220511_08.png 如果你想要每次更改东西都希望备份到hexo 分支上，可以执行如下步骤： 12345hexo cleangit add .git commit -m &quot;2022&quot;git pushhexo g &amp; hexo d 如何恢复博客假如我们现在更换了电脑，希望在新的电脑上继续写博客，把Github上hexo分支上的项目克隆到本地（注意：是我们备份的那个分支） 进入到克隆下来的文件夹，执行如下命令： 12npm install hexo-clinpm install hexo-deployer-git 然后再去安装主题相关的插件即可，当然如果你电脑上还没有 Node.js等环境的话可能还需要去安装相关的环境。现在我们就基本上可以在另一台电脑上继续我们的博客之旅啦～","link":"/blog/2022/10/23/hexo%E5%A4%87%E4%BB%BD/"},{"title":"标准地图问题","text":"标准地图审图号shp GS(2020)4619 12345678910111213shpdir = &quot;D:/云文件/数据/shpfiles/GS(2020)4619&quot;world_border = Reader(f&quot;{shpdir}/coastline_withoutchina.shp&quot;)china_border = Reader(f&quot;{shpdir}/china.shp&quot;)province_border = Reader(f&quot;{shpdir}/province.shp&quot;)ax.add_geometries(china_border.geometries(), ccrs.PlateCarree(),edgecolor='k', linewidth=0.5, zorder=3, facecolor='none')ax.add_geometries(province_border.geometries(), ccrs.PlateCarree(),edgecolor='k', linewidth=0.2, zorder=3,ls='--', facecolor='none')ax.add_geometries(world_border.geometries(), ccrs.PlateCarree(),edgecolor='k', linewidth=0.2, zorder=3, facecolor='none') 南海地图 注意需要和主图一样的填充数据 1234567891011# 南海小地图ax_n = inset_axes(ax, &quot;100%&quot;, &quot;100%&quot;, bbox_to_anchor=(0.88,0.01,0.15,0.3), bbox_transform=ax.transAxes, #loc=&quot;center&quot;, axes_class=GeoAxes, axes_kwargs=dict(map_projection=proj))ax_n.pcolor(x, y, data2d, cmap=incmap,vmin=z_min, vmax=z_max,alpha=0.8)ax_n.set_extent([105, 123, 0, 25], ccrs.PlateCarree())ax_n.add_geometries(china_border.geometries(), ccrs.PlateCarree(),edgecolor='k', linewidth=0.2, zorder=2, facecolor='none') 实例脚本 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950def csplot(ax,x,y,data2d,incmap=cmaps.GMT_seis_r,z_min=0,z_max=75,htitle=None,vtitle=None,addmax=0,final=False,proj=None): cs = ax.pcolor(x, y, data2d, cmap=incmap,vmin=z_min, vmax=z_max,edgecolors='face') if(final): ax.add_geometries(world_border.geometries(), ccrs.PlateCarree(),edgecolor='k', linewidth=0.2, zorder=2, facecolor='none') ax.add_geometries(china_border.geometries(), ccrs.PlateCarree(),edgecolor='k', linewidth=0.5, zorder=2, facecolor='none') # 设置 colorbar ax.spines['top'].set_visible(False) ax.spines['right'].set_visible(False) ax.spines['bottom'].set_visible(False) ax.spines['left'].set_visible(False) if (addmax==1): for key,values in regiondict.items(): number = regionmean(data2d,values) # number = data2d.max() ax.text(0.02, 1.-values*0.1, '%s: %.1f' %(key,number),fontsize=12,transform=ax.transAxes, ha='left', va='center', color='k',zorder=3,) # bbox=dict(boxstyle=&quot;square&quot;,ec='w',fc='w',alpha=.8)) xy2 = np.array([0.0,0.45]) if(number&gt;100): rect = mpathes.Rectangle(xy2,0.38,0.6,color='#8ecae6',transform=ax.transAxes,zorder=3) else: rect = mpathes.Rectangle(xy2,0.35,0.6,color='#8ecae6',transform=ax.transAxes,zorder=3) ax.add_patch(rect) elif(addmax==0): number = data2d.mean() ax.text(0.08, .1, '%.1f' %(number),fontsize=12,transform=ax.transAxes, ha='left', va='center', color='k', bbox=dict(boxstyle=&quot;square&quot;,ec='w',fc='w',alpha=.8) ) else: pass if(htitle): ax.text(0.5, 1.1, htitle,fontsize=15,transform=ax.transAxes, ha='center', va='center') if(vtitle): ax.text(-0.1, 0.5, vtitle,fontsize=15,transform=ax.transAxes,rotation='vertical', ha='center', va='center')############################################################################################################### # 南海小地图 ax_n = inset_axes(ax, &quot;100%&quot;, &quot;100%&quot;, bbox_to_anchor=(0.88,0.01,0.15,0.3), bbox_transform=ax.transAxes, #loc=&quot;center&quot;, axes_class=GeoAxes, axes_kwargs=dict(map_projection=proj)) ax_n.pcolor(x, y, data2d, cmap=incmap,vmin=z_min, vmax=z_max,alpha=0.8) ax_n.set_extent([105, 123, 0, 25], ccrs.PlateCarree()) ax_n.add_geometries(china_border.geometries(), ccrs.PlateCarree(),edgecolor='k', linewidth=0.2, zorder=2, facecolor='none')############################################################################################################### return cs, ax_n","link":"/blog/2022/10/25/matplot_maps/"},{"title":"matplotlib example gallery","text":"折线图 散点图概率密度图 绘图细节设置","link":"/blog/2022/10/25/matplotlibexample/"},{"title":"numpy","text":"读取文件1234567891011# 经过pandas 读取后, 再写出,部分数据小数位数超长# 在read_csv时, 加入参数float_precision=“round_trip”, 所有数据会当做string读取, 使用时再进行相应的转换为floatdf = pd.read_csv('%s/%s_%s_%s.csv' %(outputdir, region, var, YYYYMM),float_precision=&quot;round_trip&quot;)# 读取csvpd.read_csv(&quot;filename&quot;,sep=',',header=None,index=False) # sep 分隔符, index 指定index列名obs = pd.read_csv(&quot;d04_chem.txt&quot;,delim_whitespace = True) # 空格分割# csv编码问题： VS code先用正确编码打开（GB…?），然后保存为正常编码（能正确显示GB…），然后重新保存为UTF-8格式，读取正常。# excel 常用的list 月份 12345678months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec']month = ['01','02','03','04','05','06','07','08','09','10','11','12']seasondict = { 'Spring':[3,4,5], 'Summer':[6,7,8], 'Autumn':[9,10,11], 'Winter':[1,2,12]} 区域范围定义 1234567891011121314151617llcrnrlon,urcrnrlon,llcrnrlat, urcrnrlat = 113.,119., 34., 41. # NCPllcrnrlon,urcrnrlon,llcrnrlat, urcrnrlat = 119.,122., 30., 33. # YRDllcrnrlon,urcrnrlon,llcrnrlat, urcrnrlat = 112.,115.5,21.5,24. # PRDllcrnrlon,urcrnrlon,llcrnrlat, urcrnrlat = 103.,107., 28.5,31.5 # SCB# ref. Li et al., PNAS, 2017cornersdict = { 'BTH':[114.,118., 37., 41.], 'YRD':[118.,122., 30., 33.], 'PRD':[112.,115.5,21.5,24.], 'SCB':[103.5,107., 28.5,31.5]}cornersdict = { 'CEC': [112., 122., 30., 41.], # from Shah et al., 2020, ACP, central-eastern China 'NCP': [113.75, 118.75, 35., 41.], # from Zhai et al., 2021, NG 'YRD': [118., 122., 30., 33.], 'PRD': [112., 115.5, 21.5, 24.], 'SCB': [103.5, 107., 28.5, 31.5]} 排序 12345change['Region'] = change.indexlist_custom = ['337城市',&quot;京津冀及周边&quot;,&quot;汾渭平原&quot;, '长三角', &quot;成渝地区&quot;,&quot;珠三角&quot;]change['Region'] = change['Region'].astype('category')change['Region'].cat.reorder_categories(list_custom, inplace=True)change.sort_values('Region', inplace=True) 配色123456789101112131415cnames = {'EC': '$BC$','OM': '$OM$','SO4':'$SO_4^{2-}$','NO3':'$NO_3^{-}$','NH4':'$NH_4^{+}$','Cl': '$Cl$','Other':'$MI$'}cdict = {'EC': '#231916','OM': '#009e42','SO4':'#e51620','NO3':'#212d8c','NH4':'#ef9817','Cl': '#d84d95','Other':'#cbced2'} 指定顺序排序1234list_custom = ['337城市',&quot;京津冀及周边&quot;,&quot;汾渭平原&quot;, '长三角', &quot;成渝地区&quot;,&quot;珠三角&quot;]regiondata['Region'] = regiondata['Region'].astype('category')regiondata['Region'].cat.reorder_categories(list_custom, inplace=True)regiondata.sort_values('Region', inplace=True) pandas按照根据指定列值插值123# 根据PM2.5的时间序列对其他组分进行插值data = pd.read_csv(&quot;ObservationData/OBS.csv&quot;,index_col='PM25')data.interpolate(method='index').to_csv(&quot;ObservationData/Obs_taizhou.csv&quot;) 获取数据落在bins区间的索引 - 用于按照污染物等级统计分析123456levels = [0, 100, 160, 200, 1000]O3 = data[&quot;O3&quot;]inds = np.digitize(O3,bins = levels)for i in range(1,5): print(i, O3[inds==i].mean()) 合并数组12np.column_stack((a,b)) #作为列合并np.row_stack((a,b)) # 作为行 数据框添加数据1234567891011df = pd.concat([df,pd.DataFrame.from_records([{ &quot;a&quot;:amax, &quot;b&quot;:bmax, &quot;sdate&quot;:df.index[i], &quot;edate&quot;:df.index[i+tmax-1], 'CO' :df[&quot;CO&quot;].iloc[i:i+tmax].mean(), 'NO2':df[&quot;NO2&quot;].iloc[i:i+tmax].mean(), 'O3' :df[&quot;O3&quot;].iloc[i:i+tmax].mean(), &quot;PM2.5&quot;:df[&quot;PM2.5&quot;].iloc[i:i+tmax].mean(), 'SO2':df[&quot;SO2&quot;].iloc[i:i+tmax].mean()}])]) 拼接两段数据123456789101112131415161718192021222324252627282930data2 = f.loc['2017-06-01':'2017-08-30']data3 = f.loc['2017-09-01':'2017-11-30']data1 = f.loc['2017-03-01':'2017-05-31']data4 = f.loc['2017-01-01':'2017-02-28']data5 = f.loc['2017-12-01':'2017-12-31']data0 = pd.concat([data4,data5])pd.concat([read_json(i) for i in adcodes],ignore_index=True)&gt;&gt;&gt; a=np.array([[1,2,3],[4,5,6]])&gt;&gt;&gt; b=np.array([[11,21,31],[7,8,9]])&gt;&gt;&gt; np.concatenate((a,b),axis=0)array([[ 1, 2, 3], [ 4, 5, 6], [11, 21, 31], [ 7, 8, 9]])&gt;&gt;&gt; np.concatenate((a,b),axis=1) #axis=1表示对应行的数组进行拼接array([[ 1, 2, 3, 11, 21, 31], [ 4, 5, 6, 7, 8, 9]])ax.plot(pm25[0:59],data[0:59,10],'.',c='k',alpha=0.5,label='Winter')ax.plot(pm25[334:365],data[334:365,10],'.',c='k',alpha=0.5)ax.plot(pm25[59:151],data[59:151,10],'.',c='b',alpha=0.5,label='Spring')ax.plot(pm25[151:243],data[151:243,10],'.',c='g',alpha=0.5,label='Summer')ax.plot(pm25[243:334],data[243:334,10],'.',c='r',alpha=0.5,label='Autumn')winter = np.concatenate((arrs[0:59],arrs[334:365]),axis=0)spring = arrs[59:151]summer = arrs[151:243]autumn = arrs[243:334] 日期12345678910111213df = pd.read_csv(fname,index_col=&quot;datetime&quot;)df.index = pd.to_datetime(df.index,format=&quot;%Y-%m-%d&quot;)df.index.month # 获取月份df.index.year # 获取年份df.loc['2000-6-1':'2000-6-10'] # 切片df[df.index.month.isin([5, 6, 7, 8, 9, 10])] # 按月份切片# 时区转换df.index = pd.to_datetime(df.time,format=&quot;%Y-%m-%dT%H:%M:%S&quot;, utc=True)df.index.tz_convert('Asia/Shanghai') 某个月的开始和结束日期 123from dateutil.relativedelta import relativedeltastart = datetime.datetime.strptime(&quot;2017-%s-01&quot; %mon,&quot;%Y-%m-%d&quot;)end = start + relativedelta(months=+1) + datetime.timedelta(days=-1) 时区转换 1data.index = pd.to_datetime(data.index,format='%Y%j%H').tz_localize('UTC').tz_convert(&quot;Asia/Shanghai&quot;) 设置时间格式 1res.index = res.index.strftime('%Y-%m-%d') 常见1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859# 三维计算相关系数def pearsonr_2D(x, y): &quot;&quot;&quot;computes pearson correlation coefficient where x is a 1D and y a 2D array&quot;&quot;&quot; upper = np.sum((x - np.mean(x,axis=0)) * (y - np.mean(y, axis=0)), axis=0) lower = np.sqrt(np.sum(np.power(x - np.mean(x,axis=0), 2),axis=0) * np.sum(np.power(y - np.mean(y, axis=0), 2), axis=0)) rho = upper / lower return rhoA = np.array([[[1,3,4],[4,6,5]],[[5,7,8],[1,2,23]],[[3,9,4],[5,7,5]]])B = np.array([[[7,1,3],[14,4,2]],[[15,6,1],[6,7,91]],[[3,9,4],[5,7,5]]])c = pearsonr_2D(A,B)for i,region in enumerate(region): print(i,region)# 创建dataframe追加行数据df = pd.DataFrame(columns = [&quot;ebayno&quot;, &quot;p_sku&quot;, &quot;sale&quot;, &quot;sku&quot;]) #创建一个空的dataframe df = df.append(dframe1.loc[dframe1.p_sku == ps], ignore_index=True) #忽略索引,往dataframe中插入一行数据 df = df.append([{'site':site,'MB':mb,'NMB':nmb,'NME':nme,'r2':r2}],ignore_index=True)来自 &lt;http://blog.csdn.net/zn505119020/article/details/77324029&gt; 合并df = pd.concat([inputdf,classdf],axis=1)根据分组统计，对不同行操作gp_col = 'SITE'df_max = obs.groupby(gp_col)[species].max()df_min = obs.groupby(gp_col)[species2].min()插入列 insert（位置，列名，数据）df_max.insert(0,&quot;站点&quot;,sitename)DataFrame 切片操作，loc, ilocprint df.loc[1:3, ['total_bill', 'tip']]print df.loc[1:3, 'tip': 'total_bill'] print df.iloc[1:3, [1, 2]] print df.iloc[1:3, 1: 3]来自 &lt;https://blog.csdn.net/ly_ysys629/article/details/55224284&gt; 获取数据框列名print(df.columns) 获取数据框列df[&quot;column-name&quot;]选取行df[df[&quot;column-name&quot;]==&quot;spec-name&quot;]选取数据df.column[index]df.ix[0,1]列表转换成dataframedf = pd.DataFrame([w1_p,w2_p,w3_p,w4_p],index=['w1_pre','w2_pre','w3_pre','w4_pre'])修改dataframe的列名df.columns=['site','time','aqi','so2','no2','pm10','co','o3','pm2_5'] 查找12cname = allsite.query(&quot;Area == @city&quot;).iloc[0,4]cname = allsite.query(&quot;Area == '北京'&quot;).iloc[0,0] list 转 data frame12345keys = [&quot;price&quot;,&quot;toalAmount&quot;]values = [&quot;0.01&quot;,&quot;10000&quot;] d = dict(zip(keys,values))pd.DataFrame([dict(zip(columns,temp))],columns=columns,index=None) 等差数列1cticks = np.linspace(zmin, zmax, num=11, dtype=int) mask12345678910def regionmean(lat,lon,data,corners): llcrnrlon,urcrnrlon,llcrnrlat, urcrnrlat = corners mask = np.where((lat&lt;urcrnrlat)&amp;(lat&gt;llcrnrlat)&amp;(lon&lt;urcrnrlon)&amp;(lon&gt;llcrnrlon),1,0) if(len(data.shape)==3): mask3d = np.broadcast_arrays(mask[np.newaxis,:,:],data)[0] datamask = np.ma.masked_where(mask3d!=1, data) return np.nanmean(np.nanmean(datamask,axis=1),axis=1) else: datamask = np.ma.masked_where(mask!=1, data) return np.nanmean(datamask.flatten()) 对应元素运算123456a = np.array([[1, 2]])b = np.array([[2, 4]])r1 = a + b # [[3 6]]r2 = a - b # [[-1 -2]]r3 = a * b # [[2 8]]r4 = a / b # [[0.5 0.5]] 画图平滑1234567x = np.linspace(0,31,31); print(x)y = np.sum(data,axis=1)x_new = np.linspace(0,31,100)tck = interpolate.splrep(x,y)y_bspline = interpolate.splev(x_new,tck)ax2.plot(x,y,&quot;wo&quot;,ms=3)ax2.plot(x_new,y_bspline,'w-',linewidth=0.5)","link":"/blog/2022/10/23/numpy/"},{"title":"python安装","text":"conda安装库的规则 channel的配置 默认的conda channel是defaults，但这个channel的代码包不全。我的建议使用conda-forge channel，并设置严格优先使用conda-forge 设置镜像的时候，main和free结尾的对应defaults,所以需要将conda-forge的优先级设置为最高，比如用清华源可以如下设置 ```shell(atmos) xdxie@admin[~]$ cat ~/.condarcchannels: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/ https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/ https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/ https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/pytorch/ https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/menpo/ https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/bioconda/ https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/msys2/ conda-forge defaultsshow_channel_urls: truechannel_priority: strictalways_yes: true1234567891011121314151617181920212223242526272829303132333435 - 查看可用的版本 - **`conda search keras`** - 安装特定的版本 - conda install -c conda-forge keras=1.0.7=py27_0 - - xgboost 1.1.1 py36h831f99a_0 anaconda/cloud/conda-forge xgboost 1.1.1 py37h3340039_0 anaconda/cloud/conda-forge xgboost 1.1.1 py38h950e882_0 anaconda/cloud/conda-forge# requirements- conda install --yes --file requirements.txt```pythonwrf-pythoncartopycmapsseabornpygribnetCDF4# xgboost 版本1.1.1xgboost=1.1.1conda install --yes --file requirements.txtpip install https://github.com/j08lue/pycpt/archive/master.zip pycpt 导入cpt配色方案 GitHub - j08lue/pycpt: Python tools to load and handle cpt (GMT format) color maps for use with matplotlib, e.g. from cpt-city https://github.com/j08lue/pycpt jupyterlab 安装设置 安装miniconda conda install jupyterlab 复制一个快捷方式，修改成： C:\\Software\\conda\\python.exe C:\\Software\\conda\\cwp.py C:\\Software\\conda C:\\Software\\conda\\python.exe C:\\Software\\conda\\Scripts\\jupyter-lab-script.py “D:\\云文件\\代码\\python\\jupyter” 并且起始位置改成最后的那句 D:\\云文件\\代码\\python\\jupyter 生成配置文件 jupyter lab —generate-config 单独的浏览器窗口, 修改config文件中的 c.NotebookApp.browser = ‘C:/Program Files (x86)/Microsoft/Edge/Application/msedge.exe —app=%s’ c.NotebookApp.notebook_dir = ‘’ 安装拓展 打开jupyterlab，enable拓展 关闭jupyterlab，安装nodejs： conda install nodejs 安装拓展，如：jupyter labextension install @jupyterlab/toc 导出html 隐藏代码1jupyter nbconvert Fig1_obs.vs.pred.ipynb --no-input --to html 字体设置成Helvetica 下载Helvetica.ttf 文件 找到matplotlib文件位置 ```pythonimport matplotlibprint(matplotlib.matplotlib_fname())12345678- 把字体文件移动到 matplotlib/mpl-data/fonts/ttf- 修改 matplotlibrc文件 - ```python # 改成这样 Helvetica 在最前面 font.sans-serif : Helvetica, DejaVu Sans, Bitstream Vera Sans, Computer Modern Sans Serif, Lucida Grande, Verdana, Geneva, Lucid, Arial, Avant Garde, sans-serif 删除缓存文件 ``bash $ cd ~/.matplotlib`$ rm fontlist*123456789101112131415161718192021# 镜像设置## 临时使用pip install -i https://pypi.tuna.tsinghua.edu.cn/simple some-package注意，simple 不能少, 是 https 而不是 http## 设为默认升级 pip 到最新的版本 (&gt;=10.0.0) 后进行配置：pip install pip -Upip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple如果您到 pip 默认源的网络连接较差，临时使用本镜像站来升级 pip：pip install -i https://pypi.tuna.tsinghua.edu.cn/simple pip -U## conda添加镜像 conda config —add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/conda config —add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/conda config —add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud//pytorch/conda config —add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/conda config —set show_channel_urls yes1显示已经有的源 conda config —show channels123456789101112131415161718链接：https://www.jianshu.com/p/7e663bb0d904```shell - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main - conda-forge - https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge - esri - https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/pytorch/ - https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/menpo/ - https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/bioconda/ - https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/msys2/ - https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/ - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/ - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/ - defaults","link":"/blog/2022/10/25/pythoninstall/"},{"title":"折线图","text":"123456789101112131415161718192021222324252627282930313233343536fig, ax = plt.subplots(figsize=(3,2))args = {&quot;ms&quot;:2,&quot;lw&quot;:1.}x = np.linspace(0,30,31)ax.plot(x,s2data13,'b^--',**args)ax.plot(x,s2data17,'r^--',**args)ax.plot(x,s2data1713,'g^--',**args)ax.plot(data13,'b.-',**args)ax.plot(data17,'r.-',**args)ax.plot([],'k.-',label='OBS',**args)ax.plot([],'k^--',label='SIM',**args)mo,mp,bias,ME,MNB,MNE,MFB,MFE,NMB,NME,RMSE,R,IoA = evaluation(data13, s2data13)ax.text(0.99, 0.84, r&quot;$R=%4.2f,\\ NMB=%4.1f\\%%,\\ NME=%4.1f\\%%$&quot; % (R,NMB*100,NME*100), color='b', transform=ax.transAxes,ha='right',fontsize=6.)mo,mp,bias,ME,MNB,MNE,MFB,MFE,NMB,NME,RMSE,R,IoA = evaluation(data17, s2data17)ax.text(.99, 0.91, r&quot;$R=%4.2f,\\ NMB=%4.1f\\%%,\\ NME=%4.1f\\%%$&quot; % (R,NMB*100,NME*100), color='r', transform=ax.transAxes,ha='right',fontsize=6.)ax.text(.3, 0.84,'2013', color='b', transform=ax.transAxes,ha='right',fontsize=6.)ax.text(.3, 0.91,'2017', color='r', transform=ax.transAxes,ha='right',fontsize=6.)# ax.axhline(y=100,color='r',lw=0.5,ls='--',alpha=0.5)# ax.axhline(y=180,color='b',lw=0.5,ls='--',alpha=0.5)ax.axhline(y=150,color='k',lw=0.5,ls='--',alpha=0.5)ax.set_ylim(0,340)ax.yaxis.set_major_locator(MultipleLocator(50.))ax.yaxis.set_minor_locator(MultipleLocator(10.))ax.set_xticks(np.linspace(0,30,6))ax.set_xticks(np.linspace(0,30,31),minor=True)ax.set_xticklabels([&quot;01-01&quot;,&quot;01-07&quot;,&quot;01-13&quot;,&quot;01-19&quot;,&quot;01-25&quot;,&quot;01-31&quot;,])ax.legend(loc=2, frameon=False,ncol=1, handletextpad=0.3, labelspacing =0.3, handlelength=1.,fontsize=6)figname = f&quot;{homepath}/figures/CEC_regionmean.png&quot;plt.savefig(figname, dpi=300, bbox_inches='tight',pad_inches = 0.05, facecolor='w') 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556config = { 'xtick.major.size': 0, 'xtick.minor.size': 2, 'ytick.major.size': 2, 'ytick.minor.size': 1,}plt.rcParams.update(config)seasondict = { 'Spring':(25,75), 'Summer':(25,95), 'Autumn':(18,68), 'Winter':(8,45)}xx = np.array([1,2,3,4,5,6,7,8,9])for season,ylims in seasondict.items(): dfs = pd.read_csv(f&quot;../obsdata/MDA8trends_{season}.csv&quot;) arr2d10 = dfs[['2013','2014','2015','2016','2017','2018','2019','2020','2021']].values arr2d11 = dfs.query(&quot;region == 'NCP'&quot;)[['2013','2014','2015','2016','2017','2018','2019','2020','2021']].values arr2d12 = dfs.query(&quot;region == 'FWP'&quot;)[['2013','2014','2015','2016','2017','2018','2019','2020','2021']].values arr2d13 = dfs.query(&quot;region == 'YRD'&quot;)[['2013','2014','2015','2016','2017','2018','2019','2020','2021']].values dfs = pd.read_csv(f&quot;../obsdata/pm25trends_{season}.csv&quot;) arr2d20 = dfs[['2013','2014','2015','2016','2017','2018','2019','2020','2021']].values arr2d21 = dfs.query(&quot;region == 'NCP'&quot;)[['2013','2014','2015','2016','2017','2018','2019','2020','2021']].values arr2d22 = dfs.query(&quot;region == 'FWP'&quot;)[['2013','2014','2015','2016','2017','2018','2019','2020','2021']].values arr2d23 = dfs.query(&quot;region == 'YRD'&quot;)[['2013','2014','2015','2016','2017','2018','2019','2020','2021']].values fig, ax = plt.subplots(figsize=(3.5,2.5)) ax.plot(xx, np.nanmean(arr2d11,axis=0),'o-',ms=3,color='C0',lw=1.,zorder=2) ax.plot(xx,np.nanmean(arr2d13,axis=0),'o-',ms=3,color='C2',lw=1.,zorder=2) axw = ax.twinx() axw.plot(xx, np.nanmean(arr2d21,axis=0),'s:',ms=3,color='C0',lw=1.,zorder=2) axw.plot(xx,np.nanmean(arr2d23,axis=0),'s:',ms=3,color='C2',lw=1.,zorder=2) ax.plot([],'ko-',ms=3,label=&quot;MDA8&quot;) ax.plot([],'ks:',ms=3,label=&quot;$PM_{2.5}$&quot;) ax.plot([],'.',color='C0',label=&quot;BTH&quot;) ax.plot([],'.',color='C2',label='YRD') for i in range(8): ax.axvline(x=1.5+i,ls='--',lw=0.1,c='k') leg = ax.legend(frameon=False,ncol=2,loc=1, handletextpad =0.3, # handle和文字距离 columnspacing=0.5, labelspacing=0.1, handlelength=2., ) for h, t in zip(leg.legendHandles, leg.get_texts()): t.set_color(h.get_color()) ax.set_xlim(0.5,9.5) ax.set_ylim(ylims) ax.set_xticks(xx) ax.set_xticklabels(years,rotation=0.) ax.set_xticks(xx+0.5,minor=True) ax.set_ylabel(f&quot;{season} MDA8 ozone (ppb)&quot;) axw.set_ylabel(f&quot;{season} &quot; + &quot;$PM_{2.5}\\ (\\mu g\\ m^{-3})$&quot;) plt.savefig(f'../figures/pm25MDA8_trends_{season}',bbox_inches='tight',pad_inches = 0.05, dpi=300, facecolor='w')","link":"/blog/2022/10/25/%E6%8A%98%E7%BA%BF%E5%9B%BE/"},{"title":"","text":"12345678910111213141516171819202122232425262728293031323334- {&quot;name&quot;:&quot;综合/B站&quot;,&quot;url&quot;:&quot;https://jx.jsonplayer.com/player/?url=&quot;, &quot;showType&quot;:3},- {&quot;name&quot;:&quot;爱豆&quot;,&quot;url&quot;:&quot;https://jx.aidouer.net/?url=&quot;, &quot;showType&quot;:1},- {&quot;name&quot;:&quot;虾米&quot;,&quot;url&quot;:&quot;https://jx.xmflv.com/?url=&quot;, &quot;showType&quot;:1},- {&quot;name&quot;:&quot;yangtu&quot;,&quot;url&quot;:&quot;https://jx.yangtu.top/?url=&quot;, &quot;showType&quot;:1},- {&quot;name&quot;:&quot;纯净/B站&quot;,&quot;url&quot;:&quot;https://im1907.top/?jx=&quot;, &quot;showType&quot;:3},- {&quot;name&quot;:&quot;OK解析&quot;,&quot;url&quot;:&quot;https://okjx.cc/?url=&quot;, &quot;showType&quot;:3},- {&quot;name&quot;:&quot;诺讯&quot;,&quot;url&quot;:&quot;https://www.nxflv.com/?url=&quot;, &quot;showType&quot;:1},- {&quot;name&quot;:&quot;夜幕&quot;,&quot;url&quot;:&quot;https://www.yemu.xyz/?url=&quot;, &quot;showType&quot;:3},- {&quot;name&quot;:&quot;M3U8.TV&quot;,&quot;url&quot;:&quot;https://jx.m3u8.tv/jiexi/?url=&quot;, &quot;showType&quot;:3},- {&quot;name&quot;:&quot;人人迷&quot;,&quot;url&quot;:&quot;https://jx.blbo.cc:4433/?url=&quot;, &quot;showType&quot;:3},- {&quot;name&quot;:&quot;全民&quot;,&quot;url&quot;:&quot;https://jx.blbo.cc:4433/?url=&quot;, &quot;showType&quot;:3},- {&quot;name&quot;:&quot;七哥&quot;,&quot;url&quot;:&quot;https://jx.nnxv.cn/tv.php?url=&quot;, &quot;showType&quot;:3},- {&quot;name&quot;:&quot;冰豆&quot;,&quot;url&quot;:&quot;https://api.qianqi.net/vip/?url=&quot;, &quot;showType&quot;:3},- {&quot;name&quot;:&quot;迪奥&quot;,&quot;url&quot;:&quot;https://123.1dior.cn/?url=&quot;, &quot;showType&quot;:1},- {&quot;name&quot;:&quot;CK&quot;,&quot;url&quot;:&quot;https://www.ckplayer.vip/jiexi/?url=&quot;, &quot;showType&quot;:1},- {&quot;name&quot;:&quot;ckmov&quot;,&quot;url&quot;:&quot;https://www.ckmov.vip/api.php?url=&quot;, &quot;showType&quot;:1},- {&quot;name&quot;:&quot;playerjy/B站&quot;,&quot;url&quot;:&quot;https://jx.playerjy.com/?url=&quot;, &quot;showType&quot;:3},- {&quot;name&quot;:&quot;ccyjjd&quot;,&quot;url&quot;:&quot;https://ckmov.ccyjjd.com/ckmov/?url=&quot;, &quot;showType&quot;:1},- {&quot;name&quot;:&quot;诺诺&quot;,&quot;url&quot;:&quot;https://www.ckmov.com/?url=&quot;, &quot;showType&quot;:1},- {&quot;name&quot;:&quot;H8&quot;,&quot;url&quot;:&quot;https://www.h8jx.com/jiexi.php?url=&quot;, &quot;showType&quot;:1},- {&quot;name&quot;:&quot;BL&quot;,&quot;url&quot;:&quot;https://vip.bljiex.com/?v=&quot;, &quot;showType&quot;:1},- {&quot;name&quot;:&quot;解析la&quot;,&quot;url&quot;:&quot;https://api.jiexi.la/?url=&quot;, &quot;showType&quot;:1},- {&quot;name&quot;:&quot;MUTV&quot;,&quot;url&quot;:&quot;https://jiexi.janan.net/jiexi/?url=&quot;, &quot;showType&quot;:1},- {&quot;name&quot;:&quot;MAO&quot;,&quot;url&quot;:&quot;https://www.mtosz.com/m3u8.php?url=&quot;, &quot;showType&quot;:1},- {&quot;name&quot;:&quot;盘古&quot;,&quot;url&quot;:&quot;https://www.pangujiexi.cc/jiexi.php?url=&quot;, &quot;showType&quot;:1},- {&quot;name&quot;:&quot;0523&quot;,&quot;url&quot;:&quot;https://go.yh0523.cn/y.cy?url=&quot;, &quot;showType&quot;:1},- {&quot;name&quot;:&quot;17云&quot;,&quot;url&quot;:&quot;https://www.1717yun.com/jx/ty.php?url=&quot;, &quot;showType&quot;:1},- {&quot;name&quot;:&quot;4K&quot;,&quot;url&quot;:&quot;https://jx.4kdv.com/?url=&quot;, &quot;showType&quot;:1},- {&quot;name&quot;:&quot;8090&quot;,&quot;url&quot;:&quot;https://www.8090g.cn/?url=&quot;, &quot;showType&quot;:1},- {&quot;name&quot;:&quot;180&quot;,&quot;url&quot;:&quot;https://jx.000180.top/jx/?url=&quot;, &quot;showType&quot;:1},- {&quot;name&quot;:&quot;无名&quot;,&quot;url&quot;:&quot;https://www.administratorw.com/video.php?url=&quot;, &quot;showType&quot;:1}+","link":"/blog/2023/06/12/%E6%8E%A5%E5%8F%A3/"},{"title":"提取污染观测数据","text":"观测数据匹配到模式网格上 site_to_grid.py 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475#!/home/xdxie/packages/miniconda/envs/atmos/bin/python# -*- coding: utf-8 -*- #****************************************************************##&gt; average site data to model grid#&gt; can be used to compare the spatial distribution of simulation#&gt; author: xiaodong xie @ 2023-4#****************************************************************#from math import radians,sin,cos,asin,sqrtimport xarray as xrimport pandas as pdimport numpy as np#****************************************************************************************************## user configyear = 2016stime = &quot;2016-12-11 00:00:00&quot;etime = &quot;2016-12-19 23:00:00&quot;GeoFile = &quot;/r008/xdxie/data/wrfchemdata/beijing201612/presource/domain/geo_em.d02.nc&quot;OutFile = &quot;/r008/xdxie/data/wrfchemdata/beijing201612/observation/obs.d02.timemean_20161211-1219.csv&quot;inpdatadir = '/r008/xdxie/data/obs/airquality'#****************************************************************************************************#f = xr.open_dataset(GeoFile)lat2d = f['XLAT_M'].sel(Time=0)lon2d = f['XLONG_M'].sel(Time=0)allsite = pd.read_csv(f&quot;{inpdatadir}/obssiteinfo.csv&quot;,encoding='gbk')def haversine_dis(lon1, lat1, lon2, lat2): #将十进制转为弧度 lon1, lat1, lon2, lat2 = map(radians, [lon1, lat1, lon2, lat2]) #haversine公式 d_lon = lon2 - lon1 d_lat = lat2 - lat1 aa = sin(d_lat/2)**2 + cos(lat1)*cos(lat2)*sin(d_lon/2)**2 c = 2 * asin(sqrt(aa)) r = 6371 # 地球半径，千米 return c*r*1000def findij(latlon): a = abs(lat2d-latlon['lat'])+abs(lon2d-latlon['lon']) i,j = np.unravel_index(a.argmin(),a.shape) if (haversine_dis(lon2d[i,j], lat2d[i,j], latlon['lon'], latlon['lat']) &gt; f.DX): return np.nan else: return [i,j]def read_station_hourly_data(StationCode, year, stime, etime): temp = allsite.query(&quot;StationCode == @StationCode&quot;) ProvinceCode = temp.ProvinceCode.values[0] CityCode = temp.CityCode.values[0] df = pd.read_csv(f&quot;{inpdatadir}/QC+PPB/hour/{year}/{ProvinceCode}_{CityCode}_{StationCode}_{year}.csv&quot;, index_col=&quot;datetime&quot;) df.index = pd.to_datetime(df.index,format=&quot;%Y-%m-%d %H:%M:%S&quot;) return df.loc[stime:etime]latlons = allsite.loc[:,['lat','lon']]a = latlons.apply(findij,axis=1)a.name = &quot;ij&quot;subsite = pd.concat([allsite, a], axis=1).dropna(subset=['ij'])dfs = pd.DataFrame(columns=[&quot;station&quot;,'ix','jx','pm25', 'pm10', 'o3', 'co', 'so2', 'no2'])for StationCode,ij in zip(subsite.StationCode,subsite.ij): temp = read_station_hourly_data(StationCode, year, stime, etime).mean() dfs = pd.concat([dfs,pd.DataFrame.from_records([{&quot;station&quot;:f&quot;{ij[0]}_{ij[1]}&quot;, 'ix':ij[0], 'jx':ij[1], 'pm25':temp.pm25, 'pm10':temp.pm10, 'o3':temp.o3, 'co':temp.co, 'so2':temp.so2, 'no2':temp.no2 }])])dfs.groupby(&quot;station&quot;).mean().to_csv(OutFile)","link":"/blog/2022/10/25/%E6%8F%90%E5%8F%96%E6%B1%A1%E6%9F%93%E8%A7%82%E6%B5%8B%E6%95%B0%E6%8D%AE/"},{"title":"数据分析","text":"检验数据是否正态分布 Q-Q图，如果是正态分布，则图像呈一条直线，否则不是正态分布 1234import statsmodels.api as smimport pylabsm.qqplot(data, line='s')pylab.show()","link":"/blog/2022/10/25/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%8F%8A%E7%BB%9F%E8%AE%A1%E6%96%B9%E6%B3%95/"},{"title":"服务器管理","text":"802969d6898448ca67b0aa2c4e65fb3b067e7db9325462d4191ff87447a3f1a0b0d8db50d62ddae96169925461962c552592ad9f374a61b83ae6a891f36007b87c9d1c7e1aaf9b4b22953eb3a92c6b300fc32b5d84b071ce0361f65d19e12f8b65980d2fb0f717ba50f0ea78e25b898f2747f0a8eea3b33e2a3ec954516458859aa86d4ef63be103b29aed2512705de465c728c2b633280952c24f858e351cfc5e3792eb2e123804fc6f6b019d28d233d91b922d1bb6cde41112ba87835d6978c37eef18ae540ddf25a07463de99bd46a32114c8c053f9d06d2b903b33bc1ea7d9afe2414347179d73bce3baf1f2f8edc10055497ff4dbd03411508df877025d69a8891cb032ecf1bfea824344e98b694a6641eb917e5fe7bbfcd6ad954e6ddb803113a32ddc67e6562ba94258b4e92568bc37b9b9bcd5da23eb4fd5955e3c1ef4b6be29fdb92450233021253458080443d92a14fac0879eb698b08b55d9e772dd2e1104c8d1ad19a7473933be1986a14959afa133d291026081f47c27b27e8df08d095802a8e6d47dae1e4cda970dfbf3e05fe86690cf65479e451b9bcb34c3a92a12304d177deac0d216446880f3743df4acde676c7a44703a3464e5d4bf8325150c45b4e44337374e04e84f56011a4c1b384ef1cf2f22276a4a63bbb966757f84b2ad776c9515ccedc4fe0d6f7df27463cc1fb78fadb1f0ac239a63583e555f3d161652182d5237e6da40ec295d635e28dba0e4156491c5e0a413b5efdecc8f19f62e8a4c5bcb6dd04ef8dcf70f20cbee72cdd07d8e860af9fdeba2044c2ae3c0d6aac6651ed60e2b560172a3fa62cc12ee9b0ceaad0fe9352ad68b772f4de5489b85017e213d30446e5a62a3b28b19b9c36c89c6c5948acddbdaafc0ee80d291c2012ac0c72ff70d03e99737394ee89c5a3e264c9d383b023c8b8efed77796e5344e3f6f13461a51de4a86e5ad17f50c424a8bf86ed481be05da4e77c3beb50c1ba0e457042de7dc00f449c3e54755c37fe9ba702647168e627e5705333b854308504b94482601b94e33b13a32d9595cd5be7c8b11a13763c00929a1565d9d126c9e65b0a51eaf14912d73326c7dc13fff82bdf9e9c8029f485e73ccd6953ea14e2ea785f84b6b11d52fa2d9e8ad19324dc85a0a3fa5c6fd35b58a6fc9dfbf72adde2be061278473c6fbf0161320d214b96fb7103b30bfe120b4bf3f123a7ab13257bddaabcd2b6ab66c0ec5f6e2d3eeadfa709ffb02b167e6e69d124704ba6212b904e5e664ce84fee166087e330a3d26bfe5d84c8992f078d35ff2c457316fc970ee351725bf46291f4b902854b26d64f79cbda74fdbc39556fb00f857c8fd2b4a1951f64476827f9e6e5fc4efbbb65f66c677d92fb3a043a5ad141803d9f421a7f25437fc030adc37c1052fcabacaa2ed74c6255663234be1a45c58c2dd4efa0aa73455627724dcd9f88efb25589085459a243f28a419ca4f0b3a58874064bd065464a88b67474b7a41f2b195cdbed17af5268d4d7d917b905ae9f2aa74d920a5ad7375a893516f79e73cf48f507109a37f3316fe95a6fc2c89a27cdf4edf93c04c8e8ee5dbb3d91769125039aecedda8280798a2cdd6dd66fdfe4719959bf473890fa660f602940638ad5b1c11165660c25c42579e38bad8ef4f346b72f8d1dbb06c843a260fe6914d14f879c23f7ccdeee571b3a34d8cea64cbaccb8bdb10bd3e21f47c6653f2042e4eac3a57509de5e1735b49d726abc3afbd515da9ee995e9a129076379899b5e912c7d1823b789748dc296c9a674f539e446cbc6cf88b4ac06ed9249a97a2e002510497af36929ca49276919ad7b9ba8f60b1c69a5a088a445d4b9a0c3adea2500a2c2bb334635672b15de09a26f01a5906a2abd37978916158a71e89133f5022186a7997d2328b1ec26b3872d2b0a210ed88d68da94393bc9ef4a3bf2c1a74adb4c97af300a556e8f40c464f494941e2e540a67f30420a402be63410a4b55fc23f7b68b8f463ca06f363751a4cae14552d7ad12c0c7f14543244a9fc584283d450fbea0d9186cc3e7841d326845a07498e5a200fd0dd4f3a5f2b8ba036fd247c59da707b9cd13c506c14f762f32aacdff486bc82224a7e2fc76fe1f722cefc023e27f5ec62d92cd05451b5285ebf3277016e1fa258d1003a869ee9e93e8b25e8a6e56da6344f48a8298a90113bb1c61321f7e4872b08b25b09a727505c685d19592c89d7d576589e488375b74908b1d1c94581cdb1083f1f8bf08498368ae24342ca8725ae0f760770898a51716ebc6ea5bc0020f3507e73e43135a5bb2b234fb5712ddd14fb217f87c6bbf87748d9f6978761e6c401e0799a7c2033aaea64442d2528aaba13e823b906bbecf5f0f7f4a52bfd96c58aa34afdb3371cc137b8279da145e89e9e2c6340c226de72246a0492790bed11955c74e748cc05d71c7fdd1e6764973f5212093a5a7e94cc58781382e19a60c6d710fcb2024acbe425f3d07b8dcf607d2f6f483a003e83e738c30119ed1a480f34de71209b1cb8e76f22337079ceb8e409b39ebc2ce3ab5ed4fe58831c8c7a6cffd0fabd82a225234c74b0e3ba0081046f8fca3acbfa410a98f75b98ca32d3e5cc7014b4888749ee7dc6f9900d39f2cfdfcc13ecc95a6d8aa050dc5976510ebea986e4c9fbf10149277645368c45fa0e84549f2395b8f428a597d8c5f5c2fa60d0c144531d6a2f860ff67acff68fd8a44c103e949ace0bb23195327e25dbb6dae7e007eec0d79b90d5ffa934896c14c9565f181c06481d91caf2fb00b990b3752008eb16df6433b6e69eb80ef84239804c29c66e39729af7ffd2b73d2b4060ee29254eb9c7079064fbc7306a9e21dbb51d783c538d4511f91b719e6373bda6488a4cf6626aa113f47932856b100c319cb2daa5a5b265deb73f23eadf4a7083269da6f913a966d7167d4f16f2fe8bed489e229df72c1857ca2e4a62c98ea3437b019257a6b8d18407fb345b5046dd674e7a90453866aa03aab095da5ed3dfc92f203483a8e994cefd5bfb92a46432fdda5142a30b98b7bef5eaef1e3ec862f8feebbc5f7e495b0f2d3a0f3092766cc904d801712674934ca392f92a3ea4ab140806304ade4fd2715feb724510376b81c582af53b717b075c7b36b28213c120ee2fce4c1c81e45359d1741ae48f75c66ff55ca7bb86ff770fac97c8662319d053a061e706967b5a85a66fa6988da5ef2e8213514aff879001e86fa989d0da14b861f5864e0bf6636ee77bf30fdd639700a657c9d16ba7b04895a8cece00ee66b7964262dd272ffddac479539f606dd2c8cb592cc93ec7c1a23581843c428cd8f74bfed15ab770235f2b96545a09e962701963305d1066fb3863d189985fbff0b9049dd66570c02b347ef1b35d942382f28e33e9fac011efd4dcd8a14c1db5b601b8317ee7550c79d9e927c3fbddbb0e6bf676a8b0dc082553142d9c41a5bac0540c5f04088f8120be832c52219a7ba5b365e5940a67589aa37bc12339650bf29835f0fb55d97f465eae96999cd81b7ba5f276bf32595e1ec60333768735295c6b90cb68ecfc629c26df1fdd2be5d95ec64c8131c0f2fde635b161f96b65e081c6d28fe63b2893f236318999d2c7fa0d7792b6727dd7b39b60722edfa6ad2540929c499192314622648c801a8584fd4f69f82382026f9314abee4a465632b40286ab9801cab3ace9633daa79153e4114a3ffd0be6654db021b07821e06246fd643d17da5288fa584daeb410a7f4e76b6a019c072044ae2273604fa72a38fc9f6defae87d1c6efbb3ecc37dcba17c428773cf3bb29861e37fd25c3c3fff7ac71d37c50f7fda77a73223c028dd6f689ebef405ff3587723ef45546f374890344b9cd10e713c9891e22b321d0eb6cf1c962f1f6d81b43bf537fe50a13b3be9de0e853b55f93cc3ced7d23fa388edaabbf938304178919cc77cc98f84e85528feb485c8b24ef1f16aeaea208106db600f9304b66df1c6e0335ab5d816c41609329c2d6d655c469f66f2eccabf84e3b9521b635f1730f83893d4c3f12d7f448dda4f465e3467cf27e70e67dcff1e4fcf1eabf9857b5dd8b926762f1dbd4b7318c2084b10aad8a6cb4cf14240b8289b7ca36876321e377b899aca64a2283a03a9182ccc3b7afc596365b281f2a7e160ebad7804093ddeec5668781e23d78a56c5d829a23ebf952b2c162032df6cc26e5a52ed8b87d782152c8569ffa5d404fb1604e59334f08bbd7119c8d0b892c7420b301abd0fe3fe1514b14a8403bbdd89cdf321bac444fd7a3dc6b372ad7c309d128e682d88a386543f654019e39080f2482fcc3c201d7b89b9c0df8d001f6ef0b96301cd0ec1981529046e43b756c8789ada31168c790ae25c0e182a6ab1b6a9346bc8dc606384a8636dc9d0bb306c1ad1dd3b87b765805dc6c26d7c64851471a89a4e2cdf7cbceb9336328d34b048b69150461501541fc76cb2acc0555d23c37a58616211f7522b54752f3253b64485e8a48c2ec3ed206579f3d7c45831658879b5a268731e47d40ef931bee5e808e7e27e82d9d5e9ddf76fca9e16a04797e8590747db392ceba70509ce1829327b51156969ce5ab89b426639cac0d47ca10141dcc96842415bfca38d13782250659107050223d38ec20bea14f32112a0fa16a4f1a16e54c6561be23e8560d8e48f9928b0c4d38746b0528fe2126d89353fb0ddf9f18ed6c0ee5bf10597aaf5f71122069b9b695210ac28304ae5e8ef4fbfc67b1a99996dd9341288316652404c6edac4e092880f37b3e2570d7d39de5f86ff951fb33c650d325bd00be96fb90686effe01c878750f5bfc3072b2cb9a999a225bae7f581891703650b7a4565e8613a59b87a02e94f083fe6fb00a27bfc611b5752df33f9174a4d0a406702a93c15f8311aed12e22f7057a303477a0934e5eeb1a0db5c20eda59efe371a93ee2de53680d1f85b5370241e4ff965ef51de6d910da8513138c1963ee2fd20634b508b0c7127ca0cbbe3725af2608574366d19f674a2cd09f3c0b7beb10457bffa6dffd7a0d0ac3c7b99174681e639dbe624967ab30139e544bdcca11dd0e991e1eed71c475a5b821ad12f06fce87e1481ef7a641b26216a285571b12df38d3d55a4cd67e5073cb4949f44eb31be3149dbbfb557f049dc964384942df43960f968a495d4ae335f33aed1ec016755bfa31297fb823df326614362e81d338860e07ae9bab4d46ce7957c655a511d5e217438f68058bcb76540625d992820783c4585414cecd0a00b884cd9ce1ec22dd798f7692cca698e27f6b96bec57b2ee1a940c38290ec647deb7c9fa2f80183cab6a8a4f2d7144499660cf836d12ed1b94f94b7c6fe7096aeb83490e5f440feefb95a358b5e9099faae481f4e3886722031a4e5ab299524deccd23f079f68ff11a3f7bb4dc682ae89107633cac165cc71b24e5bfeec2510ad0e58502f5d6debcfea198169a324d5b24820df42294af9198a9721803078cce11a3d08970fe4dbb7b2ca777a8654eff207d7d8e191ea081f54a3350c9f4094ee12426787e5de3825115dd59feb2533037390a8e53ac7a76b22005d22e22f68234d23c2b4d0a74c303d3ed1f6caf5227889d9c26bb1264fdc5971e036052fcd17d4da2b61051bc2a8c7cdd8702a2a6755dc06f384b0d9e6e5f3aa00a4ec089c6149b2a672da2d8da71e84490e0d2cb4a5c9a116855821bb999097d4581712fce4e4721101a33ad49b47f63c3eb4b7f95664d5afe3e7682cae9187589ea2c4b98ab983e3d757a6c5a4e598322d7c3c03785740f5994bccf4027c21a850137ac29f88114a61e3c58bcaf842d7b008c29f246538e49696e398c8227f2836a6b0ec419a06e247af9797b7c9bfecf91af3a1a1ed49ee2327814ee9b31ae39a3abe1e98ae54d2e23662b6899cd64f8ca9b3a3b5b7e85bfc7a351ddcc37a0c278035c0294218856aab9e7fe1a19ecf3d02b641b025e3bd04aa31ee6f7b5870f8e0a6a90b0314489228bdf6c7698242afff1d6d6ac1fad70d21ecac7b8c9207c03fac1215424b1b6b88d51f37e848b6017fc3cf32e27c299ab0fb296b585d722226876233401a467c38e5cea9343577493c16414f1574ba5814f5887f8163251fd156119ea8efa5519ee5c0171b3d9d54f8a06b1b206959f9ee13121839d8489f9a32d4e427df90dd60f0a907d0f75efa5097531717a1b3ad64509f494ff4dad5f483a527670833f4b119d5f256c4df0c4f94bdf0e5278ce7a54083e580e39f286eaa59d00462e01e91194c8d37ffa695758e258111c043fd38ffd24adeab25e9c7e77a2a680d8d44e77779be76fe87498f52a73ccecc2a842423f9d6a5141a063cf12e64e772352e05bd71e350fb6badcec99d0b4d8432e3406b545bdd32c618c871612255451b770b786082a715f3ae5d767d5ad9fc72542bac1f01aea6650610ee931e024e6842c4204cfc7f60f89c28ff4d7a68286d48e1e758dcbe7b41d43e84b6b138d42b92324994de3f4f1b31a11a0e29d6c164a060d64d8e3bc459c244936556177bfcf0db0f7569f7beafe20e0e20a7189cc9e97222ab81f2f5a353a802a51298880b796f66d32ea536267e7a8aa7e6f248047f5520ce279d56658f584646af7a36037b8ab466d4e1b75d7e0a898cb94713c438f452193866ef92410c215fec2d7f2a89ff9546ef2b5d2476860c978bc9bad94e1e1f2b0e49380f76249d8e5c07a38453850fc4da5a2a3034a238732953f7fdd2ab60ce04606d535cdc3132f1bb0a1231c57250e9d1337c4e5fdbd1743db378cf05b7a4c12e5bf2ac55d6359e216bdf4c5d194aa91d1eba4a3b1e35915d752e3695c2f816083e5c0c555d5af30d17d42a6d0c01dec86bf6f83a8366c804f97b2bfc4767cec3aff8761a10fb1e5e7f8fef9a02e86c03d02dfb6203962e8a849e050bf17504963ef677426575ded27adbfb787fb97e7eadc63626de3c7c46316bee90b93bd3bcc5dd41ae01b87b73e88d80505f983cfa2624a16c23d17726a806a36ae0ab2787bebbfb03f14ac559f13a5d0b3583326c25ef15f093ad34cf4f6b37d7026d4f21c2266a0619c9ea78c64e8ff0dd447a9cef261ef708e34df1fa6ccea79975c2fb88d6c56a4a620b69c5fd46cbd403b01a5838822e8e5c1f5b9f5bd4a721f5cab0da100e7190034e4b7b8da5020bbb0efcc6ac0462d8a1d769b6629c14e8e6e742e309e950169889ec356bb5f66c56e43174a8dcea9b2f8adc74c402e6258350017a03d092a6698051720e3f3784254f5a75987cf8c4d4bfe81cd72ac15dd42ceef0fa413acc9e51fd4290ffeaca1c07d36a80cd9d268a48265dd485d208172a345a34ece2e159f8e141205e630fc3753a3a4b60d354a30ab879f4b2a7f3beda7a349892082ef82357d7a775d9bfa5cd7e69f34188dd284a5525dab5a9f8125a24cc303c27638985cf43c7363e8268fe5813f20f3c4fc7ca07192d26885222907b0f0661c504db9d67e7f873a2678fb3eebf35a750e8fdc9b459ef796aaff2034dded34c5f210286ea17ddba9423e804669ff54f575a04a7ff6c2026daa0e639c7c6b1c54fe3c4b1049ae1cb77cedebec365ca1e626b63b3d9f534fbb14e9ba8117179a9d970af37c9a97f2075ad6fedb39bc4828d6879ea4b5ec90947e8ff24dd7b363da90a80d011dc6f2b4def3b10a5cc1f7703b61f8485afd656f7912a78bf2ecd336aadc14cf04fed7682b220dbdf683a3c4d2d45536ab4e6c6b8b54a91efab39a7360338c16c04deda93ddc7cba599a1a54ffba9130630ffdf37d30d5d17eb00f67cdc7e2ced81abc428245b4b963662272ed15b59137697a730043514f21ef0404a311fef87422e872f6097df6b80713d2bb3c7235f9820f05fc1a952eb54eaf2e1726f20a5b03f58330054a3b1542c3d65858c5228240a4cad88945eb392fd90fd43c11d08eae5b83e72d43edfdd079bfe27cee4caf39c73a28ff5f0d82e6ad1b4ca5523028fbf740c592ed33ce2d9f573bab7d2bc16296dc9d0d49ef8d587421bf733d2d876538ee2e644128d51d47a2316aa33d26dc6609a6d4054ed0c1c06cadde515ad1df8a66a7f657f8d0e95babe3785ce1ee32d2113bb54cd483d3a9ec52d68799745d02cfac9ecce68040339fb7ed41a5a189e2e622a87189429632c51332e5eaa751ca34fac6b151c82e0cac1eea9f8dda8aa8cf76deca46b1ef178aa8ac712b3cbed8922127310347b97b4967a1b9b75b58bc51c6ab79535584fd5dfd404c9b10bd839f3eccd551f8c3670dc07170f5de8762a74d592650c5995aabf6b236eeb7477c32d2789447aac7e425b1fc16625a859ea230c8a677b67b330a63d2fd8b98c276b1676adcd5084db9b3032e4a26b958e236892a2e965a3f5e46762989270a157999e77eb340b1b62cda8a192b72cdbbc7f470d403d13fb5718eb0c6555d5f7ea0951fd08bce0198c464f8196925ab9acda806a6a43ebb7039e2df4940a85c6948d32b21d48e229aa42e4499ef37f465085d2452c43f247ce5ab5e68379191f6bce8257c82124b67206fc355a359e201898c72041bcaf81992e79e1263b619c5f389b0239777e812915d39ec424746d3c1219120ac4e8ffe80be7d3e6d69b223ab86818286ec41051119405cba19896501420f053e9634ae5f9024cc39acc157d45738bfce364dfa4dfc5a3ece35f7cce94e5dcd439abe57f47152b76c2e5b49364774a51aeed5e8bc95b211167d6584240e8c4b24501419b957a3bf3079b04d43b257610968524d1db15b346d144683de3e5fbfcccb6b6278f5d5bd045bc3c68fafa77e7c86320995c07bf635b86cdddcb5b47fd5169528c97d21c2f47aa14c66484000e7ac31ed4b2c4d5e65c7ec0c4cf8fc0b4dbbd529a06d13859c0d366cffbf3f8a5a47b3b324b0fd564c13f8a7ea5f935fec55d9da17cc2cd42ed47b3ed30cb3b7b0fe56762062f8d9c186334c412b78163934a23153acd6302f941426140ce600b76a5d26f1fe4f70394b2c28e683cdd1981f0768b0527fd0207cd3aaef3a7d0ec8c888f027e098ff93a94b044aea734c8a59c4a81886b599cee1873cb2e5316c9d3e39987707c6785e43fd0159d67503e23162b4d0b581860bb6ad2ed8259683d35ea5353111dd015761026c800bbe4616952cbfb49d6c0118e81887d60aab962192558015a5c92d0392de1b65face842558d78eac5bfe1b02d896c250c532258a445f6c7343520528d4d5eff23b47474edc52aaff4cfb904534e59661c2ab78d1cb42bf58eadf82e0944344db2b28b6acc7b6cf5965fec776a3352a899c0d6ac84fae7f4ec2b5e31122fd71ed0649e5faf8762ed5ae3626adb060269f7f17c997a62818369164db029b9bf38b921d54037e1d71182e0de91ffa54e62288c80b263d1c9aef39fa78a6d2695be164aaebdf2f20bc70bbd506e9679435ec96b92a7142e6731230cf47639b0b54b86d3297cf9ddb6c50fb5ce7735a6ddd71a368cb2d5b903b58d93828c8ee303b40eece0089fdca2b4d0cf6dba09a44b324f8fedc48f1fcb10835f807dec23c0ae388cb42c36013beb7d7fcbea2dffb2249474744c121b94e89863dbe6a899c75465215d9e2d733e1d59eeed226b36fdbf2b092c47b0ff91fd614b3d92a81becd7958f340b62e2670ee36e87c2cb05d2187e3a2b93757c8aa51918d832fc36278c9dc368316769ababdbcfcc109e6a01b075d07dab8df069a4b76ffa9372bab640b3a39dfbf5d3d44e5a49ad0621962add5404e5c8cf65a4dbc9189ce5b9ce3fbd742f7bee446cc28da137da5743f20c80015500963126af8ddb7bc5677c4ec7471d7c7e9ee725e5bf9fd080faef5bd8e23b9e062e8a2edb62c018d601e7e8261e5aebb6e5cb9032da5c5e658205e7eee72ec9158df67101ba1872794da40f7c7895e8802ece637c12a39b28a416b0913185c9b4679ab1d4e63c9ca7184c723fadfb105a0f8cc0476ed2c3adbea657f498a8cd9371f181ebd1a70afb3ae0bd111060c7afbac2d01cf53d28f85aeb28ff5e0d8e6ba757e075d6ad6c087997828f2cb2ac220ac02bcc31f3fe2535cbaa771d55a4799d564944d0701f76cfafda4a3afdf81cf2cade08f54357359afb17972e5fb5cf3f6ce0b53a0262506f070934a56bf52be309810f2bff5020bdb6bfde8e2f6b8762fa285305cfdba991308ae6d7f70f1c91712f95d906c43ef2655f4381b43de598526a1ecce5ded8aa3fda77288ec97ff396af1aaccd482711e0939cc1fe35f103a2683f8f5fa7e812abe9279e99e8d28554eec9aad27780009886a3ccb218221f519911f84dad89b1bf33a2f3c9e566e88141b2cd0dbf94f2152d7e998d6c7e782350371f28e99bbbbe01373912b1a74dff4139c5bfdb4254a959481ebd70f5472b5bad1b589c0537c41454977d6c1c39066db0ec1b9c8194721278645a40d7f5d594de3a21cb5b370071201e885bb4715d90b476a8f98752a576c0184ec331857fc8e9205a356dc9f5675d4575e6fa1dfbf73dec15d01fad6db2c5e1c7a557a5124a59719ea2c275646bd3734604e4ec8cf67b923a4a6439df109b79c4c3a2a806ed1df5d0d37d0cfb51b329d0ac4b0597feb5debdd5b7b18b1ddb1e6b353c5ea1b7cfb32fa7edaa91eba0cf9a626000257fb936fd1e8563cccee83e19dec0de0b019c33bb59a730f565f1632f1596a723563bf36cc9600313669d62a73a9b45868d33bad4f6341fec919d2eae93560dd02e0a5c6670fcefebb82cb0a3ee57f566e429f92314a77cd7e45facfe4aaba85f6faba37521299d365d19ac4034dbbdbbba1fc50201991387ee62ff81b4bb2ff7563491b8d4ee395d39db3aa265461ef94fc66f74c51bb3ddc0d5e211d4e05dce00a390e3402dcb76e8030379e611bc984d19601fc5fe1b29742548d9cb8628f53a1dc59ecdb9f9273ac1deffb11807a0789b2423ca836c766fc25ad0ceac9c75d59774003a4e1b2e3720d7b73d02303165dba6676412e3e876e6407b11a3e85aad3df3c94761a13a11001c80244c07cf9f6c7ec06b036db7b059e41a103ec4f0a7cdf7159c69e81c74a4e14127cf176c49a5acc8412bb1fd245a8d111f79404490b7ec6be5a824e2c27bf56d72529b7480dacbe6a88e2a7ede8c7bd0ff64b8f344dfe6b3c052e565d4b5c681b3f0da2383803606990f2cbab010dde85f666f026b8f7296d06daf515ec6d344feaaa0f466b13898fe48aa7cc3681ba0360e041e8498a88476d9d627cb036b18538c89d27cafd209d450021609c28ca628077010eadca5d643ee6afc7e004222974a6c967ed185d19169924c343a95187e33c7f680fb6aa84f79bf422ccfbe0d94723891b0f7b2822cac61e7eb5464ca57817da2e0023caa1c6f2e449cefb9c9c14559cd40548b9fa5c712ac506eeb76f4749e7ce11fc619689133ec39534c42d811fa92f5deb1a815fd3a7c86ca55c39b35747d24b9f0878bdace5e7c54053fc9e78b0d59882a3004db3ec4615f3732f27dcd95d7882b88f0a822fd0bc826cf2f5ee130ad43b00a36b545195d4298f0677da70043e88aee925f37355e082cf72d4e63ee012e6e136c267cb3ee8f37c04f213e6f64d34c072910c99152aaea84587b933faabd073a7b88e05b4c04f919f95eb6c753df2c17830e03c573bd6ef421cf089168de0ec7487a19be79a8eba8c33fb780039a4960ea6ba3f8d4ea7bdee806154f62aaeb4e095a6828d1b848ef815521f5c10cb4f289928e61392c97999ae1dca6dd152dedfea79ce3667a244d994fe5c1a92d620f97d2e5f606a1b4f02235e5f7f1ae3ddaefa71d64191106157d7ea0e1418ba353019e4349207b4985464be64fad8d8dbe0dd87eb9ea19a2b726cdda38eb5dcd6d08cb6232930f5c8c004c8d601608536db6dabf86db2774718c7d03d322374844971d6871ea810b38a6d9d965a0ecac4340a8382f923f19c47575ce4024c8ee742b6cee476e5d4ad6b57a516f63406c636231d15f9739147cf5e641e9969e474ae30343c02a3bdd87b629cf142e4ad0c3677fc52dd5b8db1b7f34cbe5dcc8ae8ae5cfd67c823856a48039d2f1ef75dffaec2a81b9caa28d8e1955391900d6bf4b10e9ece0f564401bacaf7a8a9197ad42d190040d1b96881f345233bf665b5115914475e284b6f84e44525af085d20466387693913a0f6767f697e556b627ff06b3b9b3a8c0548084baddc1c083d869bcb8fcdc38b8d3b9f71f80f9cdd531c0a21b19c8ad974a94189f153c85126c7c2c2105cec2f45a22c827d285821019cb70313a62ef40932790ed9d1a5d6841b74c4e033cad02678f9cb45da1dd95f0357f7231a92197bd4dacd2fff309541c9fc9ed0c5ded70ecf2a119f102fa3b2ecea6d293806c3257c322cf45503d7128add84a316b0f0ed675f38afce40536644f7878bf2436f12056d5f29e61aa174ed1800772624d258c06f6667b575166aecb892d8929f6ecd9bde9ce9461733f1ad67d2a1b765732285a3cbc5c73402816152007b9c00115edd48425691c7e35306df33894be919eb80be678961d261e361d4bc4da3a18e7f281678124045c578d8849a85abf9939d3b2a7bb356878cedc9d99278d5e1ba6da43f36bdc7f9164533f14e2b58d8a0643e2f8be779d7ac628b1b64fd23a50898ad0ce09171c8d9c6eb8f354e14947bdc2eaf98e53e0977a5483036747f8e2e0714336be04bfe4b5e02a1fa667d8a368a404b0ef80de528328a3464709466e9b4761fe8f3ff40a16c481667aded900d67a72b8096a807ea31c34f01608b8854d387c6ffcfec453aef59761b9066413bcadf6f70285b8feaf40de324edb3444434b966ce35f12e642a5787eeb792d9b2019800bd08305fc7d5e489df455a37623c087a9d09c741f1a102830c5f1ca6c269872ff491d04ad657df546719893b1f8c7b77e6674d26dbd945db09d4340f0163147cddd7148c7e4e7e6c9345bfd20e74452d023c1cb3c24cd7e399ffd5495215318edcee382581e30e521cc0e3b425671a978d2dafad6b5dd69cb37a876826a0ae6163c1b2973ecec6b6f79db524163621cabcd43e21eb8efa6d74e7e55973766e7581239564b413c983670b371d99cd593de02e618332bef2d219714a9a4f66b8c6b4d28f35caa7adee190ccbd55013777c3b50dd0e1896f6071257f3d42851aa75b0732570810fe71177b639954dcf855528768ec0baaba5b1449a1054eabb11f09504d25546e35b55c8914a39086f667734079916b1c3669ca71f8fbca4d376c87783184987255601f475c0644015ce9e3358cec4afb06a1eceae517b94740605dc34f9890194ae9b2e08138b2ccf7d725108a643a1c811ed4f32b50d4e3d437ad8211dd70b133832177a5573b08e8a8d2518126e3ec58aa38cff672bac4babfef44f812e50fa188b0d41deb5750e3e90729dd4f99c876e573f8423b4a4ec2a01e37b1746a201cd6e7dd3cb696cedce86f4fa1d2fe1e59272ff3d76a57b0ffb307cfff1e262620f1a3f450a104ff39f1163befa40c5f580e53777e87efc0c6df6cf30f7e609b8569e885dd6186ae84fdccaf89c011e8646438dd39b80d5f22010136de11c952c6516b72a54a75b8fdcd8301aa79076e1c14dff4bdaad92f5bd63073cb8a7fe68bf8e2636e0c0d7b628c85c40297ddc1652112e625e9426e599f00d829427d7d7bd93586d9fc62d86eb14a33f08050866424ff32aa3d159e7e5fe029c6004447adb25e01ed066e5e3cfb0534e95aacf6daee804471d9707a91460dfc1b8274960c4d7d8cfb9ef407dc5ce562cfa1c4053b9b0e1024b7ee88d413edfcb1807c824cd6ecd97a8c6946ff67cb5c6247fd4b4a4c1171c41637f0430e1e18f42c8e4d9d03068be773c603fa7bfedfb5d5633d1714fb6ab1c256a7a6bbc27a74fbe53ce58c3f34b21c14fb2706531f2b6151157924269e973218c83ebf9bb3ee9fc634e5b174b02af5d25c5ce6f78024f3af44a5255b3f35730adc8e50fc1d9568ec50b2c20849f1e3bbc268b2a2ebf7ab3a5737a5c2f0d43503a471a33670d6371ea3ba406451ae068e909c1659f54f5c5fafdd30ab853cd8b298c54cf03b6377536ead9fdd93c7b14e4e99ad57ab7add685c53b58dc7161dcc23610560eabc0a93d33f2585a8148c8dd4b87d245370e3aeb02c3c16b200397df5ed28c2fd2d83b2392ed0ac5e5bc2a4c41c4c594d8b2d6fb4179ac6cf65b3d8637c848f1c5c38ed5cd1112955226fbcf4924da349465ec5978ca23895a3ba14514cc5b1f05246e7d9c957ae68c80118007cc04b7350f2c9686242b0765ad7bfab6e764166a8197b79fb6753be862f87c8317ebb921c63196c4babefc8d0716cedd95ce37e69874aa20ed56b0691d3d1d811be57fde505b6295e388f92c9dccd3fe7ea8fbd23adbdcb59ebec20db6049c3e6e2a676aa6f463bb4b87abf19f743643bd693412da8ce60e35b73b4b9a93d897f1069fc3500bc97929d5107c8beb1a321fdb6bc3baa765db07b1604d9e67e351e1f7c4e6e94f55faeea9384a886299c6b5ffe573c649166841a56cc84b64d80ef965cc15ee9e912d041517b34545065bed8b1449bb723437252928f6148944e801163259763cd4460a97ddd66f7f23ec3b17295c19fbb57f312f5c3fea89c18bdc3cee44241e76352e28573e80858b76fee6d9f1a116a82127fb311089630113d5395824adc4ce2066c4a2e85ee680a66eccb391259dd7d0ac1915e3e373d2c4d62c39929e6aaa2a5641c7266b1d73469b2f782431442e0d6b63aa6fa46b665ab9ce2c20a9cfd232a8d88211d100885968515f8c2108168d5982f21742396040b17251acf833acb96d8e3e5d00a81188f853d4d9077f6a65061f0dc38dd75cce4cf9e295f723992b143fb90fe568b4b82cec3904be8505ccd1f12dc82134a2b4dff7f7e4992a17bc082686f8e6094a098e887d7892372f05a723b984de6d86471341ea6bdbd5e3733622ab7ca7341f2aa68f7ecce8240aa2436ad3c8e4463fa0197d1e6336a7993dfa29c1d507c89114ac0f396574a723e7a1cac9904cf74e70eab525d22072134dad5f3eacf3c23b165d7eb5fedc4324e46c2a24b37e18c9e3f14a43445acda42d33c7894e22b60c8867481fcec385e95a0a04c4e7a857acfc945bf3ca81392eb6638ea3941cfcf99d4c9676a3630d46f435094d1298c19ec7210b67c847ad5c4fd51d6e5015a94d87e445fe0015a2cbf174d93ed4008b7ce9f41fec2a243eb4c5ccb457e44b15fb97e6d0775348e46e2a41b1d990229d76944a0d1bae44b83c264ceb507b8395c1957c82a2c2adf10ed4a590dfe2f7658e1958c01de4526f12c734a90dd5b84fae9a686922b1424838abf98a1253bb6b0d0b3e1c4f61741ca5840a48ce9afad2401e0742535e9f895592afcd19c036d1433deaae3b5fa1715ddd22dd4db0451c544391b47942b1700bdeb950d8638015eaba09f7bb5834f1bc2e2ae44bbdd5ac44a0a4dd80ac43c261992865a7d1d5f7a54e7639ab6b3ad49880098d411ff6d556f0989a399d33c4f67ed3201387066ec6fa7abfa7b7cd4e58008c17286a9e818debde73da231bce77403d9ddd41467fe5a1d1130cf2eeee6fec8bdd149ed7ef0ebc080a72740fa4f82f9c3ec6d9161b099265272d9927abcc7a0c22a033cff66bdd660563753f7e7950d29ef451901b22b4e1ff9e6289dcdd3945e6cc0ac019699c3b1556d6430f8ab431668cfb8a1a607cd4cfff40fd38ba9d66363cc4574219c18049f9e4c32eea0e603b5f4f85e5895343a2a50432a339f04c458024c2e586649c3a29c437094821a64fdb03d84c3eb5482b7233637106a27235b337f100596845cf00b61fbc3dbb392915bfa359883847d9a0b14c932ae2bf3a388d6ddcf86b746f8744ff6a3b77f52e91e54f35a3cde9d783bbdbe3fed38b2e126f07172c0de5b208f18fb4c0085016b9b5cc21245ca0e9a341539577ade357291f35b2ba8434390cceb39f63caceb73121843b659f7fb4cbb7d8db7ef58f6069448bf316743b399b7e0319e4b03f6c6569215e328e53eb04a0174ec03477f356f024cacbf4d41ec637dba0cdd914ce96e3ee529f3e487298611cd8e1c0a77980dcbbe09fb14c81fa1a5a0f6ebd049e9a4f670b0f192c3e6760e0b275325fa61936fc1c1d3d92b53b872ef820ed7872fc2d779074248da6f119802e5a6ceb5b289afb033a118c9cd9fa632320b9e6d68dd697e4a865e38a4c5dc4b792f254eeccc8e497b34ab84ba2db139b535d8a93229004fe5592f30393a2761d37a63c32e494db2088e1802046f38f1dd36b31d17edbbcbabdec5c7a4a2f68cd1aa40eed53aceec928d1ce0eef451ad1e01887fc9e130d9161ee193104f3461886fea9687b7f376ef32ae7333e4593c2591ea1012f6c4065dd692260b2590117585071e2db844991c94a56b6504151bc11751102334b4ca63691cd98b3505453cd7150032dd2938a6fa5b73514910523fdc3b684cce21fee9a3a11755971f7480b4dd503f912992cd72001e4236642dc0455b9b71d0575a0093bd3d7777accfb4e18378b306bf9d2bc9778b46e56c4d1459e190f56a4b33c59f5bd2fa3a3b8742797c0c68f43380ab23d381582308d6a37d5f253fddf19ab7936f82e16a004b698ce04637fd104208ed2a107771b9003ae065f82e303f1327358767daca86d290f6c84e1848d1c19c391326f16321a6c95bbcac7d0dee51713d18def5e4174d267c029f2f10bafc1aae2f767cd27548198ff26ce51ec4e36434aaaf19af9e959e6b7170ff58041d33c0276086136a8d759e7bc219fb5cba559890654afb82153e3aa3a3a06e06bbec9d66faa6fcf54ba001c31b452cdca18935eb3f5913a36e54967b51be910a4e7285007d13554f5397567766ab591f1fa948b08f3d18f9442868f65fd19e3386d64237e8d688fd7b43f52fd4c0172a9013acb2a3aa2d782cfadd3637cb6eeb77b08c62a928b2a31e18dc8cf2b7588dc2badcde6c2d952afe8fb0402353514c1b2e49a0da9c2e5dbf5c4154f628653e3ed26b8f09e19d84241b34a9e8a4b3a288efbc0f72019803d7fba5e7b5eac85dffe0e375078da69d9fcd4dac8daecc003191b8a234a514e7390a87cb614c717cf9c7ed2d6b50dc3dbb65aa5b405eec716ff5d8d52fe8585f93ef696bd87be6aecb702203c9bb901deeafc6223568d78e722194d6dd005b2212eb31667266aa053c342865cdd3d473b01f82bd2fa1c3082c49ab9f0f4bffd43eb235c7b619e1170b4fd7d74859ce5a412fc186fcf5a4fd53fc521f96d55cf26b3facd5dd26e6a1e6abb485b07b9cfb28ad99c7c871994c764150769596e9bf038726d2881658ffa5c0accae6401486ceef862a5eaf4bebf7651bc82214e44f0a9223ea9c889cbb66c0965adb4f4b61d9be707e1fe3670a7dff8a8aebd24274c1ea45a906b75a92fe32bb43461a4e87f97f1bd985f44bd4ea6e30108877584227684b6a27334f03670e07dc6b0ef044c151a9bc97f879540242e9e187c4cbebf698bb23c540bcbb9306978b34269cb226aca5870f67247fba4b125b47edb809138c71edc963fdc6d46db77e38169d3a44f8f5c3f76c57aef2189fcd21b2a448095110f21f9bffe3ed3f93f8c79089213f737573ff5994f9edfc4530b977a9fd037bf58ead728bba185ec169c7ce5ed4475253983d73ddcf0aa81ebd5334d22b6dbb917ea360a5b6cd9f1185d54ac2254d85cad32cc684e0decadf5c8520c367679dc633973f7a4da419ed20f64ee401c97ddd9ceb124a24b59f09250e684315b46125f638a1bb31aefdfa42e72d573a31e1be3cdac1d17506d2ff058a77d451312af3486c99365607df37ae0813e24c986ac901f1edb5ee64727f25e29d545b54fe8f56af19ff55c5862a67f74cf1172cdc16da4063e0a59e95d9bcba25c259d14577b19d6756cf718e26cc7867f289a5503ead5c94095e60a5b051777955ad123d2fdda0e8a831fca5eb16bed0174d2027ed3a7700af336ac45cd53d087f5fc701c1c889e644a4c6823e59c667a4b165eafc7971fc03c55ee9fb0203d35bd8d5956d0c4dbb3911abdfc2932646ef9d71f642e8866ebbf3d2cbcb74a9c8b370eed3831cc8e05ac8782690fb94aa360e56fb70f15b4b9b8540e9718a587d40102690c4b40c2886df85af9c561847c78fe4c8d80da3b0726c9ec2217328f98edc42eb1bc594a5aa7bf3235f2525ef671173f16dd65adafbfcf8c118e580e423b5c4a7150a0b56b7a3ff931887eaa08dfe49f77491aca0cbd66febfd512ba14b0c7abb1c4b0ec7c226af8971219abe85bcdb57f9d8ff60b41c2eacdfa64ee623b3b3d6915695f8e676526a78efb17c342cfc2848e85ffe95e6a3b129046e2899971a0114d244dc856b2f0cb945a143ac4821e73ca15291f6fb79f04ca0186519cd4c3f4d5ec0d30dd708292982e54b029a5f73766d75bb7d7059048b32824c6b3b9cce42cb8860cf27de95d3d910844319514de27cfdf4f05cc3d32765d5a02e73e14b3ccf7e3ed29d319ced4cb2d14c613f2b52ef6221d5ad2064420220711cc79d698ccb5ac370bd51243cc3835ecb3f7324ff607c02a29cc0daee5093d700372a4fded0204887a69fc514d18d2f91b8bda44c105bbeff4ecd61c9b16ea50cbde8928c5101c2600b4c73b9a6bb44ea37a32898267111740687b60a77cf80c5ffbd25896e4ba449e21ce5062015e6be118cdbbf73ac16b9e2b8859c55aef265ee7533cd9f087d44b0e484dc03dbb745ecdab2dc768c848ad073c71e9f2f2bdb9ce75396c3fdd98faec9934f2e415eb02bde8bca45100583c88ed3542f69bf8cd622b21a8549c99bc493585acaceaba87ae0b8e0400a21e507f6d2d3a9cda8eda43c85eaa2a2c3b207ac1eba5e39de2567ade03e3da5e211693a731beef2009a0a87ac980c6296797c55f0eb3e037e23c7981d16e72b85eab260ecb45434ea5ac6f18b2a0fa1cac737d48a90752f53d87c53e361a7c47db0cb26ce158920384ce3e15b518adb78f332a88f6a78e9f79ca8d54951360ff04151eba4f33f1800e71a0cbedc0306a32135b442bf16f0ef8a4107409faf9f40c7db59dd5627c80cf2e527703745ecea37a5aa317ba4ac5f28e2c144badaf3b8b24820552676eebd169abeefe984113eea08a533262d7b1eb3bca3c82b42cb2a0a9fab8186537ad62372031fabba77b7ce2c63f65b0c75d3f109ce4cf731be01fcf068561477558ad4e2f9808833db9d4ccaafbe4eaa7c2d6ce3dc91ae2e971df2e58fc16ff9570c825c3a2437adbd9c61cac9f7d12b95409f5bc77657716bb9688c34daa0f93b85cfdb9697f15ce417c598aa3b30855f1a2d93be8c450dde73afaf3536c66e04d11770de8ea7520ccc02e1c63d0d15badcb3ff717438b3aca5c6bb72d1674bd5b20d8d6a0138f2260d855ea02debdaa5526f8b300818424cc9330c89ba1e8bfb602b9194f662b2c8707f8185b7fa919cc8495728a0190d63145c47912d74f4ecc3c39120cb41f8c4606a131aef3624d888534728ee92a95734ffb67462890bd829026d2b41b93e2083f22c2ee2e839e75dfbb131c85611dd545bffd21eceb715f3e7a6af4c68017ace7bc3d46036975249c687a2f97c802fea2aa8d44e275759206d331ad542dd5aed5e23654a2cb9961cacdce38b7fd56033cfeca1291fdb4eef4a2a19d0f2ec8838913685145ab0f4b69b7b2f7dd5a2d2ff6e016b5192d0a17aae72bf1f27710de6b04f6bb29b6bfdbed1f362334eb8398d61ebfc724759ecd135a45235cef3355865858ccb19eecbb108143b796f86dfb04dff920f389bc6a384484b41beeb10f72187c9d8a6a33f115742c613ae84f808e21055eff2baa31e8035533b9b5a3d726e415ac14f2518f273fecda72d78f57f7a945b505cf6c872165e4a15abd07159ef26383d747f9473f8beb787cf75a64fe6f6fd313c68bcf2df4dd1babd1b6620520ec9b9caef69d40d92ba9a933770a7517bd8d8e7f84c2d07a3cad2a7edca76bbb6d8d30c694283c64434143a5c4dbcbf773b8fc773efa861b2b440f741ff5799dd26fd49ab8f44d6cbe697666e73158a390eddbf4a0afba921caee09c50f6f3c757bfc62a7bf541e2fcac16682e58697513f961c80882ddc94af125ffc17c35adc5431f7ec9dce30b3e400f3c462d49b846b233c05b6aff1c2cb9b7f0b70e7ef3bca43cae07d605d725537f80dd6c3ce6dcbbf42d075ab5f9066408d9240bd23f9a02e0a6203be36ecf3ed2f5b1a0e5405e7381410841612685993e94f5110f3cacd4d652c0bf2dd451265283bce9b083e9e08edf165affbc3fda63affc18af74601827306e1effd104f56d36138136743c2781c89bbf116baa9b5db629c8c9d2fabc595cc3e94e9a638b1bbf8539b642858fce07b3f54c6064eeb0521dfba14b54f7c01dc1dd2f321e1cd98f2da319c987aac259e73fc107666cf7c472a88469abce02368b455837a36aa214b9da8d19069d0e3f3573ee68683d905fd13ee3aa7f5cc5ae4829733523dfea0d9e5557abfd9840f2d250bba478a3f33ae390cd09873a5f3a6e3728fd70317ebefea468800e082cc1ec166e1712b092ef50c97a22abe92fff00e70ce0e9b01b61349f4581051cb2c66e32d11157ece85bf0585dbfc581c17e96b6b236040e97d05ac3b12f60d2e8652ad93998762ef6cb7863014346536c7ecdc74157725496df0b0903174adb5e95ce1583cb353d5f9b0dd68d8ff9a8da70ab003e242e74af72192063fadc4a8bb1bd8c63588e2a83174de88e0a33492f47e31829e7aab7b5acd3be70520d6acb707c35b5982b7a17a992f018c921bd9e5bd4cea8678b9cecd4b2586f14221d315a994eea9592620152ce5d583f92dfe13a285403c7d730255540f846280d92633cd626c28386d7e87450b64c0f5591ce8300f3dc2ceb484a25ce283088abe0e0a4f4014fa63263d5876e3df10109f9d1d84953bee9cdec30c6973db51b63f3f3e5389a62c423eee30009ec45d9fb7dca860874c2b312a859ae802830cf0fb0b460a0e5ac74bfcfe20448f59d498476c6c1ed23cac36b729fa4eabc2453c331b1214e74cd8a56b97c80185b84f015a8194bd7b76637c45aeb8e5d27820769d57d1af2095571408c1dad2054ccd5c15ca932de4683c55fba0f38c0ad66011e711325c0be094fc9667699bfa814938b46785d9e52c422ca3a65250d7a2cc832d8475694318a2b13f76b9521fd8be9c72f3726a67e78d03b3ade3e137ae053942a1283b1cc4b10e82c292bdd65851407d814eb6a0da800dbeff104096e9afddcf406a1fdbc5cf7e009ad86a15c20b84254f9468f407f2f29b1409c1a7197f605c35e71e4613e4b6747f486685f6ad721034e5b70abe323b69e6504582da003774ec36a3d5f8cfed1af3a2574b03eefb17241d8bdd6480fd724e8e4dda25c30a67f3068df689a57c9c8d0361231eb66c6a5f0e5abeadc4deb09d007ca72390c9d99095a6fe9d92bcc5b16a5cf8540a2cbdeb5480b6acf688d2b7007c62f9a55ba5acd2da06ffc423a14a59fd3a7efec828005e23c89791d9aeb9aa9c24c06ffe45de2f617aa4657ecbee73013747f07be14a4574576b46570e938f674413f441f05873e654ca31b98f18d91398c0a5a8cfea4bfc8f3b27047714933d67724698e20950cbeb4f1f107af9958e8348a9cd141193c61afc9e17ff74d8b432764140345c71a012691f6a8e19e725d8f7da9e74d51894c832c66c1104312374d240ae8de44db926ddf7d19973209743756dbaacf0449487cc8144951cc75686738fbf8f273bdf2d05da076266a218221b9551b277f0d125ca26f36b217afcf63be447bec36b50da7194937e27770e228230717643004a06dd1e4948ec25ce230f758323525a6d55faf12d1f3bb3f1f7875e819ef97626c9cf1e03a2e6dd49634f49678869aa1d97e351a9457de47bacf6393b664146446f3b7e2eafdd9c4cefb708e984ec04366e6169d6073301f623eb23cb1f60459e421c37748cfc308fcc92ec79d94d2d8f3243fea6a486ebbe16a2e78fb00e6b8cb970b7d63b662e30a9a57a1d632f961fdabb73bd2ac7fa722823c5e67765835619b62cdbd4fa655be9cdf9b3b61dc64b570350274b95b7cddfe24cfe2a7163b2c3bdf37a85352bfd4e85e1a01cc9b28efb3acb76c15845c071dc2a0b4664e2082d39aaf26e459ca28321c11c9ebca11ab64a9c534c502754a7a6bd0dcc7b65a6e2f49bc0b41d926a4503ccbcea63752195ad28bc259250157addcc707aff43d9b601c0114f365ae1dfb87108dd586b16e0a54d556fcd12e6ceb097c5541cef44e8042564bbfc17cb5b6a9c1411ecd024d3107ee769b22c4a0940a2d1d9794244b052330c4d07d35ff767ac25b17ad5128bbf760d161d8083df947e49047e0fbb7c764dff70387b24d2ae60107b7a48a85cb742083a7369486cb3db8ffde42408a57f33cabb5e47332c2940856afa109bcb4352203ee06828a487571bd7f6ad2aaab386be1a937aab759cb564945882aa2697e98c37b62676010755b9b6130413f70c940a31989b8200f3b921a3e30bd431d7d3d57d45b0b59fb06d353122f6b7762d0f9b47654551c18f6e1af035755b17bf88103a016e6476f4159ba1a7d3166c266946e4965a7b869be3c02e52edf4f734a0e7d547689017e1fdaadc4e5b6ed4a8531ffaa3296efee6fd03f7a67c4fde33d43a4e60a5b29e724cdfb7c1106eaf584964d7e9a9d97bc4f638aaa4e09bc83ffdfcbb4ccf114590c89f239c7867c79358f554b22f4ab4209f8b5e9d1d8d174831bd74ff78c957f0635f51848a42a933962f78bf1290b7a74fd02a17f48e03dc49cf6ecbbc057a25046530b868d20be7cc80d19acc6b37756623ec8c92c97233d028a49d6c88faf8404c01358255c715163761401b6a76ee1c6ded4fcef0a75e74397c153b532b27e574460a0e1356c55fb49e94c3fabbbacd40510f343b584b79bc4471f8123588b9427ae9443ff978ad07f367ca95575c4609fdc7ea1ffa2e35672291e6df86fec808ce680761b7b2e580ea12bf64540725de8d011d78a1af050fb46dab53cb40cb16c57d3ee517bfd5cfdb65128ae3845504a516ec0f8340a616257e2dd49d71c0ca0bab157148807562f891d1893dbaec8224953812c424ce6d9e2a6a0554c8547732f7d08237bbfc6073cec41910cf60d0077bff2643e178abe2fc1863c5f0eb7d2815fd3839a1622770a9042b5950cf519ca2a731829220dfc4d9579f38596cd24f7aee857c999aeb3048991dd21133590e739b239478e76b072647d62a4d36e4607f60ffd9010d034117fe08f51c0d2114d66c92e81626c26dec218fae0b1405bb8f8d3d3891e9a9e3b60bf4de4ad3af7d3c891565f2e92bd9ace57d4beb17357a06b7d1912759117335a81a8c655b994bb8796831b604954e1605c24c1bf471b3f12a8438dd92faa3be43e9ae9c91ee00586afd5e72b63d562949b9476fddbb390f9d131eab8b999bb2e30bc842818dcf66342a5e4e2bbfbaddc3c879a47558cc9116a17bc7962499e33b49143e34fdab1d9e9655960c248eab0ab2a15102fb2315bc225e380c10e04cbab79210ce7a3e3a337dd5f97d7b4fe8a42650dd37c85ed910ac350ab30b597ebf069a1478f632b1fc61150e774a64f70b5f911e87738899310977fdded91c85a3de4b691c66bc2b414d0c25aef848a25b4076020a6289b1ef661b46c7730e5ef495bb474a5a8176eb986cd379e0cdc56b3f9235f85a425916f4f9fe11e7985182ebe4924dad698face52c39117e6921af29967c131ac2aa0849e78179a2a1eb1d682ff173eb79dfd38f7fcf9758d84a78a5089906ea86cf16aa67ac144e14faf22d6caf5ed832b08f58dd2fb9f4e7aba21606e372c69e5710a3b17f365a8eacd22db2bd08dd593ea03c402a4e50cce65cc2da908b3bf721ee7a8dd297c6d6a3cd57e79e73beeb8ac8cc678b99b5d7f90082db73480549661540a4898b89a7bda5c0d6a2fb988025d868e3f4c038df488bdb86871d88143ba316cfbd2f350ae5eff47a928703f90ac29ba37c514e77bd38bf2f2bc312e7640701f4e2ba7176adfa9e8a86f9c67c535618b6be064d36a7c6889f75fa998e775dbb3bb9f6ddbb94ec7199da2838efee2d0a539b248c7c4ce283ac9ea9d2d93d9e29751ec15b85b78892cc6a3c2186ff955d9ce1dfe259a69138a5bad4e022e9f9124e06e277075f4399b599aec3132b5cad893af6c58dfc7113d41a0523c5eccf8082f169bbe615065180563e88870586cf10e6248c98eacda1a5e98c018a56aa375d7a680c17b2b252f0e79467696084c64443d6d0e9841555f115d1cf1199297a194a68af0de72e12aeb98e39620947cd126f8dceffef8cb25b109265bb0fdd1aefa0caf4f9f748e8ff7bd3c7c90aa72c6c1ff53916e69f2f7c8754a4e87658eb357bef4f54245bd2bab612fd0bbe1f5067799de4ac24484458266c93ef5ead8e5d43d80173c1b1c52d9a6dcfb1af0346012828196ea02e4312df6904daa9a12e9d1048dbac5441732d663dbd55d475e9a2c43afa10dd55ef1c91a88d566782788739c8e32cf2eae72d2786d7cd262efab5415b134dd70ac5da108ff1a0f9320138e6671d6ca107d639bca84c6cfcda5cd2ec00f12edba2faf2145ef46764d473f09b6392e332e81e40a906f65f9c9b3e1c6098552177533b9a66a107c5602f70478e84d73fb80fda3843e3c42d5a9da76e05ba900ede8a9a99f444b96dd75d690da21fc15ac403b05035a4fdf9beecdecdfc9500f03c7ba081df052616ff41886a40a02dae530d1c968518df57c951b31a4c4db173bf2fa385eb4edf6304aaa1c0a6a5fbfcfe75f11868b4cef8112f6a709a2e8b3b985dde13af9dffd6057c9ae39cd0455bf90cd3ca4cbd8eca29e65d7b50b920c92989a0a3a6ed31ef98947951935ecef324c8dc5ab32cf68dbc5185cceee3fa4d5e789d33bec3bf4e63cb2b36cd457f300a05d8c010e073464a2194694f9bc28221aa1461494fec6efdcc997420d8adb9e84a974cb3211fb1d0233fb214e6f4c46fb84ae6cf3ecfd31ad22330d5a2a5e6ba91a6aa6e881a1c653a7c20486467ab411d528ad9675b98886ad80e1552c92e1d101dfe55f3b76a475190d40f20e9e21ba9c7502091c57bb1a019ab09889bc71466c1a50820007bca5a02d1956f7a655f9b95ee0d255515ed6b56d51ebf300e4e2eeeb835472d200f0f92f054fe8bdf9dedce2aebc56f98eeddb04a6c9ee6f43307dcfd0debb256687a197093d7270ff1ab17b109d68d8c2baff00afd8c1ac9e7ce53469262cb6d0bcc91f6cf22519598b2a2d6850431bf33350f090caccd884b4d19b79a22ac2b6c4f1a2b5132303f94f0aee271235e97c47202ddfbb914a2783919c314714036c956f8dee167ab237c8eb8bc6a6ed362eb1689767b150c84d8e713415293e565072ae997b9b7176e125a56c346cfa37ddc2cf9fb1bb999f195391b92843438daccced7abe2b390a276069c586f7b6e404f96aad5e7433ed97c77046d3039efc5b9674ab1f4c1f5fd04c0909aa739a07f8eaa77d699ba562ba743c13ccddf841a6f1a1b01848944daf30299defc18ff0fa1a9334aa0d6fc14f0ccbe6f3f37550dcdc853ace5f6637891dafdc350896abadaea1db25a5bc40193cbc2a83ed6308e7aafe59170708de15427cba177d691c06ad7585ef3ba3cf073efba6c6b6fe9b48bf5d5905caccf8f385f6e52c9af1ff627a55b0794ed443bf9f0348f23360df592c21dc6ec1f66a5bdd6a26ed3745ae69c4985e5cf1fbf87cb57fa8311df6046e8dba8b2a98a450edfaf89f4aae2d4f0913b026f665139d622e9098e4c3e89552205894bb782a4cd487d5b68ba72504dd46831ea885328ea63866d18ca08748d42720401073ba41aa0fe2b2cc1a9c860d402ea3e3f820bddee27f9e74178004a0651722908cec7dc5b11ba2d1e3e670f6c057daa77ffe3e969e5a9a65d26aa57ecf46740ae8539490ba842ab0adad8a50313bcdc2cbf6c527b970157087e3ae277f5249b988b37a4684fccc45318f330ab3ccab90dea003629dca99589c2b709c42d2ce156699b3a9a6ddcaeb4d70352a96f6546b47f57c9b58face8a5cad61ae245dc1145e34edb20b5f9e1c0952f2925e035ae78ce655eae97000df9bf714a539dd25dfaf66f4c3f45b82e0f451663fbe8d3c1a7eaae87cecaf2128cde2c409aad5955e51fead8669158090146a4a1505828eb12b5cc8fabbab6feacbd26aa4fd227e93e322ef42a32de7b6da815ebdd3bf63a77b3bbfb57f29325ef5c2defbdd5fa8393297ce3959c2cf86fa6169687b2e8a8034ae04e8ca105b1010898078f14b393edb1c8d3d575c8530bec34133870b2bcfd8534460f62d7579e3b83d771c5b0e1182f4994abe2d4cb7f8878e9f839a53c1949a0eaff8cc5ae4e515f2d0de619fa53f8a5659048000deb11c30a871c88b2b79cd9b8ccc3cf2a49f0194a49d531e66f4e244c40f2776afa4673019be5552b464a7e86025b2cbcf10db6b2604877d1d04c57ae8c1a4baec21af914d66c6967596d464609461db318c57cc6fd171d0c3f6aa508c0ba415c05d5e51060897ca5140accdaa5aa2728a01b1c5a7e31324a9cd47fae7a6cb668afb1dd4d153ade60ea37ff80a0b81f82e47b50d1b62135e60283314555a0998476029b5968ad24d6f30ba6d9f00ad7e6756a5a756464559179ebda839f86dec40872aa956d741fbeb30adac830bca168a10e2c8872e8623e070e559d835dcfbf2020d70dd18233233f91126c883b075d64d65d0a3f1de6c6f9a9a4ddb96aefc2d4c04540d99b5633cdb609d924f32ad71a036833e495be55e92221ec84c575025c247aca8f13ed21a09df5a45b174e00ec27d63f1c0bb8517f077dce6ec73a97496b55fcb1f7c4ed90f3a64b6b784b0ecac73ac4862df8f6d9c68f7c1bbc1879815eaf187a2614579d2726dd8b0f2804af967e578ac05d96624343de1ee63fc9998fa13deb5495d17c05e43b46c29eddb9c86d54c2244234d61af99d3d57f8d5b3085fba6238d09a6711d77bfb664a0b7979f13bc95a7b3f16a341cb8b52dde8153547842ec70ee9a295db32c561c50fc3477170e813fdab09198a0f8738cbbdf5464d3c58d22468a19e7c7caad9e4a161d2640092bc347ff91659c83cdb092487638a4a6ed28f5d75ca37e43f19d58f9c97ad3ecde055fe5338a338c082e7596981a9760c5b3ef1f76ad15f1f78756245c86819878e0f27bbda3183af42d0189698f79a9692a2cd7cab0f3c191a9df990cc329c82f228185d16f332ce29745febd1c2f6b3193053a167a82fb4bf90a1088c34e4abc098a850de2ec2df2f15c3380aee7cfebf538a3f13b9e0098dfc255efc6e546b844d21cf045b7a15eea7ae7e7f87e441b210fe3157ae7f303c548e7d16b097e18bed53bd6b86e31a7532e97048713d6ee7fb14fb5646e80a2e61e08d02a0034e6a1e3464345ff2183ded39f730830d8b06d5d28ad99e3d91d0066405a94a78215c68070e04908791f0e744e3f3cb8769c64837a1adc78dc1c1f51b0e25a2b7f58b100e55aac7261fa8c25652f4013af43fbab61b19f704fc22546b07c419a26b9ccd259527c1679aafca4b2b4bc25d86b394a57b02fb1f5d5f3ef3b6f9c1c87f1e14f70c7b2f584497ff067dfc4af465cfc50dc0670e1f0b5c74d4003cf3641f893c926cb719589469ca6769636655e5f7a1a52a22798db5206c1ec53b1978c83ade59fc7c360580969c11b2845fa9cd1b875cd6e31248b796354e1395c380650708ec98dd881a8d61bd04f24a0560503796db11d26a11ebd9f8ba01ed3c78ff16d9035934c43a7fd97a5d8338dd7eb62ae90422c197e6be55051cb0d9cfeb245411da49d3e9f45a78c416a1431260039d1c33267a58f3403334b3bc8ce38cd4d1683916291d0d742fc1ff79ace9d4db53aa41b005c23678fd0be154edd845ccf2d049cc9e5b7abc06656bc8f1f5b45a71a846371b671d20ee3e5d3bb367b87c0bc027e0b36c7429bc6e0508cfd50cf8645e6d4afd8d87aa015e4c46d17f03aec97ddbb7f0ae203c4643bf03356e7a5254cec82fd35481d787975907fd7caa31ffa9574ac329f9930d98ecffb40fc2e72f6e25e8660b1df24d6ea250808b3e9741c2affef7cda833b7d8124a14a34c7ebefd431ee99c83cd85a7a651e01db6863d83a7c2ac8dc96c7d333e56ce01ac713dc6073509600ea76b87b86a5fe412a5597c282c2479e59fc93688dedea95770e750d25224a7ea7cf32d1964c6e141d03433766aee182099f32dc2215a6fe5f90e379c9e0f34c25e194bb83cb220438118b3fdafc9acd97c5b3d470e0d24c5c0f4cf12de6416d4e813daf654bd93ff406cee4d443d37f288ca8ad48477a0c926430d178c455771b6ea7c16e0874098396b8107ef36f4a4607c1a8f23116fd44a53531a2996866f21031e47cd5ea17c9d7c39aab154539daf4bad3bda38ea7f75e722456124b118ebf96c433ce2eb4aafa0b9ecd5b8c43929ed4b750ab81a75103f161f3bc2beac3a17169d0ea367a52e0965c17c5c6eb58e4853e19a5f67082a721a03bc8c172810e9a4d4430f7ec9ff195d8da99b7d95f8bd0673cbda3278580af5c1269a5617fa2838a92d6475de4abc338f998a74c1ad59b770a30fb8213808c8ece7cebb63f18de8fb4b5f7bc212b145261f695c07630937cf853a8f10f93ad8abb4bdf388175f5a3d93e764aa643a2e6fdd90c3a5ee69248d94ea4fa565c794d4542f7884c5272140273a4b1e1226d6ef85e55895a1e5946b394b6926411772bcc6c838c6f1b4905ed3ece2f8da17de14711fbbe83f003f089933ac42136af3c33716b0da2bbb4b9e4035a1085a1e69ba59b424bd0b88de71fb9ba00047f91e36a4b6a65894fd713452127a9177e8fa542ad0a45b1afed1fd6a6ecafb47da347f4dbdfb09d5827e501ee29905a8788683de878f1c5cabba8d2bb4c9a8bb58191dc18961beca99a65d6cfda129a9a3b81c32d2bf3bc6b087be28ba40e5dbb23e778683b12250daa6de53cebd764e90bb730c2df57c6802ab330ee94a430e64407ce5a4a5fa3c99e602c30373b938e5540d7db1ba93e83387ae653762d5f7bc1dc18f3c0c5e34049ca61476542e40978e8c6ee48a40fa9378a0a2af88d3c6c31bde570df0d40186c96ed60db723cbe0b7e048d262441e8f89542da7a7a4d2806febb32a1d5210b102b241f8bb72d66e78d85beaa070fa6b645b1f9320d685211957baea3503e4d29e6495256c04515081345a14160cf8596516e7d2508c0534b3cb84c41d5650ba4e68f361fb19299572b21ffceed60a4d5a6e1603f29771bfc7fcd0f778cd084e71d027d7202ad579de304b7034d7d526f2ec36721813f2d9229c1f892d5489084df62122c077ca733b81fac382e276272e08c7cdbb8f4365681e6252d748fdd18f163af9d9b2d908a9c6294b1a51e53442f14a3ff2af20d0579479411594f528bb3a36a66fd82fdfa9ce1f0dcbb4cb3b4045e36811bc25278f685f80d9d2c85cd3a637c37ebeb98d2dad037eb289e8db75b366234ed1bb967003df0d9fae35868f4d967525ba704021121b138491bb09a5b14e8eda3e226fac1ab2c5b441c336c6076db3d0411d61a20318b80a4f37075eae78e7d4b61036fc07f1846d619d69243a15af3657e6af50d488b35fb1d8cfe22d9d781855dc4be265eac2b83bb2b22936c0cadf424623a7bff0ca7b826385be85adcf26397d5c5dd2aa8d931d91687fc0ff3e2b8d34ff18f3bcac3dc3cb56e0e11283a3e189ed0324f3ccab32e053297538dc655266e75fa5328e868e0fb491dd73903a135398fab5bdae501ab7fb3f4ad3a56ed6557ec83adfe52edfb4f08c93804c624762e1a1eb56dd268f8160bb98a5f3e1722153c36f5534632c43c4e0c0860e98173bd0e453164ed896889f9fe22d8e8ebe083f293ab9eedc9f51c086c09a8fb54ee943872dbb40d203d4b1ac5e488114bbeec949ab955751fe494896c60ee813efd4f761d8ce74d72d05c3ed0c08e68bec0dc6ec7f00035e93b562d7448551f4195823925c558e81d7933888c07a3cd0bac36687201fa4da3f88de4aefde47c3d42edf9d7e9a68b974e8bad08d7303ef4c4fd4f7fd78669735b1ccec23f9843e9924828fcd453f6bb69cdd6157c39e9d43a965ea2a8c4e26fdd2030cf42eedaefc674c1ba698ce7c2489f953078acc594563b27ea91770081fb74a406bcf38404b03ad50bca802f75d8ba9ffba6a6999bce42b06a716d1c876534d91ec7725839302d61027cb2605a33ee4642d0eb6009d58207c35cdcec01bd2c6fea465fc0241d4de6a9744ae931b1c580a12b3cda1bd766358104c38ca07f1dbe52329c9e44733f443f18195056de3125c2153757689f39acbc5c3698a5f4625f4af9a67eadefbf7902094b50d017f5fc7107ed14855705bcb424f70a4ae259d1fe2f15c424ad2b5a310c215759478867f513319ef9574b826bc3483e66ab142ff3071f1fec76fd5c1efdc10ddd132fcb980736c6d7a82c725f0baff4a106e81d8a6d4777e0f4223350a735c6e882aff6ef2af5dffc9eb19723d3a310da12073aff60617e6841f06d962038e9903d0bd2e6dd21738f473737064e8feb522ef10c4eb3e2e96ee3de7057f9e3b0e501891281a7f6f272eb57b24bb3ee07e98b9a23a9956f6da55bda61c4b0a1515db3216a5beeddf549f241cbd943e4484adc39e406968244df96bada8685f5b39eb07fd4d2bd1d5941abfbbdd593245cae38b9dcc0c7f1abb8d5e9bf3443a8e82005f63381773b72d3769e418efd2aa4ccd6c0baa837e55ba8f2597b097b71225a58acadc076d464837df2ba16199ff7abf928b301c5aea1c5b14693382edb9bf5ed182363d1a1a59d00cabe81d2d2bb1c23f17f0579513db142f905315d960d383b29834fdacaf9acf6b4da9459e1c873859377f7827e2a8430863369a8faa8f3efe516b436923e6bff2e9e2d6398f4e9570f3572b231d100385395978f9fea839447c740469c07e98daf6633816256e6501be154ccd0b8ca3be92a222a2a50e3c02f4f10b1181a70f2f03a980842e80d1b3b7e8bfe1b801aebce8c536dfbb33a9b5448e9dbd700e509e8065a02619a6c91363efcdcf0ffafed379c4d63858e6543089216dd50df8f77bdfe34abf149a69181599ae987412a48b7a9a786ca99f78f217c48dfc7ef984dd5ecf4e7e2a35d65703bada56bbf483dd1cebe764ca8b3edd3ef66ac33e277d6682772a8d8b2a3b67705cf05db4eb787c4b 内容升级中...","link":"/blog/2022/10/25/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%A1%E7%90%86/"},{"title":"概率密度图","text":"123456789101112131415161718192021222324252627282930y1 = orgdata[&quot;O3&quot;]y2 = dwedata[&quot;O3&quot;]config = { 'xtick.direction': 'in', 'xtick.major.size': 2, 'xtick.minor.size': 1, 'ytick.direction': 'in', 'ytick.major.size': 2, 'ytick.minor.size': 1, 'axes.labelpad': 2.0,}plt.rcParams.update(config)fig, ax = plt.subplots(1,1,figsize=(4,2))ax.hist(y1, 50, histtype='step', stacked=True, fill=False, density=True,label=[&quot;Obs.&quot;])ax.hist(y2, 50, histtype='step', stacked=True, fill=False, density=True,label=[&quot;De-weather&quot;])pmax = 0.02ax.set_yticks(np.linspace(0,pmax,5))ax.set_yticklabels(np.linspace(0,pmax*1000,5,dtype=int))ax.set_ylabel(r'$Probability\\ density\\ (\\times 10^{-3})$')ax.legend()ax.set_xlabel(r&quot;$O_{3}\\ concentrations\\ (\\mu g\\ m^{-3})$&quot;)figname = f&quot;{homepath}/figures/O3_pdf.png&quot;plt.savefig(figname, dpi=300, bbox_inches='tight',pad_inches = 0.05, facecolor='w') 1234567891011121314151617181920x = dfs.anum_bins = 50fig, ax = plt.subplots(figsize=(2,2))# the histogram of the datavalues, base, _ = ax.hist(x, num_bins, density=True,ec=&quot;k&quot;,lw=0.1)ax_bis = ax.twinx()values = np.append(values,0)ax_bis.plot( base, np.cumsum(values)/ np.cumsum(values)[-1], color='darkorange', marker='o', linestyle='-', markersize = 1)ax.set_xlabel('slope')ax.set_ylabel('Probability density')ax.axvline(x=0,c='k',lw=0.5)fig.tight_layout()plt.savefig('../figures/slope_histogram',bbox_inches='tight',pad_inches = 0.05, dpi=300, facecolor='w') 123456789101112131415161718192021def pdf_cdf(ax, y, num_bins = 100): res_freq = stats.relfreq(y,num_bins) pdf_value = res_freq.frequency cdf_value = np.cumsum(pdf_value) x = res_freq.lowerlimit + np.linspace(0,res_freq.binsize*(res_freq.frequency.size-1), res_freq.frequency.size) ax.bar(x,pdf_value,width=res_freq.binsize,color=colorblind[0],lw=0.2) axw = ax.twinx() axw.plot(x,cdf_value,'-',c=colorblind[1],lw=1) axw.set_ylim(0,1) ax.set_xlabel('$\\Delta{MDA8}\\ (\\%)$',labelpad=1) ax.set_ylabel('Probability density') ax.set_xlim(-100,100) ax.axvline(x=0,lw=0.5,color='k') print(cdf_value[np.where(x&gt;0)]) fig, ax = plt.subplots(1,1,figsize=(2,2))pdf_cdf(ax, y)figname = f&quot;{homepath}/figures/pdf_cdf_{city}.png&quot;plt.savefig(figname, dpi=300, bbox_inches='tight',pad_inches = 0.05, facecolor='w')","link":"/blog/2022/10/25/%E6%A6%82%E7%8E%87%E5%AF%86%E5%BA%A6%E5%9B%BE/"},{"title":"模式中气溶胶光学性质相关文献总结","text":"Evaluation of a new internally-mixed aerosol optics scheme in the weather research and forecasting model 背景介绍 ​ 重要性，模式中的关键参数：bext, SSA, G The key parameters describing the aerosol–radiation interaction in the weather/climate models are aerosol optical properties, including the extinction coefficient, single scattering albedo (SSA), and asymmetry factor (G). 影响因素 形貌的影响 米散射理论的球形假设简单高效，目前广泛使用 非球形模型的发展取得了实质性进展。用于沙尘的非球形模型包括椭球体(ellipsoid)、超球体(super-spheroid)、不规则六面体(irregular hexahedral)等；分形聚合模型(fractal aggregate model)常用于BC。 混合态的非均匀性 与外混相比，BC与其他非吸收性气溶胶的内混会增强对辐射的吸收 目前模式中处理方式 WRF-chem: 米散射算法，BC核，其他壳 CAM5-ATRAS: 查表法 参数化 BC和其他物种内混 MATCH-SALSA: pure BC as fractal aggregate, 使用core-grey-shell模型计算光学特性 方法 WRF-Chem well-mixed aerosols: 假设为球形，有效折射指数为体积平均折射指数 internal mixing aerosols：壳的有效折射指数为体积平均 Fully coupled ‘‘online’’ chemistry within the WRF model Grell et al., AE, 2005 MADE with SORGAM 气溶胶模块 size distribution: 3模态+log-normal distribution aerosol processes: nucleation, condensation, and coagulation (coagulation 考虑Aitken model的两个粒子碰并和增长，进入accumulation model) Evolution of ozone, particulates, and aerosol direct radiative forcing in the vicinity of Houston using a fully coupled meteorology-chemistry-aerosol model Fast J D et al., 2006, JGR MOSAIC-8bins The bins are defined by their lower and upper dry particle diameters, so water uptake or loss does not transfer particles between bins. internally mixed within each bins Particle growth or shrinkage resulting from uptake or loss of trace gases (H2SO4, HNO3, HCl, NH3, and eventually secondary organic species) is first calculated in a Lagrangian manner. Transfer of particles between bins is then calculated using either the two-moment approach [Tzivion et al., 1989], as in this study, or the moving center approach [Jacobson, 1997] with these growth rates. aerosol optical properties extinction $b_{ext}$, SSA ($\\varpi_0$), and g are computed as a function of wavelength, $\\lambda$ and three-dimensional position $x$. 米散射理论用于计算消光系数$Q_e$、散射系数$Q_s$和不对称因子$g’$ $b_{ext}(\\lambda,x)=\\sum{Q_e(x_i,x)\\pi r_i^2 n(r_i,x)}$ radiative transfer model: Goddard shortwave radiative model radiative model consists of 11 shortwave bands but aerosol optical properties are calculated in 4 bands: 0.3, 0.4, 0.6, and 1.0 $\\mu m$ Technical Note: Evaluation of the WRF-Chem “Aerosol Chemical to Aerosol Optical Properties” Module using data from the MILAGRO campaign Barnard et al., 2010 ACP from chemical to optical properties (based on MOSAIC bins): masses, $M_{i,j}$, and number, $N_{i}$, are computed by each bins. i and j represent size bin number and chemical species convert mass $M_{i,j}$ to volumes $V_{i,j}$, by dividing by the density of each species calculate physical diameter, $D_{p,i}$ by summing over all $V_{i,j}$ in a bin, so $D_{p,i}=2((\\sum{V_{i,j}/N_{i}})/\\frac{4}{3}\\pi)^{1/3})$, then the size distribution is defined by $N_{i}$ and associated $D_{p,i}$ calculate bulk refractive index of the particles in a bin based on the size distribution. To do this, we need to choose a refractive index mixing rule: spherical shell/core configuration (以BC为核的球状核壳模型)。 $m_{s,i}$ and $m_{c,i}$ represent bulk complex refractive index of the shell and core. $m_j$ be the refractive index of each of the chemical constituents $j$. $m_{s,i}=\\frac{\\sum{m_j V_{i,j}}}{\\sum{V_{i,j}}}$ $m_{c,i}=1.85+i0.71$ 使用米散射理论计算吸收系数$Q_{a,i}$、散射系数$Q_{s,i}$和不对称因子$g_i$ for each bin, 进而得到整体的光学性质(输出到辐射模块)： $B_{scat}=\\sum_{i=1}^{8 bins}{N_i Q_{s,i} \\pi (\\frac{D_{p,i}}{2})^2}$ $B_{abs}=\\sum{N_i Q_{a,i} \\pi (\\frac{D_{p,i}}{2})^2}$ $g=\\frac{\\sum{N_i Q_{s,i} \\pi (\\frac{D_{p,i}}{2})^2 g_i}}{\\sum{N_i Q_{s,i} \\pi (\\frac{D_{p,i}}{2})^2}}$ 米散射原理 散射原理：入射波照射粒子，使得粒子磁化，感应出复杂电荷和电流分布。它们以同样频率变化，向外辐射电磁波就是散射 粒子直径D和入射波长$\\lambda$ : $D/\\lambda&lt;1$ 反射 入射波长 $\\lambda==550\\ nm$ 粒子直径$2*2.5\\mu m$ 根据粒子直径可以将散射分成： 瑞利散射、米散射 定义尺度参数$\\chi=2\\pi r/\\lambda$ 瑞利散射：半径r&lt;&lt;$\\lambda$， 判断条件：$\\chi = 2\\pi r/\\lambda &lt; 0.13$ ; $\\chi&lt;0.1$ 或$r&lt;0.05\\mu m$ 米散射：当$\\chi= 2\\pi r/\\lambda &gt; 0.13$ 时，瑞利散射会产生较大偏差。故而引入米散射算法,判断条件：$\\chi&gt;0.1-0.3$","link":"/blog/2023/03/24/%E6%A8%A1%E5%BC%8F%E4%B8%AD%E6%B0%94%E6%BA%B6%E8%83%B6%E5%85%89%E5%AD%A6%E6%80%A7%E8%B4%A8%E4%BF%AE%E6%94%B9%E7%9A%84%E7%9B%B8%E5%85%B3%E6%96%87%E7%8C%AE/"},{"title":"气溶胶光学性质","text":"光学性质关键参数 消光系数 extinction coefficient $b_{ext}$ 或 $\\sigma_{ext}$, 散射系数 scattering coefficient $\\sigma_{sca}$, 吸收系数 absorbing coefficient $\\sigma_{abs}$， 单位长度的倒数（$cm^{-1}$） 吸收系数等于消光系数和散射系数之差： $\\sigma_{abs}=\\sigma_{ext}-\\sigma_{sca}$ 消光效率 extinction efficiency $Q_{ext}$, 散射效率 scattering efficiency $Q_{sca}$, 吸收效率 absorbing efficiency $Q_{abs}$， 无量纲数 消光效率等于散射效率和吸收效率之和： $Q_{ext}=Q_{sca}+Q_{abs}$ 消光截面 extinction cross section $C_{ext}$， 散射截面 scattering cross section $C_{sca}$，吸收截面 absorbing cross section $C_{abs}$, 单位为面积（$cm^2$） 质量消光截面，质量吸收截面 mass absorption cross section $MAC$ 区别与联系： 消光系数指单位长度能量的衰减比例，单位为长度的倒数（$cm^{-1}$），等于消光截面和数浓度的乘积：$\\sigma_{ext}=C_{ext} \\times N$ 消光/散射/吸收截面指单个粒子的消光截面，通常使用单位质量的吸收截面，如MAC 消光效率是无量纲数，等于消光截面除以粒子的横截面积：$Q_{ext}=C_{ext}/A$ $\\sigma_{ext} = C_{ext} \\times N = A \\times Q_{ext} \\times N = \\frac{\\pi D_p^2}{4} \\times Q_{ext} \\times N$ 单次散射反照率 single-scattering albedo $\\omega$ , 等于散射效率和消光效率的比值：$\\omega = \\frac{Q_{sca}}{Q_{ext}}$ 不对称因子 asymmetry parameter， $g$ Angstrom exponent $\\frac{\\tau_{\\lambda}}{\\tau_{\\lambda_0}}=(\\frac{\\lambda}{\\lambda_0})^{-\\alpha}$ 混合态对气溶胶光学性质的影响 (Yao et al., 2022, ACP) 气溶胶组分对光学性质有重要影响： 不同组分复折射指数不同 不同组分吸湿性不同，会影响气溶胶含水量，对散射有重要影响 气溶胶粒子中不同组分的混合方式不同（排列方式）对散射、吸收有影响 不含吸收性组分（BC）的粒子中，体积混合可以用于计算整个粒子的折射指数 含BC粒子采用核壳假设（Mie散射算法，球形假设）更为合理，但包裹物对BC的光吸收有增强作用 对非球形粒子更复杂，Scarnato et al., 2013使用离散偶极子近似模型发现完全嵌入NaCl组分中的BC(embeded in NaCl)比部分嵌入BC的吸收系数的增强更大 因此混合状态对气溶胶光学性质有重要影响 大气中粒子混合状态从外混变化到内混，新鲜排放的粒子通常为外混，随着老化过程（粒子间的碰并，气态物种的凝结），逐渐向内混转化 Koike et al., 2014发现内混假设使得气溶胶的光学厚度增加2倍以上 模型很难描述气溶胶的混合态，进而影响到计算的气溶胶光学性质（吸收截面，散射截面和不对称因子）的准确性 模态法（CMAQ\\MAM）：模态间外混，模态内部内混； Fierce et al., 2016 发现忽略含BC气溶胶包裹物厚度的多样性（内混假设认为所有粒子中BC和包裹物含量相同，实际上不同粒子包裹物厚度不一样）会导致模拟的吸收增强高估200% 分粒径区间（MOSAIC，TOMAS，GLOMAP） 二维模型（Matsui et al., 2013, 2017）: 增加了BC混合态，不能表征非BC组分的其他粒子的混合信息（如沙尘） 混合态引起的气溶胶光学性质的不确定性 有研究利用敏感性实验进行评估（假设理想情况下，对真实的混合态仍然不清楚 assessed based on differences between varied idealized assumptions, no benchmark simulations exists） Curci et al., 2015发现混合态是气溶胶光学性质（AOD, SSA）不确定性的主要来源（能解释30-35%） Kodros et al., 2018发现内混和外混的假设计算的气溶胶直接辐射强迫变化范围为$-1.65$到$-1.34\\ W/m^2$ Fierce et al., 2017, 2020 apply detailed particle-resolved benchmark model,发现简单的混合态假设导致BC核和壳的错误分布，并导致吸收估算误差 内混假设下气溶胶光学性质的误差有多大？是什么原因导致的？ 结论： 内混假设普遍高估了气溶胶的吸收系数，且高估随着混合态指数减小而增加（越趋向于外混，高估越明显，因为是和内混假设对比的）。平均高估18%，最大达80%。 这种高估是由于内混假设中BC核的粒径高估导致的 对于单个粒子，吸收系数随着BC核的增加而增加；但对于粒子群来说，内混假设会导致一部分粒子的BC核增加，另一部分粒子的BC核减少（虽然总的BC和会增加）。考虑极端的情况，粒子群分为两个集合，分别为BC占比（$f_{BC}$）很高的和BC占比很低的，内混假设会导致$f_{BC}$很大的部分BC核的粒径减小 内混假设普遍低估了气溶胶的散射系数，平均-1.2%，最大-32% 进而导致SSA低估，−0.9 % (RH = 0 %), −0.7% (RH = 50 %) and −0.4% (RH = 90 %). 但同样的混合态指数下，不同实验结果差异较大，尤其是对于散射系数。对于吸收系数，这种差异是由于内混假设对BC核的粒径的高估差异导致的；对于散射系数，这种差异是由于内混假设中包裹物的折射指数的不同 启示： 内混高估吸收系数，低估散射系数，低估SSA，外混相反，那真实的混合态如何，怎么表征？ 目前在做的订正系数的物理意义是什么？ 球形假设的不确定性和混合状态的不确定性？Fierce et al., 2020 黑碳辐射强迫的不确定性来源 Fierce et al., 2020 认为主要是混合态的非均一性导致的 黑碳和其他组分混合后会发生光吸收增强现象，但目前对这种光吸收增强的定量评估还存在较大的不确定性，是导致评估黑碳辐射效应不确定性的重要来源 两个可能原因： 常用的球形假设（核壳模型）高估了黑碳的吸收，即形貌的影响 粒子间的差异性，即混合状态的影响 （本文认为后者的作用更为重要） 研究方法： 类似于Liu et al., 2017的方法，使用经验公式对Mie散射公式订正，$E_{abs}=1+\\frac{R_{BC}}{R_{BC,0}} \\times (E_{abs,c-s}-1)+\\epsilon$ 使用粒子解析模式PartMC Liu et al., 2017 混合态决定黑碳的吸收增强 观测表明： 外场测得的交通排放BC的数浓度峰值$M_R=0.3$，实验室测得的正常工况下BC数浓度峰值对应的$M_R=1$ （$M_R=M_{non-BC}/M_{rBC}$） 观测的$E_{abs}$在Mie-core-shell和external mixing假设的模拟值之间，因此引入了一种hybrid方法来估算$E_{abs}$ (结合核壳模型和外混模型，假设内混的比例) $M_R&lt;1.5$时，观测的$E_{abs}$与外混假设/不含BC一致，即$E_{abs}=1$ $M_R&gt;3$时，观测的$E_{abs}$和Mie-core-shell假设结果$E_{abs,c-s} $相同 $M_R$在1.5~3之间时，介于两者之间，引入内混比例$F_{in}$，则 $E_{abs}=E_{abs,c-s} \\times F_{in} + (1-F_{in}) \\times 1$ $F_{in}=0.57 \\times M_R - 0.74\\ (where\\ 1.5&lt;M_R&lt;3)$ hybrid方法模拟的$E_{abs}$和观测更为一致 准确表征混合的模式研究 Stevens et al., 2022, ACP GEM_MACH 怎么把排放的混合态区分出来","link":"/blog/2023/03/24/%E6%B0%94%E6%BA%B6%E8%83%B6%E5%85%89%E5%AD%A6%E6%80%A7%E8%B4%A8/"},{"title":"污染观测数据处理说明","text":"质量控制+转换成ppb Concentrations were reported by the MEE in micrograms per cubic meter (µg m 3) under standard conditions (273 K, 1013 hPa) until 31 August 2018. This reference state was changed on 1 September 2018 to 298 K and 1013 hPa for gases and to local ambient state for PM2.5 123456789101112from scipy.stats import zscoredef qualitycontrol(x): temp = zscore(x,nan_policy='omit') x1 = temp[0:-2] x2 = temp[1:-1] x3 = temp[2:] RM3 = 3*x2/(x1+x2+x3) mask1 = abs(temp&gt;4) mask2 = RM3&gt;2 mask1[1:-1] = (mask2|mask1[1:-1]) return np.where(mask1,np.nan,x) 单位转换 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475def convert_unit(x,T,P,M): # Convert from ug/m3 to ppb return x*22.41*T/273.*1013/P/MT, P = 273, 1013for year in [2013,2014,2015,2016,2017]: inpdir = f&quot;处理后数据/NoQC/{year}&quot; outdir1 = f&quot;处理后数据/QC+PPB/hour/{year}&quot; outdir2 = f&quot;处理后数据/QC+PPB/day/{year}&quot; if( not os.path.exists(outdir1)): os.makedirs(outdir1) if( not os.path.exists(outdir2)): os.makedirs(outdir2) for ProvinceCode,CityCode,StationCode in zip(allsite.ProvinceCode, allsite.CityCode, allsite.StationCode): fname = f&quot;{inpdir}/{ProvinceCode}_{CityCode}_{StationCode}_{year}.csv&quot; if(os.path.exists(fname)): data = pd.read_csv(fname) data.columns = cols_order data['o3'] = convert_unit(data['o3'],T,P,48) data['co'] = convert_unit(data['co'],T,P,28) data['so2'] = convert_unit(data['so2'],T,P,64) data['no2'] = convert_unit(data['no2'],T,P,46) data[cols_order].to_csv(f&quot;{outdir1}/{ProvinceCode}_{CityCode}_{StationCode}_{year}.csv&quot;,index=None) data.index = pd.to_datetime(data.datetime,format=&quot;%Y-%m-%d %H:%M:%S&quot;) dfday = data[['pm25','pm10','o3','co','so2','no2']].resample('D').apply(strongmean) dfday['MDA8'] = data[&quot;o3&quot;].resample('D').apply(MDA8) dfday['MDA8'] = np.where(np.isnan(dfday['o3']),np.nan,dfday['MDA8']) dfday['MaxO3'] = data[&quot;o3&quot;].resample('D').apply(strongmax) dfday[cols_order_day].to_csv(f&quot;{outdir2}/{ProvinceCode}_{CityCode}_{StationCode}_{year}.csv&quot;) else: print(&quot;%s doesn't exist&quot; %(fname)) year = 2018T1, P1 = 273, 1013T2, P2 = 298, 1013inpdir = f&quot;处理后数据/NoQC/{year}&quot;outdir1 = f&quot;处理后数据/QC+PPB/hour/{year}&quot;outdir2 = f&quot;处理后数据/QC+PPB/day/{year}&quot;if( not os.path.exists(outdir1)): os.makedirs(outdir1)if( not os.path.exists(outdir2)): os.makedirs(outdir2)for ProvinceCode,CityCode,StationCode in zip(allsite.ProvinceCode, allsite.CityCode, allsite.StationCode): fname = f&quot;{inpdir}/{ProvinceCode}_{CityCode}_{StationCode}_{year}.csv&quot; if(os.path.exists(fname)): data = pd.read_csv(fname) data.columns = cols_order data.index = pd.to_datetime(data.datetime,format=&quot;%Y-%m-%d %H:%M:%S&quot;) data.loc['2018-01-01':'2018-08-31','o3'] = convert_unit(data.loc['2018-01-01':'2018-08-31','o3'] ,T1,P1,48) data.loc['2018-01-01':'2018-08-31','co'] = convert_unit(data.loc['2018-01-01':'2018-08-31','co'] ,T1,P1,28) data.loc['2018-01-01':'2018-08-31','so2'] = convert_unit(data.loc['2018-01-01':'2018-08-31','so2'],T1,P1,64) data.loc['2018-01-01':'2018-08-31','no2'] = convert_unit(data.loc['2018-01-01':'2018-08-31','no2'],T1,P1,46) data.loc['2018-09-01':'2018-12-31','o3'] = convert_unit(data.loc['2018-09-01':'2018-12-31','o3'] ,T2,P2,48) data.loc['2018-09-01':'2018-12-31','co'] = convert_unit(data.loc['2018-09-01':'2018-12-31','co'] ,T2,P2,28) data.loc['2018-09-01':'2018-12-31','so2'] = convert_unit(data.loc['2018-09-01':'2018-12-31','so2'],T2,P2,64) data.loc['2018-09-01':'2018-12-31','no2'] = convert_unit(data.loc['2018-09-01':'2018-12-31','no2'],T2,P2,46) data[cols_order].to_csv(f&quot;{outdir1}/{ProvinceCode}_{CityCode}_{StationCode}_{year}.csv&quot;,index=None) dfday = data[['pm25','pm10','o3','co','so2','no2']].resample('D').apply(strongmean) dfday['MDA8'] = data[&quot;o3&quot;].resample('D').apply(MDA8) dfday['MDA8'] = np.where(np.isnan(dfday['o3']),np.nan,dfday['MDA8']) dfday['MaxO3'] = data[&quot;o3&quot;].resample('D').apply(strongmax) dfday[cols_order_day].to_csv(f&quot;{outdir2}/{ProvinceCode}_{CityCode}_{StationCode}_{year}.csv&quot;) else: print(&quot;%s doesn't exist&quot; %(fname)) -","link":"/blog/2022/10/25/%E6%B1%A1%E6%9F%93%E8%A7%82%E6%B5%8B%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/"},{"title":"箱形图","text":"箱形图1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859config = { 'xtick.direction': 'in', 'ytick.direction': 'in', 'xtick.major.size': 2, 'xtick.minor.size': 1.5, 'ytick.major.size': 2, 'ytick.minor.size': 1.5, 'xtick.top': True, 'ytick.right': True, }plt.rcParams.update(config)station = &quot;1001A&quot;; years = [2014,2015,2016,2017,2018,2019,2020,2021,2022]; season = 'Summer'dfs = pd.DataFrame(columns=[&quot;station&quot;,&quot;region&quot;,&quot;lat&quot;,&quot;lon&quot;,'2014','2015','2016','2017','2018','2019','2020','2021','2022','slope','p'])fig, axs = plt.subplots(2,2,figsize=(4.8,3.2))axs = axs.flatten()arg = {'widths':0.4,'showfliers':False,'showmeans':True,'meanline':False, 'boxprops':{'color':'#1084d8'}, 'medianprops':{'color':'#1084d8'}, 'meanprops' : dict(marker='o', markeredgecolor='#1084d8',ms=2, markerfacecolor='none'), 'whiskerprops':{'color':'#1084d8','ls':'--'}, 'capprops':{'color':'#1084d8'} }for i, region in enumerate(cornersdict.keys()): ax = axs[i] dfres = np.loadtxt(f&quot;../obsdata/dMDA8_dPM25_day_{region}_{season}.csv&quot;) ax.boxplot(dfres[:,0],positions=[0],**arg) ax.boxplot(dfres[:,1],positions=[1],**arg) ax.boxplot(dfres[:,2],positions=[2],**arg) ax.boxplot(dfres[:,3],positions=[3],**arg) ax.boxplot(dfres[:,4],positions=[4],**arg) ax.boxplot(dfres[:,5],positions=[5],**arg) ax.boxplot(dfres[:,6],positions=[6],**arg) ax.boxplot(dfres[:,7],positions=[7],**arg) ax.set_ylim(40,101) ax.set_xticks([0,1,2,3,4,5,6,7]) ax.set_xticklabels([-1000, -30,-20,-10,0,10,20,30]) # ax.axhline(y=100,lw=0.5,c='k') # ax.set_xticks([2015,2017,2019,2021],minor=True) # ax.yaxis.set_major_locator(MultipleLocator(5)) # x = [2015,2016,2017,2018,2019,2020] # y = temp[['2015','2016','2017','2018','2019','2020']].mean() # slope, intercept, r_value, p_value, std_err = stats.linregress(x,y) # f = np.poly1d([slope, intercept]) # ax.plot(x, f(x), 'r-',lw=1.) # print(r_value,p_value) ax.text(0.05,0.85,f&quot;{alpha[i]} {region}&quot;,transform=ax.transAxes,ha=&quot;left&quot;) # ax.text(0.45,0.85,&quot;k=%.2f; $R^2$=%.2f&quot; %(slope, r_value**2),transform=ax.transAxes,ha=&quot;left&quot;,color='r')axs[0].set_ylabel(&quot;$Fraction\\ (\\%)$&quot;)axs[2].set_ylabel(&quot;$Fraction\\ (\\%)$&quot;)figname = f&quot;{homepath}/figures/dMDA8.dpm25.ratio_summer.png&quot;plt.savefig(figname, dpi=300, bbox_inches='tight',pad_inches = 0.05, facecolor='w')","link":"/blog/2022/10/25/%E7%AE%B1%E5%9E%8B%E5%9B%BE/"},{"title":"概念图","text":"素材网站https://www.freepik.com/ PPT导出图片问题 修改注册表 计算机\\HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\16.0\\PowerPoint\\Options 在上面的路径下新建Dword(32位)，命名成 ExportBitmapResolution, 值改成10进制的600","link":"/blog/2022/10/25/%E7%BB%98%E5%9B%BE%E7%B4%A0%E6%9D%90/"},{"title":"matplotlib绘图细节设置","text":"导入相关库1234567891011121314151617181920212223242526272829303132333435363738394041424344import pandas as pdimport matplotlib.pyplot as pltfrom matplotlib.mathtext import _mathtext as mathtextfrom matplotlib.pyplot import MultipleLocatormathtext.FontConstantsBase.sup1 = 0.5mathtext.FontConstantsBase.sub1 = 0.3mathtext.FontConstantsBase.sub2 = 0.3import warningswarnings.filterwarnings(&quot;ignore&quot;)config = { &quot;font.family&quot;: 'sans-serif', &quot;font.sans-serif&quot;: [&quot;Arial&quot;], &quot;font.size&quot;: 8, &quot;pdf.fonttype&quot; : 42, &quot;mathtext.fontset&quot;: &quot;custom&quot;, 'mathtext.rm' : 'Arial', &quot;mathtext.default&quot;: &quot;rm&quot;, 'xtick.direction': 'in', 'xtick.major.size': 2, 'xtick.minor.size': 1, 'xtick.major.pad': 2, 'ytick.direction': 'in', 'ytick.major.size': 2, 'ytick.minor.size': 1, 'ytick.major.pad': 2,}plt.rcParams.update(config)# 打开上边和右边坐标轴的tickconfig = { 'xtick.direction': 'in', 'ytick.direction': 'in', 'xtick.major.size': 2, 'xtick.minor.size': 1.5, 'ytick.major.size': 2, 'ytick.minor.size': 1.5, 'xtick.top': True, 'ytick.right': True, }plt.rcParams.update(config) 通过kwargs给函数传递参数 好处：使代码简洁化，且能保持设置的一致性，推荐使用！！！ 12kwargs = {&quot;width&quot;:width,&quot;color&quot;:colors[0],&quot;lw&quot;:0.,&quot;ec&quot;:'k'}ax.bar(x+i*width*1.1,data0[:,i],hatch=hatchs[i],**kwargs) 坐标轴相关设置123456789101112131415161718192021222324252627282930313233# 设置坐标轴范围ax.set_ylim(0,100)ax.set_xlim(0,100)# 设置坐标轴ticks## 手动设置labels和ticks位置ax.set_xticks([1,2,3,4])ax.set_xticklabels([&quot;2013 &quot;,&quot;Mete&quot;,&quot;Emis&quot;,&quot; 2017&quot;],rotation=0.,fontsize=6)ax.set_yticks(np.linspace(0,60,4,dtype=&quot;int&quot;))ax.set_yticklabels(np.linspace(0,60,4,dtype=&quot;int&quot;))## 隐藏ticksax.set_xticks([])# 设置主、次要ticks (几种方法)## 手动设置from matplotlib.pyplot import MultipleLocatorax.yaxis.set_minor_locator(MultipleLocator(5))ax.yaxis.set_major_locator(MultipleLocator(25))## 手动设置ax.set_xticks(np.linspace(0,30,6))ax.set_xticks(np.linspace(0,30,31),minor=True)## 自动生成ax.minorticks_on()# 关闭坐标轴ax.set_axis_off()# 隐藏坐标轴，设置线条粗细，一般不需要ax.get_xaxis().set_visible(False)ax.spines['top'].set_visible(False)ax.spines['bottom'].set_visible(True) # 可见axi.spines['bottom'].set_linewidth(0.5) # 线条粗细axi.spines['left'].set_linewidth(0.5) 图例设置12345678910111213141516171819202122232425262728293031## 添加legend - 自动生成ax4.legend(frameon =False, # 边框 ncol=6, # 列数量 loc=2, # 位置 # loc=[0.5, 0.5], # 位置 handletextpad =0.3, # handle和文字距离 columnspacing=0.5, # 列间距 labelspacing=0.1, # 行间距 handlelength=1., ) # handle长度## 添加legend - 手动设置n1,n2 = [],[]cat_order = [' 0-12 h', '12-24 h', '24-36 h', '36-48 h', '48-60 h','60-72 h','72-84 h', '84-96 h', '96-108 h', '&gt;108 h']for i in range(10): n1.append(axs[-1].bar(0, 0,color=colors[i]))l1 = axs[-1].legend(n1,cat_order,loc=[0.08, -0.05], frameon=False, ncol=3, handletextpad=0.1, columnspacing=0.8, handlelength=1.,prop={'size':5})for i in range(3): n2.append(axs[-1].bar(0, 0,color=&quot;#dadada&quot;, hatch=hatchs[i]*2))l2 = axs[-1].legend(n2, ['M13E13','M17E13','M17E17'], loc=[0.08,0.8], frameon=False, ncol=3, handletextpad=0.1, columnspacing=0.5, handlelength=1.,prop={'size':5})axs[-1].add_artist(l1)## pandas或者seaborn画图，删除默认的legendax.get_legend().remove()## 填色图的图例 - colorbar - 需要自己改改l, b, w, h = ax1.get_position().boundsb, h = 0.09, 0.12position=fig.add_axes([l+0.02, b, 0.16, h/10]) #位置[左,下,长，高]cbar = plt.colorbar(cs1,cax=position,orientation=&quot;horizontal&quot;)cbar.ax.tick_params(axis='x', direction='in',length=10,labelsize=15)cticks= np.linspace(zmin, zmax, num=11, dtype=int); cbar.set_ticks(cticks); cbar.set_ticklabels(cticks) 添加文字说明1234567891011# 添加文字## 一般用于子图中ax.text(-0.18,0.95,&quot;(b)&quot;,transform=ax.transAxes,fontsize=10,fontweight=&quot;bold&quot;)## 整体画布中使用fig.text(0.5,0,r&quot;$PM_{2.5}\\ concentrations\\ (\\mu g\\ m^{-3})$&quot;,ha=&quot;center&quot;)# 标题 ## 坐标轴标题ax.set_ylabel(r'$Probability\\ density\\ (\\times 10^{-3})$')## 主标题，通过y改变位置ax.set_title(title,y=0.85) 添加辅助线和阴影区域12345678910# 横、竖线条ax.axvline(x=150,c=&quot;k&quot;,lw=0.2,ls=&quot;-&quot;)ax.axhline(y=150,c=&quot;k&quot;,lw=0.2,ls=&quot;-&quot;)# 竖的阴影区域，如用于标记污染天、夜间kwargs = {&quot;alpha&quot;:0.5,&quot;color&quot;:&quot;grey&quot;,&quot;ec&quot;:None}ax.axvspan(x[0], x[snight],**kwargs )for i in range(ndays-1): ax.axvspan(x[enight+i*24],x[snight+24+i*24],**kwargs) ax.axvspan(x[enight+(ndays-1)*24],x[-1],**kwargs) 添加right-y-axis1234567axw = ax.twinx()## 设置一个特定颜色rycolor = '#ae24d1'kwargs = {&quot;ms&quot;:1,&quot;c&quot;:rycolor}axw.plot(x,y,**kwargs)axw.tick_params(axis='y', colors=rycolor)axw.spines['right'].set_color(rycolor) 颜色设置12345678910111213141516171819202122## 改变默认的颜色循环import matplotlib as mplmpl.rcParams['axes.prop_cycle'] = mpl.cycler(color = [&quot;#0073C2FF&quot;,&quot;#EFC000FF&quot;,&quot;#868686FF&quot;,&quot;#CD534CFF&quot;,&quot;#7AA6DCFF&quot;,&quot;#003C67FF&quot;,&quot;#8F7700FF&quot;,&quot;#3B3B3BFF&quot;,&quot;#A73030FF&quot;])## 从colormap中提取几个颜色from mycolorpy import colorlist as mcpcolors=mcp.gen_color(cmap=&quot;Blues&quot;,n=11)### 或者import cmapscolors = cmaps.MPL_Dark2.colors[::-12,:] colors = colors[0:10,:]colors = colors[::-1,:]## 自己设计colormap （类似于在gnuplot中的设置，根据nodes的位置[0-1]来指定设置颜色）from matplotlib.colors import LinearSegmentedColormapcolors = [&quot;white&quot;, &quot;#e9e9fc&quot;, &quot;blue&quot;, &quot;green&quot;,&quot;yellow&quot;,&quot;red&quot;]nodes = [0.0, 0.01, 0.1, 0.25, 0.5, 1.0]mycmap = LinearSegmentedColormap.from_list(&quot;mycmap&quot;, list(zip(nodes, colors)))# 组分颜色colordict = {&quot;SO4&quot;:&quot;#e40b16&quot;,&quot;NO3&quot;:&quot;#211cc0&quot;,&quot;NH4&quot;:&quot;#e79700&quot;,&quot;OC&quot;:&quot;#70dc11&quot;,&quot;EC&quot;:&quot;#000000&quot;, &quot;Cl&quot;:&quot;#cb01a7&quot;,&quot;POA&quot;:&quot;#00cc67&quot;,&quot;SOA&quot;:&quot;#00994d&quot;} color = [&quot;#0073C2FF&quot;,&quot;#EFC000FF&quot;,&quot;#868686FF&quot;,&quot;#CD534CFF&quot;,&quot;7AA6DCFF&quot;,&quot;#003C67FF&quot;,&quot;#8F7700FF&quot;,&quot;#3B3B3BFF&quot;,&quot;#A73030FF&quot;] blind friendly colors colorblind = [&quot;#006ba4&quot;,&quot;#ff800e&quot;,&quot;#ababab&quot;,&quot;#595959&quot;,&quot;#5f9ed1&quot;,&quot;#c85200&quot;,&quot;#898989&quot;,&quot;#a2c8ec&quot;,&quot;#ffbc79&quot;,&quot;#cfcfcf&quot;] 从cmap提取n个颜色 ```pythonfrom mycolorpy import colorlist as mcpcolors=mcp.gen_color(cmap=”viridis”,n=9)12345678- 自定义颜色 - ```python from matplotlib.colors import LinearSegmentedColormap colors = ['#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c'] nodes = [0.0, 0.01, 0.1, 0.25, 0.5, 1.0] mycmap = LinearSegmentedColormap.from_list(&quot;mycmap&quot;, list(zip(nodes, colors))) 创建子图123456789101112131415161718192021222324252627282930313233343536373839# 规则的子图 （n, m）## 方法1 - subplots 基本版fig, axs= plt.subplots(4,3,figsize=(5,5),sharex=False,sharey=False)fig.subplots_adjust(hspace=0.1,wspace=0.2)axs = axs.flatten()## 方法2 - gridspecimport matplotlib.gridspec as gridspecfig = plt.figure(figsize=(6,2))gs = gridspec.GridSpec(nrows=2, ncols=1, height_ratios=[1.4,2])fig.subplots_adjust(hspace=0.,wspace=0.28)ax1 = fig.add_subplot(gs[0,:])ax2 = fig.add_subplot(gs[1,:])axs = [ax1,ax2]# 不规则的子图 （n, m）## 方法3 - subplots 进阶版fig = plt.figure(figsize=(8, 6))ax1= fig.add_subplot(3,3,1)ax2= fig.add_subplot(3,3,2)ax3= fig.add_subplot(3,3,4)ax4= fig.add_subplot(3,3,5)ax5= fig.add_subplot(3,3,7)ax6= fig.add_subplot(3,3,8)ax7= fig.add_subplot(2,3,3)ax8= fig.add_subplot(2,3,6)## 方法4 - subplot2grid - 方法3间隔较大，个人认为方法4更好fig = plt.figure()fig.set_figheight(6); fig.set_figwidth(6)ax1 = plt.subplot2grid((3, 6), (0, 0), colspan=2)ax2 = plt.subplot2grid((3, 6), (0, 2), colspan=2)ax3 = plt.subplot2grid((3, 6), (0, 4), colspan=2)ax4 = plt.subplot2grid((3, 6), (1, 0), colspan=2)ax5 = plt.subplot2grid((3, 6), (1, 2), colspan=2)ax6 = plt.subplot2grid((3, 6), (1, 4), colspan=2)ax7 = plt.subplot2grid((3, 6), (2, 0), colspan=3)ax8 = plt.subplot2grid((3, 6), (2, 3), colspan=3) 画图字体设置 SCI投稿推荐使用 Arial字体（一般都有） 下载字体https://www.download-free-fonts.com 复制到matplotlib对应字体目录下/r008/xdxie/software/anaconda3/lib/python3.8/site-packages/matplotlib/mpl-data/fonts/ttf，删除home目录下的.cache/matplotlib文件夹，添加下面的语句，就可以了 123456789101112131415161718import matplotlib.font_manager as font_managerfontpath = &quot;/r008/xdxie/software/anaconda3/lib/python3.8/site-packages/matplotlib/mpl-data/fonts/ttf/times new roman.ttf&quot;prop = font_manager.FontProperties(fname=fontpath)plt.rcParams['font.family'] = prop.get_name()import matplotlib.pyplot as plt plt.rcParams['font.sans-serif'] = ['SimHei']#用来显示中文标签plt.rcParams['axes.unicode_minus'] = False#用来正常显示负号# 单独设置text字体ax.text(116.0,40.25, u'北京',fontfamily=prop.get_name())# windows下字体目录 C:/windows/fonts# 中英文混合plt.rcParams['font.family']='Times New Roman ,simhei '# 设置字体族，中文为SimSun，英文为Times New Romanplt.rcParams['mathtext.fontset'] = 'stix' # 设置数学公式字体为stix 中文字体解决方案 1. 查看matplotlib字体位置 1234567pythonimport matplotlib print(matplotlib.matplotlib_fname())#记录下来，字体位置我的是：/home/ruanjianlaowang/anaconda3/lib/python3.7/site-packages/matplotlib/mpl-data/matplotlibrcexit() 2. 上传字体到服务器 123cd /home/ruanjianlaowang/anaconda3/lib/python3.7/site-packages/matplotlib/mpl-data/fonts/ttf通过ftp或者其他方式，将字体传上去，我们传的是：simhei.ttf 3. 删除字体缓存 12cd ~/.cache/matplotlibrm -rf * 4. 重启python应用 1nohup python k-means.py &amp; 说明： 假如还没生效，再更改个配置文件试试。（我们以前没更改这个配置文件，但是这次发生了个插曲，这次用的jmeter测试，一直还是乱码，后来改了这个还是不行，原来是jmeter的问题） 12345cd /home/ruanjianlaowang/anaconda3/lib/python3.7/site-packages/matplotlib/mpl-datavi matplotlibrc font.family : sans-serif #去掉前面的#font.serif : simhei, DejaVu Serif, #新加了simhei 计算统计参数1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950def evaluation(obs,sim): ''' sim: prediction, n-D np.array obs: observation, n-D np.array Assume the first dimension is time, deal with time dimension NOTE: users should set cut off value for MNB and MNE: As for O3 1h and 8h evaluation: [ozone] &gt; 40 or 60 ppb is suggested by EPA, but 30 ppb is used in J.L. Hu (2016) ''' N = obs.shape[0] # mean observation mo = np.nanmean(obs,axis=0) # mean prediction mp = np.nanmean(sim,axis=0) error = sim - obs # bias error (B) / mean bias (MB) / Bias bias = np.nansum(error,axis=0)/N # Gross Error (E/GE) / Mean Absolute Error (MAE) / Mean Error (ME) ME = np.nansum(np.abs(error),axis=0)/N # Mean Normalized Bias (MNB) | range(-100% to +++) | NOTE What happend if obs .eq. zero??? MNB = np.nansum(error/obs,axis=0)/N # Mean Normalized Error (MNE) | range(0 to +++) | NOTE What happend if obs .eq. zero??? MNE = np.nansum(np.abs(error/obs),axis=0)/N # Mean Fractional Bias (MFB) | range(-200% to +200%) | NOTE What happend if (obs+sim) .eq. zero??? MFB = np.nansum(error/(sim+obs)*2.,axis=0)/N # Mean Fractional Error (MFE) | range(0 to +200%) | NOTE What happend if (obs+sim) .eq. zero??? MFE = np.nansum(np.abs(error)/(sim+obs)*2.,axis=0)/N # Normalized Mean Bias (NMB) | range(-100% to +++) NMB = np.nansum(error,axis=0)/np.nansum(obs,axis=0) # Normalized Mean Error (NME) | range(0 to +++) | NME = np.nansum(np.abs(error),axis=0)/np.nansum(obs,axis=0) # Root Mean Square Error (RMSE) RMSE = np.sqrt(np.nansum(np.square(error),axis=0)/N) # correlation coefficient (R) coef = ma.corrcoef(ma.masked_invalid(obs), ma.masked_invalid(sim)); R = coef[0,1] # Index of Agreement (IoA) IoA = 1 - np.nansum(np.square(error),axis=0)/np.nansum(np.square(np.abs(sim-mo)+np.abs(obs-mo)),axis=0) return mo,mp,bias,ME,MNB,MNE,MFB,MFE,NMB,NME,RMSE,R,IoA","link":"/blog/2022/10/25/%E7%BB%98%E5%9B%BE%E7%BB%86%E8%8A%82%E8%AE%BE%E7%BD%AE/"},{"title":"黑碳形貌相关的理论基础","text":"基本概念测量仪器：差分电迁移率粒径分析仪（ＤＭＡ） Differential mobility analyzer 是利用不同粒径的带电粒子在电场中的受力大小不同而筛选出单粒径分布的颗粒物 串联差分电迁移率粒径分析-气溶胶质量分析系统（DMA-APM） 能够得到的数据：电迁移粒径mobility diameters ($D_{mob}$), 有效密度effective density ($\\rho_{eff}$ ), 等效体积粒径volume-equivalent diameter ($D_{ve}$) 电迁移粒径指在相同条件下具有相同电迁移力的球形颗粒物的粒径，与有效密度对应，可通过公式计算： $m = \\rho_{eff} \\times \\pi/6 \\times D_{mob}^3$ 对于非球形粒子，$D_{mob}$大于$D_{ev}$；对于球形粒子，两者相等 形状因子 分形结构（fractal aggregates）中的几个概念： 分形维数$D_f$: 球形时，m和$D_p$的3次方成正比，所以$D_f$=3 非球形时，$D_f$&lt;3，且越偏离球形，$D_f$越小 极端情况，当成一条直线时，$D_f$=1 计算公式，其中$R_g$是旋转半径 $N=k_g \\times (2R_g/d_p)^{D_f}$ 包裹物粒径，$D_p/D_c$比值： 对于裸露的BC（bare BC particles）： $D_p/D_c=1$ 对于全包裹的BC（embedded BC particles）：$D_p/D_c$等于包裹物和BC聚集体（BC aggregate）的体积比 对于部分包裹的BC（partly coated BC particles）：$D_p/D_c$ 不能简单得到，如图中红线所示是整个粒子的粒径（$D_p$） $D_p/D_c = [(V_{coating}+V_{BC}-V_{BCinside})/V_{BC}]^{1/3}$ (Wang et al., 2021, JGR) 被包裹住的部分的总质量=粒子总质量-裸露在外的BC质量? (Wu et al., 2018, EST, Light Absorption Enhancement of Black Carbon Aerosol Constrained by Particle Morphology ) 形状因子$\\chi$ 定义为在空气中运动的不规则颗粒物所受到的阻力与同等条件下等体积的球形颗粒物所受到的阻力的比值， 阻力$F_{drag}(D)=3 \\pi \\eta vD/C(D)$；C(D)是滑动校准系数，有公式 形状因子 $\\chi = F_{drag}(D_p)/F_{drag}(D_{ev})=D_pC(D_{ev})/D_{ev}C(D_p)$ 当颗粒物为规则的球形，二者阻力相等，即形状因子为１，而不规则颗粒物所受到的阻力$F_{drag}(D_p)$会大于对应的球形颗粒物所受到的阻力$F_{drag}(D_{ev})$，即形状因子大于１，并且该值越大，表示越偏离球形","link":"/blog/2022/10/25/%E9%BB%91%E7%A2%B3%E5%BD%A2%E8%B2%8C%E7%90%86%E8%AE%BA%E5%9F%BA%E7%A1%80/"}],"tags":[{"name":"CMAQ","slug":"CMAQ","link":"/blog/tags/CMAQ/"},{"name":"FORTRAN","slug":"FORTRAN","link":"/blog/tags/FORTRAN/"},{"name":"haze","slug":"haze","link":"/blog/tags/haze/"},{"name":"meteoroogy","slug":"meteoroogy","link":"/blog/tags/meteoroogy/"},{"name":"WRF-Chem","slug":"WRF-Chem","link":"/blog/tags/WRF-Chem/"},{"name":"visualization","slug":"visualization","link":"/blog/tags/visualization/"},{"name":"other","slug":"other","link":"/blog/tags/other/"},{"name":"data analysis","slug":"data-analysis","link":"/blog/tags/data-analysis/"},{"name":"software","slug":"software","link":"/blog/tags/software/"},{"name":"reach","slug":"reach","link":"/blog/tags/reach/"},{"name":"黑碳、WRF-chem","slug":"黑碳、WRF-chem","link":"/blog/tags/%E9%BB%91%E7%A2%B3%E3%80%81WRF-chem/"},{"name":"光学性质","slug":"光学性质","link":"/blog/tags/%E5%85%89%E5%AD%A6%E6%80%A7%E8%B4%A8/"},{"name":"黑碳","slug":"黑碳","link":"/blog/tags/%E9%BB%91%E7%A2%B3/"}],"categories":[{"name":"model","slug":"model","link":"/blog/categories/model/"},{"name":"paper","slug":"paper","link":"/blog/categories/paper/"},{"name":"python","slug":"python","link":"/blog/categories/python/"},{"name":"hexo","slug":"hexo","link":"/blog/categories/hexo/"},{"name":"map","slug":"map","link":"/blog/categories/map/"},{"name":"example","slug":"example","link":"/blog/categories/example/"},{"name":"data","slug":"python/data","link":"/blog/categories/python/data/"},{"name":"linux","slug":"linux","link":"/blog/categories/linux/"},{"name":"aerosol","slug":"aerosol","link":"/blog/categories/aerosol/"}],"pages":[{"title":"categories","text":"","link":"/blog/categories/index.html"},{"title":"tags","text":"","link":"/blog/tags/index.html"},{"title":"赋得古原草送别","text":"离离原上草，一岁一枯荣。 野火烧不尽，春风吹又生。 远芳侵古道，晴翠接荒城。 又送王孙去，萋萋满别情。","link":"/blog/about/index.html"}]}